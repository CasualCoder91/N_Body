%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}

\usepackage{xcolor}
\usepackage{luacolor,lua-ul} %for usage of style attributes - background color

\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}

\usepackage{sphinxcontribtikz}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}


\title{Testing the limits of the ELT}
\date{Jan 06, 2022}
\release{private beta2}
\author{Alarich Herzner}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{title_page}.png}

\end{figure}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{Abstract}
\label{\detokenize{NBodySimulation/Abstract:abstract}}\label{\detokenize{NBodySimulation/Abstract::doc}}
\sphinxAtStartPar
Todo?: write


\chapter{Acknowledgement}
\label{\detokenize{NBodySimulation/Acknowledgement:acknowledgement}}\label{\detokenize{NBodySimulation/Acknowledgement::doc}}
\sphinxAtStartPar
Todo!: write


\chapter{Introduction}
\label{\detokenize{NBodySimulation/Introduction:introduction}}\label{\detokenize{NBodySimulation/Introduction::doc}}
\sphinxAtStartPar
The Extremely Large Telescope (ELT) is currently under construction.
This first next generation 40m class telescope will have the resolution and sensitivity needed to study the motions of individual stars in the galactic centre (GC).
These position and motions can be used to detect star clusters using some type of clustering algorithm and consequently estimate their Initial Mass Function (IMF).
Whether the IMF of star clusters is universal is the subject of discussion {[}\hyperlink{cite.NBodySimulation/Appendix:id45}{2}{]} at this time.
The study of Young Massive Clusters (YMCs) {[}\hyperlink{cite.NBodySimulation/Appendix:id56}{29}{]} near the GC will hopefully give more insight into this hotly debated topic.
YMCs are tightly grouped clusters of stars, generally containing \textgreater{}10000 members.
All original members are still present, the IMF is well sampled in all mass regimes. These facts combine to give a good picture of the end product of a star formation event.

\sphinxAtStartPar
Given detected star clusters the question remains, how reliable these results are.
If the true classification of the studied set of stars is known, the performance of the clustering algorithm and hence the reliability of the results can be calculated.
However, this is generally not the case.

\sphinxAtStartPar
In this master thesis an N\sphinxhyphen{}body simulation containing cluster stars and field stars under the influence of the milky way potential is performed.
Snapshots are taken at different timesteps and fed to ScopeSim {[}\hyperlink{cite.NBodySimulation/Appendix:id50}{22}{]} to create mock observations.
With the help of Photutils {[}\hyperlink{cite.NBodySimulation/Appendix:id54}{8}{]} positions are extracted and the DBSCAN algorithm used to detect cluster and field stars.
Finally, the reliability of the results can be determined by comparing its results with the initially simulated stars.

\part{Modeling The Milky Way Galaxy}
	\highLight[{[RGB]{232,209,82}}]{
	The first mayor goal is to create and store data which will be observable by the ELT. This data consists of field stars and cluster stars at consecutive points in time.
	A field stars is any star belonging to the milky way which is not of interest for the observation. Still, the amount, mass and velocity of these stars should be reasonably realistic.
	In order to study the effects of the cluster location on its observability, the model must be able to produce data for arbitrary view directions of the ELT.
	In a typical N-body simulation all N bodies would be simulated.
	However, a model containing every single star present in the MW is no feasible option for the typical home computer.
	Therefor, only stars within the field of view of the ELT are simulated. The gravitational interaction of stars inside and outside the field of view is modelled via a galactic potential.
	Hence, the simulated field stars do not interact at all. Due to their proximity this simplification can not be made for cluster stars. Thus, cluster stars do interact with each other gravitationally.
	The mass of cluster and field stars are sampled from IMFs. The positions and velocities of field stars are derived from the galactic potential. 
	The positions and velocities of cluster stars are generated using the Plummer model, resulting in an overall stationary cluster.
	The circular velocity at the cluster location is derived from the galactic potential and added to each cluster star.
	After this initialization is complete, the simulation is run for a set amount of timesteps storing all relevant data into a database.}

	\chapter{Required Methods}
		\section{Sampling distribution functions}
			\label{\detokenize{NBodySimulation/Initialization:sampling-distribution-functions}}
			Space, velocity and mass distributions are sampled during various steps of the initialization using the following two methods.
			For further details and alternative methods see {[}\hyperlink{cite.NBodySimulation/Appendix:id43}{11}{]}.
				\subsection{Rejection sampling}
					\label{\detokenize{NBodySimulation/Initialization:rejection-sampling}}
					\sphinxAtStartPar
					A proposed distribution function \(g(x)\) is sampled and each resulting sample accepted with a probability of \(\frac{f(x)}{Cg(x)}\).
					\(C\) is a constant ensuring \(f(x)\leqslant Cg(x) \forall x\) and \(f(x)\) the target distribution.
			
					\sphinxAtStartPar
					If \(g(x)\) is the pdf of a uniform distribution with \(x \in \left [ a,b \right ]\)
					\begin{equation*}
					\begin{split}g(x)=\frac{1}{b-a}\end{split}
					\end{equation*}
					\sphinxAtStartPar
					and \(m\) the maximum of \(f(x)\) within \(\left [ a,b \right ]\) then \(C=\frac{m}{b-a}\) and the acceptance criterion becomes
					\begin{equation*}
					\begin{split}u \leq f(x)\end{split}
					\end{equation*}
					\sphinxAtStartPar
					here \(u\) is a uniform distribution \(U(0,Cg(x)) = U(0,m)\). While \(Cg(x)\) has to be larger than \(f(x)\) the area between them should be as small as possible to ensure a decent acceptance fraction.
				
				\subsection{Inverse transform sampling}
					\label{\detokenize{NBodySimulation/Initialization:inverse-transform-sampling}}
					\sphinxAtStartPar
					If the cumulative probability function (cpf) of the probability distribution \(f(y)\) is continuous and its inverse obtainable, this method can be utilized and is more efficient than rejection sampling.
					The cpf describes the probability that the random variable is smaller or equal to x
					\begin{equation*}
					\begin{split}F(x)=P(X \leq x) = \int_{-\infty }^{x}f(y) dy\end{split}
					\end{equation*}
					\sphinxAtStartPar
					The inverse \(F^{-1}(y)\) may be calculated via \(F(F^{-1}(y)) = y\). With \(y\) drawn from a uniform distribution the results of \(F^{-1}(y)\) have the desired probability distribution \(f(y)\).

		\section{Integration techniques}
			\label{\detokenize{NBodySimulation/Integration:integration}}\label{\detokenize{NBodySimulation/Integration::doc}}
			\sphinxAtStartPar
			Numerical integration is needed during initialization and simulation.
			Various options for time integration have been implemented.
			The GNU Scientific Library ({[}\hyperlink{cite.NBodySimulation/Appendix:id24}{14}{]}, GSL) is used for integrations performed during initialization.
			The relevant functions are all based on QAG or QAGI, which have been ported from the Fortran library QUADPACK {[}\hyperlink{cite.NBodySimulation/Appendix:id25}{52}{]} to C in GLS.
			The decision trees given on page 79\sphinxhyphen{}80 in {[}\hyperlink{cite.NBodySimulation/Appendix:id25}{52}{]} help with the decision on when and how to use the respective methods.
			
			
			\subsection{Quadrature, Adaptive, General\sphinxhyphen{}purpose (QAG)}
				\label{\detokenize{NBodySimulation/Integration:quadrature-adaptive-general-purpose-qag}}
				\sphinxAtStartPar
				This algorithm makes use of adaptive Gauss\sphinxhyphen{}Kronrod quadrature to estimate the definite integral of a given function.
				
				\sphinxAtStartPar
				Quadrature sums are defined as
				\begin{equation*}
				\begin{split}Q_n[a,b] \equiv \sum_i^nw_if(x_i) \cong \int_a^bw(x)f(x)\textup{d}x\end{split}
				\end{equation*}
				\sphinxAtStartPar
				where \(w_i\) are weights, \(x_i\) nodes, \(w(x)\) a weight function.
				The highest possible degree of precision is 2n\sphinxhyphen{}1. With this maximum precision \(Q_n\) is exact for polynomials of a degree smaller or equal to 2n\sphinxhyphen{}1.
				
				\sphinxAtStartPar
				Using classical Gaussian quadrature formulae, error estimation, by increasing n to n+1, requires n+1 evaluations of \(f(x)\) in addition to n evaluations from
				calculation of the original sum, since the respective nodes have no common points. By doing so, the degree of precision is only increased from 2n\sphinxhyphen{}1 to 2n+1.
				Therefore, the error estimation obtained by subtracting the two sums could be unreliable.
				
				\sphinxAtStartPar
				Adding n+1 points to the Gauss\sphinxhyphen{}Legendre formula \sphinxhyphen{} here \(w(x)=1\) and the nodes are zeros of the Legendre polynomial \sphinxhyphen{}
				Kronrod introduced the option of increasing the precision to 3n+1, again requiring n+1 additional evaluations of \(f(x)\) ({[}\hyperlink{cite.NBodySimulation/Appendix:id26}{27}{]}).
				\begin{equation*}
				\begin{split}Q_n^K[a,b] \equiv \sum_i^nw_if(x_i) + \sum_j^{n+1}w_j^*f(x_j^*) \cong \int_{-1}^1f(x)\textup{d}x\end{split}
				\end{equation*}
				\sphinxAtStartPar
				QAG makes use of this option, bisecting the interval with the largest local absolute error estimate in each step.
				This division is repeated until either the absolute or relative global error estimate is smaller than required by the caller.
			
			
			\subsection{Quadrature, Adaptive, General\sphinxhyphen{}purpose, Infinite interval (QAGI)}
				\label{\detokenize{NBodySimulation/Integration:quadrature-adaptive-general-purpose-infinite-interval-qagi}}
				\sphinxAtStartPar
				In case of a semi\sphinxhyphen{}infinite interval \((a,\pm \infty)\), the integration variable is transformed
				\begin{equation*}
				\begin{split}x = a\pm\frac{1-t}{t}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				leading to
				\begin{equation*}
				\begin{split}\int_a^{\pm \infty}f(x)\textup{d}x = \pm \int_0^1 f \left(a\pm\frac{1-t}{t}\right)t^{-2}\textup{d}t\end{split}
				\end{equation*}
				\sphinxAtStartPar
				For an infinite interval
				\begin{equation*}
				\begin{split}\int_{-\infty}^{\infty}f(x)\textup{d}x =
				\int_0^\infty f(x)+f(-x)\textup{d}x =
				\int_0^1  \left ( f \left(\frac{1-t}{t}\right) + f \left(\frac{t-1}{t}\right) \right )  t^{-2}\textup{d}t\end{split}
				\end{equation*}
				\sphinxAtStartPar
				After the transformation QAGS with the 15\sphinxhyphen{}point Kronrod rule is used.
				QAGS, in addition to the adaptive bisection (see QAG), makes use of the Wynn \(\epsilon\)\sphinxhyphen{}algorithm to accelerate the convergence.
			
			
			\subsection{Velocity Verlet Algorithm}
				\label{\detokenize{NBodySimulation/Integration:velocity-verlet-algorithm}}
				\sphinxAtStartPar
				For cluster members the acceleration is a combination of the force resulting from the presence of all other cluster stars (see Barens Huts Algorithm)
				and from the milky way potential. The acceleration of field stars solely comes from the milky way potential.
				In each time step both velocity and acceleration of each star is evaluated.
				
				\sphinxAtStartPar
				Since the velocity, \(v(t)\) changes over time, its value at the midpoint between the current (\(t_n\)) and the next timestep \(t_{n+1}\) is intuitively a better approximation than
				\(v(t_n)\) or \(v(t_{n+1})\). The same holds true for the acceleration. This leads to {[}\hyperlink{cite.NBodySimulation/Appendix:id27}{13}{]}
				\begin{equation}\label{equation:NBodySimulation/Integration:leapfrog_algorithm}
				\begin{split}x_{n+1} = x_{n} + hv_{n+0.5}\\
				v_{n+1.5} = v_{n+0.5} + \frac{h}{m}F(x_{n+1})\end{split}
				\end{equation}
				\sphinxAtStartPar
				which is the Leapfrog algorithm. If one needs \(x\) and \(v\) at the same time, \eqref{equation:NBodySimulation/Integration:leapfrog_algorithm} can be split into two half steps.
				\begin{equation*}
				\begin{split}v_{n+0.5} = v_{n} + \frac{h}{2m}F(x_{n})
				x_{n+1} = x_{n} + hv_{n+0.5}\\
				v_{n+1} = v_{n+0.5} + \frac{h}{2m}F(x_{n+1})\end{split}
				\end{equation*}
				\sphinxAtStartPar
				\(F(x)\) does not have to be calculated twice, because \(F(x_{n+1})\) can be used as \(F(x_{n})\) in the next timestep.
			
			
			\subsection{Barnes\sphinxhyphen{}Hut Algorithm (BH)}
				\label{\detokenize{NBodySimulation/Integration:barnes-hut-algorithm-bh}}
				\sphinxAtStartPar
				When determining the gravitational force acting on a star belonging to a cluster, the positions of all other stars in that cluster
				have to be taken into account.
				\begin{equation*}
				\begin{split}m_i\vec{x}_i = G\sum_{j=1,j\not\equiv i}^{N}\frac{m_im_j\left ( \vec{x}_j-\vec{x}_i \right )}{\left | \vec{x}_j-\vec{x}_i \right |^3}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				Calculating this force for all stars requires \(O(n^2)\) operations.
				However, the simulated clusters consist of \(\sim 10^4 - 10^5\) stars.
				While the resulting number of calculations is possible, it is not feasible for a typical desktop computer.
				Therefore, the Barnes\sphinxhyphen{}Hut algorithm (BH) has been implemented which is of order \(O(n\log(n))\).
				
				\sphinxAtStartPar
				The gist of the BH is to approximate a set of stars by their total mass and center of mass (com) if the distance between them
				and the star, for which the force is to be calculated, is large enough.
				
				\sphinxAtStartPar
				The total mass and com of a set of \(m\) stars is
				\begin{equation*}
				\begin{split}m_{com} = \sum_{i=1}^mm_i \\
				\vec{x}_{com} = \frac{1}{m_{com}}\sum_{i=1}^mm_i\vec{x}_i\end{split}
				\end{equation*}
				\sphinxAtStartPar
				All cluster stars are stored in an octree.
				An octree is a data structure where each node in the tree has up to eight child nodes.
				These nodes split the space represented by their parent node into eight cubes.
				External nodes are nodes without any children. Each external node contains at most one star.
				Internal nodes have at least one child. They represent stars stored in their child nodes by storing their total mass and com.
				The root node contains the whole space occupied by the cluster. Each node stores the following information: total mass, amount and center of mass of stars
				contained within the cube, two points defining the volume of the cube, one point at the center of the cube as well as links (pointers) to each child node and to the parent node.
				If a child pointer is null, it does not exist yet.
				The seemingly redundant point at the center of the cube is used to evaluate the child node of a star within the cube.
				The two points defining the volume could be used instead but that approach would require additional FLOPS.
				
				\sphinxAtStartPar
				Stars are added recursively starting at the root node. If the current node is already an internal node, the star is passed
				to the appropriate child. Mass and com of the internal node are updated.
				The appropriate child is determined by comparing the position of the star with the center of the node.
				If the considered node is an external node but already contains a star,
				both the newly added and already present star are passed down to the appropriate child or children.
				Consequently, the current node becomes an internal node.
				Since both stars can lie in the same octant, this can lead to additional recursions until the stars are assigned to different child nodes.
				If the current node is external and does not yet contain a star, the star is added to the node and the recursion ends.
				
				\sphinxAtStartPar
				When calculating the gravitational force on a star, the octree is travelled through recursively beginning with the root node.
				In case the distance \(d\) between the star and a node is sufficiently large, the stars within that node are approximated by the mass and com of that node,
				otherwise all child nodes within the current node are considered. Whenever the distance criterion is met,
				the acceleration vector stemming from the force is calculated, added to the overall acceleration of the star and the recursion for the considered branch stops.
				
				\sphinxAtStartPar
				Whether or not \(d\) is big enough, is determined by the quotient \(\theta\).
				\begin{equation*}
				\begin{split}\theta = \frac{s}{d} < \theta_{max}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				with \(s\) the side length of the cube and \(\theta_{max}\) a set threshold value.
				In the special case of \(\theta_{max}=0\), BH becomes a direct\sphinxhyphen{}sum algorithm. \(\theta_{max}=0.5\) is a commonly chosen value.
				

	\chapter{Star clusters}
		\label{\detokenize{NBodySimulation/Initialization:cluster}}
		\sphinxAtStartPar
		A cluster can be characterised via a number of parameters, namely its density profile, metallicity, binary fraction and initial mass function (IMF).
		The following sections cover methods implemented by the author. Alternatively, cluster stars can be generated using the open source code McLuster {[}\hyperlink{cite.NBodySimulation/Appendix:id35}{47}{]} which supports more density profiles and all other parameters mentioned above.
		The generated file can then be imported by setting the appropriate parameters. Consequently McLuster has been used for all experiments presented here.
		
		
		\section{Initial Mass Function (IMF)}
			\label{\detokenize{NBodySimulation/Initialization:initial-mass-function-imf}}
			\sphinxAtStartPar
			The IMF describes the initial mass distribution of stars, that is, how many stars have which mass in some set of stars at the start.
			It is subject of debate whether the IMF of star clusters is universal {[}\hyperlink{cite.NBodySimulation/Appendix:id45}{2}{]} and the present day mass function (PDMF) usually differs from the IMF.
			Figure 13 in {[}\hyperlink{cite.NBodySimulation/Appendix:id44}{42}{]} depicts the Salpeter IMF {[}\hyperlink{cite.NBodySimulation/Appendix:id49}{55}{]} and the PDMF of Arches. Hence, the IMF is deemed an adequate estimate for the PDMF of a generic YMSC.
			Sampling routines for the following two IMFs have been implemented by the author.
		
		
			\subsection{Salpeter IMF}
				\label{\detokenize{NBodySimulation/Initialization:salpeter-imf}}\begin{equation}\label{equation:NBodySimulation/Initialization:salpeter}
				\begin{split}p(m)=\frac{dN}{dm}=A*m^{-\alpha }\end{split}
				\end{equation}
				\sphinxAtStartPar
				This comparatively simple and widely used ({[}\hyperlink{cite.NBodySimulation/Appendix:id46}{32}{]}, {[}\hyperlink{cite.NBodySimulation/Appendix:id47}{54}{]}, {[}\hyperlink{cite.NBodySimulation/Appendix:id48}{43}{]}) IMF can be sampled using inverse transform sampling.
				To do so one must integrate the IMF over the mass and normalize it, yielding the normalized cumulative distribution function (NCDF).
				\begin{equation}\label{equation:NBodySimulation/Initialization:salpeter_ncdf_1}
				\begin{split}P(m)=\int_{m_{min}}^{m}A*m^{-\alpha } dm = \frac{A}{-\alpha +1}\left ( m^{-\alpha +1} -m_{min}^{-\alpha +1}\right )\end{split}
				\end{equation}
				\sphinxAtStartPar
				A is defined by normalization:
				\begin{equation*}
				\begin{split}P({m_{max}})\equiv 1\rightarrow A=\frac{-\alpha +1}{m_{max}^{-\alpha +1} -m_{min}^{-\alpha +1} }\end{split}
				\end{equation*}
				\sphinxAtStartPar
				With this \eqref{equation:NBodySimulation/Initialization:salpeter_ncdf_1} becomes:
				\begin{equation*}
				\begin{split}P(m)=\frac{m^{-\alpha +1} -m_{min}^{-\alpha +1}}{m_{max}^{-\alpha +1} -m_{min}^{-\alpha +1}}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				Since Salpeter is a power\sphinxhyphen{}law distribution function, the inverse of the NCPF can be calculated analytically. After some simplifications the final result reads
				\begin{equation*}
				\begin{split}m_{rand} = m_{min}*\left [ 1+x*\left ( \left ( \frac{m_{max}}{m_{min}} -1\right )^{-\alpha +1} \right ) \right ]^{\frac{1}{-\alpha +1}}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				where \(x\) is a random number in range {[}0,1{]}
				
				\begin{figure}[htbp]
				\centering
				\capstart
				
				\noindent\sphinxincludegraphics{{initial_conditions_mass_salpeter}.pdf}
				\caption{\(10^3\) stars sampled from the Salpeter IMF. This figure has been generated to test the implementation of the sampling algorithm.}\label{\detokenize{NBodySimulation/Initialization:id41}}\label{\detokenize{NBodySimulation/Initialization:fig-initial-conditions-mass-salpeter}}\end{figure}
		
		
			\subsection{Broken Power Law (BPL)}
				\label{\detokenize{NBodySimulation/Initialization:broken-power-law-bpl}}
				\sphinxAtStartPar
				The BPL IMF has the benefit of being highly adaptable. It can be utilized to approximate any other IMF.
				It has been used to describe both globular cluster IMFs {[}\hyperlink{cite.NBodySimulation/Appendix:id11}{3}{]} as well as young star cluster IMFs ({[}\hyperlink{cite.NBodySimulation/Appendix:id12}{28}{]}, {[}\hyperlink{cite.NBodySimulation/Appendix:id13}{19}{]}).
				
				\sphinxAtStartPar
				The following is a generalization of the equation given by {[}\hyperlink{cite.NBodySimulation/Appendix:id10}{18}{]} for \(n-1\) intervals.
				\begin{equation*}
				\begin{split}\xi(m)=A
				\begin{cases}
				    \ k_{1}m^{-\alpha_{1}} &\quad\text{if }m_{1}\leqslant m< m_{2}\\
				    \ k_{2}m^{-\alpha_{2}} &\quad\text{if }m_{2}\leqslant m< m_{3}\\
				    \ ...  \\
				    \ k_{n-1}m^{-\alpha_{n-1}} &\quad\text{if }m_{n-1}\leqslant m< m_{n}\\
				\end{cases}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				where \(A\) is a normalization constant and \(k_{i}\) is defined as
				\begin{equation*}
				\begin{split}k_{1} = m_{2}^{\alpha_{1}} \\
				k_{2} = m_{2}^{\alpha_{2}} \\
				k_{i} = k_{i-1}m_{i}^{\alpha_{i}-\alpha_{i-1}}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				As in the case of Salpeter, random samples are drawn with inverse transform sampling.
				
				\sphinxAtStartPar
				The NCDF can be obtained by integrating \(\xi(m)\) over the mass interval.
				\begin{equation*}
				\begin{split}F(m)=\int_{m_{1}}^{m}\xi(m)\,dm\end{split}
				\end{equation*}
				\sphinxAtStartPar
				Where A is defined by the normalization constraint:
				\begin{equation*}
				\begin{split}A * \sum_{i=1}^{n-1} \left ( k_{i}\int_{m_{i}}^{m_{i+1}}m^{-\alpha_{i}}\,dm \right ) = 1\end{split}
				\end{equation*}
				\sphinxAtStartPar
				Inverting the NCDF leads to
				\begin{equation*}
				\begin{split}F^{-1}(y)=
				 \begin{cases}
				   \ \left [ \frac{(1-\alpha_{1})y}{A*k_{1}} +m_{1}^{1-\alpha_{1}}\right ]^{\frac{1}{1-\alpha_{1}}} &\quad\text{if }0\leqslant y< \frac{A*k_{1}}{1-\alpha_{1}}\left ( m_{2}^{1-\alpha_{1}}-m_{1}^{1-\alpha_{1}} \right )\\
				   \ \left \{ \left [y-\frac{A*k_{1}}{1-\alpha_{1}}\left ( m_{2}^{1-\alpha_{1}}-m_{1}^{1-\alpha_{1}} \right )\right ]  \frac{1-\alpha_{2}}{A*k_{2}} + m_{2}^{1-\alpha_{2}} \right \}^{\frac{1}{1-\alpha_{2}}} &\quad\text{if }\frac{A*k_{1}}{1-\alpha_{1}}\left ( m_{2}^{1-\alpha_{1}}-m_{1}^{1-\alpha_{1}} \right )\leqslant y< \sum_{i=1}^{2}\frac{A*k_{i}}{1-\alpha_{i}}\left ( m_{i+1}^{1-\alpha_{i}}-m_{i}^{1-\alpha_{i}} \right )\\
				   \ ...  \\
				   \ \left \{ \left [ \sum_{i=1}^{n-2} y- \frac{A*k_{i}}{1- \alpha_{i}}\left ( m_{i+1}^{1-\alpha_{i}}-m_{i}^{1-\alpha_{i}} \right )\right ]  \frac{1-\alpha_{n-1}}{A*k_{i}} + m_{n-1}^{1-\alpha_{n-1}} \right \}^{\frac{1}{1-\alpha_{n-1}}} &\quad\text{if }\sum_{i=1}^{n-2}\frac{A*k_{i}}{1-\alpha_{i}}\left ( m_{i+1}^{1-\alpha_{i}}-m_{i}^{1-\alpha_{i}} \right )\leqslant y< \sum_{i=1}^{n-1}\frac{A*k_{i}}{1-\alpha_{i}}\left ( m_{i+1}^{1-\alpha_{i}}-m_{i}^{1-\alpha_{i}} \right )=1\\
				 \end{cases}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				where \(y\) is a random number in range {[}0,1{]}
		
		
		\section{Density Profile}
			\label{\detokenize{NBodySimulation/Initialization:density-profile}}
			\sphinxAtStartPar
			Different density profiles (King {[}\hyperlink{cite.NBodySimulation/Appendix:id40}{46}{]}, Plummer {[}\hyperlink{cite.NBodySimulation/Appendix:id41}{53}{]} and Elson, Fall \& Freeman {[}\hyperlink{cite.NBodySimulation/Appendix:id42}{41}{]}) have been used ({[}\hyperlink{cite.NBodySimulation/Appendix:id36}{17}{]}, {[}\hyperlink{cite.NBodySimulation/Appendix:id37}{35}{]}, {[}\hyperlink{cite.NBodySimulation/Appendix:id38}{16}{]}) to simulate YMCs.
			The Plummer profile has been implemented here as described in {[}\hyperlink{cite.NBodySimulation/Appendix:id39}{38}{]} \highLight[{[RGB]{232,209,82}}]{generating positions and velocities.
			At this stage the position and velocity of the center of mass is zero.
			In a second step the positions are offset to the desired location given as input parameter and the the circular velocity at that target location is added to the velocity of each star.}


	\chapter{The Milky Way model}

		\section{Galactic Potential}
			\label{\detokenize{NBodySimulation/Potential:galactic-potential}}\label{\detokenize{NBodySimulation/Potential:galactic-potential-label}}\label{\detokenize{NBodySimulation/Potential::doc}}
			\sphinxAtStartPar
			Modelling the gravitational potential of the Milky Way has been an ever evolving topic in recent decades. {[}\hyperlink{cite.NBodySimulation/Appendix:id58}{39}{]} provides a brief history.
			Here the potential is used to approximate the force on the simulated stars and to initialize field stars.
			
			\sphinxAtStartPar
			The model of choice consists of four parts: black hole, bulge, disc and the dark matter halo.
			
			\sphinxAtStartPar
			The \sphinxstylestrong{black hole} is represented by a Keplerian potential:
			\begin{equation*}
			\begin{split}\Phi_{bh}\left ( r \right ) = -\frac{G*M_{bh}}{r}\end{split}
			\end{equation*}
			\sphinxAtStartPar
			with \(r\) being the spherical radius.
			
			\sphinxAtStartPar
			The \sphinxstylestrong{disk} can be modelled via a Miyamoto Nagai potential {[}\hyperlink{cite.NBodySimulation/Appendix:id3}{49}{]}
			\begin{align*}\!\begin{aligned}
			\Phi_{disk}\left ( R,z \right ) = -\frac{G*M_{disk}}{\sqrt{R^{2+\left ( a_{disk}+\sqrt{z^{2}+b_{disk}^{2}} \right )^{2}}}}\\
			\rho_{disk}(R,z)=\frac{b_{disk}^{2}M_{disk}}{4\pi}\frac{a_{disk}R^{2}+\left[a_{disk}+3(z^{2}+b_{disk}^{2})^{\frac{1}{2}}\right]\left[a_{disk}+(z^{2}+b_{disk}^{2})^{\frac{1}{2}}\right]^{2}}{\left \{ R^{2}+\left[a_{disk}+(z^{2}+b_{disk}^{2})^{\frac{1}{2}}\right]^{2} \right \}^{\frac{5}{2}}\left(z^{2}+b_{disk}^{2}\right)^{\frac{3}{2}}}\\
			\end{aligned}\end{align*}
			\sphinxAtStartPar
			with \(R\) being the cylindrical radius and with \(z\) being the distance to the reference plane.
			
			\sphinxAtStartPar
			For the \sphinxstylestrong{bulge} the Hernquist potential {[}\hyperlink{cite.NBodySimulation/Appendix:id6}{44}{]} is used
			\begin{align*}\!\begin{aligned}
			\Phi_{bulge}\left ( r \right ) = -\frac{G*M_{bulge}}{\left ( r+a_{bulge} \right )}\\
			\rho_{bulge}(r)= \frac{M_{bulge}}{2\pi }\frac{a_{bulge}}{r}\frac{1}{\left ( r+a_{bulge} \right )^{3}}\\
			\end{aligned}\end{align*}
			\sphinxAtStartPar
			\(a\) being the scale\sphinxhyphen{}length of the spheroid potential
			
			\sphinxAtStartPar
			and the NFW potential {[}\hyperlink{cite.NBodySimulation/Appendix:id59}{26}{]} is used for the \sphinxstylestrong{dark matter halo} potential
			\begin{equation*}
			\begin{split}\Phi_{halo}\left ( r \right ) = \frac{-4\pi G\rho _{s}r_{s}^{3}\ln\left ( 1+\frac{r}{r_{s}}\right )}{r}\end{split}
			\end{equation*}
			\sphinxAtStartPar
			where \(\rho _{s}\) is the characteristic density and \(r_{s}\) the scale length.
			
			\sphinxAtStartPar
			Parameters for bulge and disk taken from {[}\hyperlink{cite.NBodySimulation/Appendix:id4}{30}{]} and the radius \(r_{s}\) for the halo from {[}\hyperlink{cite.NBodySimulation/Appendix:id5}{7}{]}:
			
			
			\begin{savenotes}\sphinxattablestart
			\centering
			\sphinxcapstartof{table}
			\sphinxthecaptionisattop
			\sphinxcaption{MW model parameters}\label{\detokenize{NBodySimulation/Potential:id8}}\label{\detokenize{NBodySimulation/Potential:tbl-parameters}}
			\sphinxaftertopcaption
			\begin{tabular}[t]{|\X{20}{50}|\X{20}{50}|\X{10}{50}|}
			\hline
			\sphinxstyletheadfamily 
			\sphinxAtStartPar
			Parameter
			&\sphinxstyletheadfamily 
			\sphinxAtStartPar
			Value
			&\sphinxstyletheadfamily 
			\sphinxAtStartPar
			Unit
			\\
			\hline
			\sphinxAtStartPar
			\(M_{bh}\)
			&
			\sphinxAtStartPar
			\(4*10^{6}\)
			&
			\sphinxAtStartPar
			\(M_\odot\)
			\\
			\hline
			\sphinxAtStartPar
			\(M_{disk}\)
			&
			\sphinxAtStartPar
			\(10^{11}\)
			&
			\sphinxAtStartPar
			\(M_\odot\)
			\\
			\hline
			\sphinxAtStartPar
			\(a_{disk}\)
			&
			\sphinxAtStartPar
			\(6.5\)
			&
			\sphinxAtStartPar
			\(kpc\)
			\\
			\hline
			\sphinxAtStartPar
			\(b_{disk}\)
			&
			\sphinxAtStartPar
			\(0.26\)
			&
			\sphinxAtStartPar
			\(kpc\)
			\\
			\hline
			\sphinxAtStartPar
			\(M_{bulge}\)
			&
			\sphinxAtStartPar
			\(3.4*10^{10}\)
			&
			\sphinxAtStartPar
			\(M_\odot\)
			\\
			\hline
			\sphinxAtStartPar
			\(a_{bulge}\)
			&
			\sphinxAtStartPar
			\(0.70\)
			&
			\sphinxAtStartPar
			\(kpc\)
			\\
			\hline
			\sphinxAtStartPar
			\(r_{s}\)
			&
			\sphinxAtStartPar
			\(16\)
			&
			\sphinxAtStartPar
			\(kpc\)
			\\
			\hline
			\end{tabular}
			\par
			\sphinxattableend\end{savenotes}
			
			\sphinxAtStartPar
			\(\rho _{s}\) can be determined by imposing
			\begin{align*}\!\begin{aligned}
			v_{c}\left ( R_{0},z=0 \right ) = 220\left [ \frac{km}{s} \right ]\\
			R_{0} = 8 \left [ kpc \right ]\\
			\end{aligned}\end{align*}
			
			\subsection{Circular Velocity}
				\label{\detokenize{NBodySimulation/Potential:circular-velocity}}
				\sphinxAtStartPar
				The circular velocity \(v_{c}\) is defined via
				\begin{equation}\label{equation:NBodySimulation/Potential:circular_velocity}
				\begin{split}v_{c}\left ( R,z \right ) = \sqrt{R\frac{\partial \Phi \left (R,z  \right )}{\partial R}   }\end{split}
				\end{equation}
				\sphinxAtStartPar
				with the total potential being in the presented case
				\begin{equation}\label{equation:NBodySimulation/Potential:total_potential}
				\begin{split}\Phi \left ( R,z \right ) = \Phi_{bh} \left ( R,z \right )+\Phi_{disk} \left ( R,z \right )+\Phi_{bulge} \left ( R,z \right )+\Phi_{halo} \left ( R,z \right )\end{split}
				\end{equation}
				\sphinxAtStartPar
				therefore
				\begin{align*}\!\begin{aligned}
				v_{c}^{2} = v_{c,bh}^{2}+v_{c,disk}^{2}+v_{c,bulge}^{2}+v_{c,halo}^{2}\\
				v_{c,bh}^{2} = \frac{G M_{bh} R^2}{\left(R^2+z^2\right)^{3/2}}\\
				v_{c,disk}^{2} = \frac{GM_{disk}R^2}{\left(\left(a_{disk}+\sqrt{b_{disk}^2+z^2}\right)^2+R^2\right)^{3/2}}\\
				v_{c,bulge}^{2} = \frac{G M_{bulge} R^2}{\sqrt{R^2+z^2} \left(a_{bulge}+\sqrt{R^2+z^2}\right)^2}\\
				v_{c,halo}^{2} = \frac{4 \pi G \rho _{s} R^2 r_{s}^3 \log \left(\frac{\sqrt{R^2+z^2}}{r_{s}}+1\right)}{\left(R^2+z^2\right)^{3/2}}-\frac{4\pi G\rho_{s} R^2 {r_{s}}^2}{\left(R^2+z^2\right) \left(\frac{\sqrt{R^2+z^2}}{r_{s}}+1\right)}\\
				\end{aligned}\end{align*}
				\sphinxAtStartPar
				Inserting the parameters given in \hyperref[\detokenize{NBodySimulation/Potential:tbl-parameters}]{Table \ref{\detokenize{NBodySimulation/Potential:tbl-parameters}}} and setting \(G\approx 4.302*10^{-6}\left [ \frac{kpc}{M_\odot}\frac{km^{2}}{s^{2}} \right ]\) results in \(\rho_{s}\approx 4.5*10^{6} \left [ \frac{M_\odot}{kpc^{3}} \right ]\)
				
				\sphinxAtStartPar
				the circular velocity can be used for fitting the model parameters {[}\hyperlink{cite.NBodySimulation/Appendix:id60}{1}{]}.
				\hyperref[\detokenize{NBodySimulation/Potential:fig-potential-circular-velocity}]{Fig.\@ \ref{\detokenize{NBodySimulation/Potential:fig-potential-circular-velocity}}} displays the velocity for the chosen model and its components.
				
				\begin{figure}[htbp]
				\centering
				\capstart
				
				\noindent\sphinxincludegraphics{{potential_circular_velocity}.pdf}
				\caption{Galactic rotation curve for the chosen MW model}\label{\detokenize{NBodySimulation/Potential:id9}}\label{\detokenize{NBodySimulation/Potential:fig-potential-circular-velocity}}\end{figure}
			
			
			\subsection{Angular Velocity}
				\label{\detokenize{NBodySimulation/Potential:angular-velocity}}
				\sphinxAtStartPar
				The angular velocity is required for initializing disc star velocities and can be obtained from the potential:
				\begin{equation*}
				\begin{split}\Omega ^{2}\left ( R \right ) = \frac{1}{R}\frac{\partial \Phi \left ( R,0 \right )}{\partial r}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				For the total potential \eqref{equation:NBodySimulation/Potential:total_potential} this derivation yields:
				\begin{equation*}
				\begin{split}\Omega ^{2}\left ( R \right ) = \frac{G}{R} \left\{-\frac{M_{bulge}}{(a_{bulge}+R)^2}+\frac{2 M_{disk} R^3}{\left[\left(a_{disk}+b_{disk}\right)^2+R^4\right]^{1.5}}+\frac{M_{bh}}{R^2}-\frac{4 \pi  p_{s} r_{s}^3}{R^2+R r_{s}}+\frac{4 \pi  p_{s} r_{s}^3 \ln \left(\frac{R+r_{s}}{r_{s}}\right)}{R^2}\right\}\end{split}
				\end{equation*}
			
			\subsection{Mass Distribution}
				\label{\detokenize{NBodySimulation/Potential:mass-distribution}}
				\sphinxAtStartPar
				The mass inside a volume is calculated by numerical integration of the density.
				GSL implementation of Monte Carlo Integration is used. For further details refer to the GSL \sphinxhref{https://www.gnu.org/software/gsl/doc/html/montecarlo.html}{documentation}.
				
				\begin{figure}[htbp]
				\centering
				\capstart
				
				\noindent\sphinxincludegraphics{{potential_mass_distribution}.pdf}
				\caption{Mass distribution at \(z_{GCA} = 1.0\) {[}kpc{]}. The bulge covers a smaller area in the xy-plane but has a much higher density compared to the disk.}\label{\detokenize{NBodySimulation/Potential:id10}}\label{\detokenize{NBodySimulation/Potential:fig-potential-mass-distribution}}\end{figure}
			
			
			\subsection{Surface Mass Density}
				\label{\detokenize{NBodySimulation/Potential:surface-mass-density}}
				\sphinxAtStartPar
				The surface mass density (SMD) is used to estimate the vertical velocity dispersion \eqref{equation:NBodySimulation/Initialization:vertical_velocity_dispersion} and is defined by
				\begin{equation}\label{equation:NBodySimulation/Potential:surface_mass_density}
				\begin{split}\Sigma \left ( R \right )=2\int_{0}^{\infty}\rho \left ( R,z \right )\mathrm{d}z\end{split}
				\end{equation}
				\begin{figure}[htbp]
				\centering
				\capstart
				
				\noindent\sphinxincludegraphics{{potential_surface_density}.pdf}
				\caption{The surface mass density of the disc and bulge}\label{\detokenize{NBodySimulation/Potential:id11}}\label{\detokenize{NBodySimulation/Potential:fig-potential-surface-density}}\end{figure}


		\section{Field Stars (FS)}
			\label{\detokenize{NBodySimulation/Initialization:field-stars-fs}}
			\sphinxAtStartPar
			Any star which does not belong to the simulated cluster is a FS and sampled from the disc and bulge potential described in {\hyperref[\detokenize{NBodySimulation/Potential:galactic-potential-label}]{\sphinxcrossref{\DUrole{std,std-ref}{Galactic Potential}}}}.
			
			\sphinxAtStartPar
			The cone of vision (COV) is defined by the angle of view \(\alpha\), the view distance \(h\) (height of the cone), the view point \(vP\) (location of the observer) and the focus \(F\) (a point along the line of sight).
			
			\sphinxAtStartPar
			The COV is constructed by transforming a right circular cone, where the vertex is at the origin and the circular base normal to the z axis.
			
			\sphinxAtStartPar
			Per transformation the tip of the cone is displaced from the origin to the view point \(vP\) and its axis is rotated to align with the line of sight \(l\).
			Consequently, the transformation consists of both translation and rotation illustrated in the following figure.
			
			\begin{figure}[htbp]
			\centering
			\capstart
			
			\noindent\sphinxincludegraphics{{cone}.pdf}
			\caption{Transformation of the cone of vision. Trial positions for FS are generated by sampling from the z-Axis aligned cone volume followed by a transformation leading to the positions falling within the volume of the focus \(F\) aligned cone.}\label{\detokenize{NBodySimulation/Initialization:id42}}\label{\detokenize{NBodySimulation/Initialization:fig-cone}}\end{figure}
			
			\sphinxAtStartPar
			Rotation and translation are both isometric transformations meaning area and volume of the cone are preserved {[}\hyperlink{cite.NBodySimulation/Appendix:id9}{15}{]} (p.175).
			
			\sphinxAtStartPar
			A unit quaternion \(\textbf{q}\) is used in order to construct the rotation matrix. With rotation axis \(\vec{b}\) and angle \(\beta\) the quaternion is given by
			\begin{equation*}
			\begin{split}\textbf{q} = \left ( \textup{cos}\left (\frac{\beta}{2}\right ), \vec{b}\textup{ sin}\left ( \frac{\beta}{2} \right )\right )\end{split}
			\end{equation*}
			\sphinxAtStartPar
			The rotation axis \(\vec{b}\) is the normalized cross product of the original (\(\vec{z}\)) and target (\(l\)) cone axis
			\begin{equation*}
			\begin{split}\vec{b}=\frac{\vec{z}\times\vec{l}}{\left \| \vec{z}\times\vec{l} \right \|}\end{split}
			\end{equation*}
			\sphinxAtStartPar
			The angle \(\beta\) between the vectors of interest can be calculated as follows
			\begin{equation*}
			\begin{split}\beta
			=\textup{atan2}\left ( \textup{tan}\left ( \beta \right ) \right )
			=\textup{atan2}\left ( \frac{\textup{sin}\left ( \beta \right )}{\textup{cos}\left ( \beta \right )} \right )
			=\textup{atan2}\left ( \frac{\left \| \vec{z}\times\vec{l} \right \|}{\vec{z}\cdot \vec{l}} \right )\end{split}
			\end{equation*}
			\sphinxAtStartPar
			Next, quaternion is converted to the rotation matrix {[}\hyperlink{cite.NBodySimulation/Appendix:id7}{21}{]}. Using the homogeneous notation {[}\hyperlink{cite.NBodySimulation/Appendix:id8}{34}{]} (p. 57) the matrix becomes:
			\begin{equation*}
			\begin{split}\mathbf{R}=\begin{bmatrix}
			q_{1}^{2}+q_{2}^{2}-q_{3}^{2}-q_{4}^{2} & -2q_{1}q_{4}+2q_{2}q_{3} & 2q_{1}q_{3}+2q_{2}q_{4} & 0\\
			2q_{1}q_{4}+2q_{2}q_{3} & q_{1}^{2}-q_{2}^{2}+q_{3}^{2}-q_{4}^{2} & -2q_{1}q_{2}+2q_{3}q_{4} & 0\\
			-2q_{1}q_{3}+2q_{2}q_{4} & 2q_{1}q_{2}+2q_{3}q_{4} & q_{1}^{2}-q_{2}^{2}-q_{3}^{2}+q_{4}^{2} & 0\\
			0  & 0 & 0 & 1
			\end{bmatrix}\end{split}
			\end{equation*}
			\sphinxAtStartPar
			The translation matrix for the translation vector \(\vec{t}\) reads {[}\hyperlink{cite.NBodySimulation/Appendix:id8}{34}{]} (p. 66):
			\begin{equation*}
			\begin{split}\mathbf{T_{translation}}=\begin{bmatrix}
			1 & 0 & 0 & t_{x}\\
			0 & 1 & 0 & t_{y}\\
			0 & 0 & 1 & t_{z}\\
			0  & 0 & 0 & 1
			\end{bmatrix}\end{split}
			\end{equation*}
			\sphinxAtStartPar
			The transformation matrix \(\mathbf{T}\) is the product of \(\mathbf{R}\) and \(\mathbf{T_{translation}}\)
			\begin{equation}\label{equation:NBodySimulation/Initialization:transformation_matrix}
			\begin{split}\mathbf{T}=\begin{bmatrix}
			 q_{1}^{2}+q_{2}^{2}-q_{3}^{2}-q_{4}^{2} & -2q_{1}q_{4}+2q_{2}q_{3} & 2q_{1}q_{3}+2q_{2}q_{4} & t_{x}\\
			 2q_{1}q_{4}+2q_{2}q_{3} & q_{1}^{2}-q_{2}^{2}+q_{3}^{2}-q_{4}^{2} & -2q_{1}q_{2}+2q_{3}q_{4} & t_{y}\\
			 -2q_{1}q_{3}+2q_{2}q_{4} & 2q_{1}q_{2}+2q_{3}q_{4} & q_{1}^{2}-q_{2}^{2}-q_{3}^{2}+q_{4}^{2} & t_{z}\\
			 0  & 0 & 0 & 1
			 \end{bmatrix}\end{split}
			\end{equation}
			\sphinxAtStartPar
			The total mass \(M\) of disc and bulge stars is obtained by integrating the respective density over the COV.
			
			\sphinxAtStartPar
			For a right circular cone
			\begin{equation*}
			\begin{split}\tan\left (\frac{\alpha }{2}  \right ) = \frac{R}{h}\end{split}
			\end{equation*}
			\sphinxAtStartPar
			and on its surface
			\begin{equation*}
			\begin{split}\tan\left (\frac{\alpha }{2}  \right ) = \frac{r}{z} \\
			z = \frac{h}{R}r\end{split}
			\end{equation*}
			\sphinxAtStartPar
			where \(R\) is the base radius of the cone and \(r = \sqrt{x^2+y^2}\). Hence \(\frac{h}{R}r\leq z\leq h\). Both \(x\) and \(y\) are bound by the base radius.
			Choosing \(\left | x \right | \leq R\) implies \(\left | y \right | \leq \sqrt{R^2-x^2}\).
			\begin{equation*}
			\begin{split}M = \int_{-R}^{R}\int_{-\sqrt{R^2-x^2}}^{\sqrt{R^2-x^2}}\int_{\frac{h}{R}r}^{h} \rho \left ( \mathbf{T}*\begin{pmatrix}x\\ y\\ z\end{pmatrix} \right ) dzdydx\end{split}
			\end{equation*}
			
			\subsection{Bulge Stellar Mass Function}
				\label{\detokenize{NBodySimulation/Initialization:bulge-stellar-mass-function}}
				\sphinxAtStartPar
				By rejection sampling the following function, given by {[}\hyperlink{cite.NBodySimulation/Appendix:id2}{40}{]}, the mass of bulge stars is determined.
				
				\sphinxAtStartPar
				For \(m<0.7\) the log\sphinxhyphen{}normal distribution equation \eqref{equation:NBodySimulation/Initialization:lognormal} is used. Parameters are \(A=3.6*10^{-4}\), \(m_{c}=0.22\) and \(\sigma=0.33\).
				For \(m>0.7\) a Salpeter slope \eqref{equation:NBodySimulation/Initialization:salpeter} with parameters \(A=7.1*10^{-5}\) and \(x=1.3\) is chosen.
				
				\sphinxAtStartPar
				Samples are drawn until the sum of all samples \(M_s = \sum_{i=1}^n m_i\) is larger than the total mass \(M\).
				If \(\sum_{i=1}^{n-1} m_i +\frac{m_n}{2} > M\) the last sample is removed.
				
				\begin{figure}[htbp]
				\centering
				\capstart
				
				\noindent\sphinxincludegraphics{{initial_conditions_mass_bulge}.pdf}
				\caption{\(10^3\) stars sampled from the bulge MF}\label{\detokenize{NBodySimulation/Initialization:id43}}\label{\detokenize{NBodySimulation/Initialization:fig-initial-conditions-mass-bulge}}\end{figure}
			
			
			\subsection{Disk Stellar Mass Function}
				\label{\detokenize{NBodySimulation/Initialization:disk-stellar-mass-function}}
				\sphinxAtStartPar
				Stars belonging to the disk are given a mass by rejection sampling the PDMF as given by {[}\hyperlink{cite.NBodySimulation/Appendix:id2}{40}{]}.
				
				\sphinxAtStartPar
				For \(m<1\) the PDMF reads
				\begin{equation}\label{equation:NBodySimulation/Initialization:lognormal}
				\begin{split}\xi\left(\mathrm{log}(m)\right) = \frac{\mathrm{dN}}{\mathrm{dlog}(m))} = A*\mathrm{exp}[ \frac{-( \mathrm{log}(m) -\mathrm{log}( m_{c} ))^{2} }{2 \sigma^{2}}]\end{split}
				\end{equation}
				\sphinxAtStartPar
				or equivalently (this version is sampled)
				\begin{equation*}
				\begin{split}\xi\left(m\right) = \frac{\mathrm{dN}}{\mathrm{dm}} = \frac{A}{m\mathrm{ln}(10)}*\mathrm{exp}[ \frac{-( \mathrm{log}(m) -\mathrm{log}( m_{c} ))^{2} }{2 \sigma^{2}}]\end{split}
				\end{equation*}
				\sphinxAtStartPar
				For \(m>1\) the PDMF has the form
				\begin{equation*}
				\begin{split}\xi\left(\mathrm{log}(m)\right) = \frac{\mathrm{dN}}{\mathrm{dlog}(m))} = A m^{-x}\end{split}
				\end{equation*}
				\sphinxAtStartPar
				or depending on \(m\) rather than \(\mathrm{log}(m)\)
				\begin{equation*}
				\begin{split}\xi\left(m\right) = \frac{\mathrm{dN}}{\mathrm{dm}} = \frac{A}{m\mathrm{ln}(10)} m^{-x}\end{split}
				\end{equation*}
				\begin{figure}[htbp]
				\centering
				\capstart
				
				\noindent\sphinxincludegraphics{{initial_conditions_mass_disk}.pdf}
				\caption{Stars with total mass of \(10^3 M_{\odot}\) sampled from disk PDMF}\label{\detokenize{NBodySimulation/Initialization:id44}}\label{\detokenize{NBodySimulation/Initialization:fig-initial-conditions-mass-disk}}\end{figure}
			
			
			\subsection{Positions}
				\label{\detokenize{NBodySimulation/Initialization:positions}}
				\sphinxAtStartPar
				The positions of the field stars within the cone of vision are generated in two steps of rejection sampling followed by the transformation \eqref{equation:NBodySimulation/Initialization:transformation_matrix}.
				
				\sphinxAtStartPar
				In the first step trial positions are drawn from a uniform distribution within a cuboid containing the cone.
				The boundaries of the cuboid are given by
				\begin{equation*}
				\begin{split}|x|\leq R \\
				|y|\leq R \\
				0\leq z\leq h\end{split}
				\end{equation*}
				\sphinxAtStartPar
				where \(R=h*\textup{tan}\left ( \frac{\alpha}{2} \right )\) is the base radius of the cone.
				
				\sphinxAtStartPar
				These trial positions are rejected in case they lie outside the boundaries of the cone.
				The conditions for acceptance are:
				\begin{equation*}
				\begin{split}\sqrt{x^{2}+y^{2}}\leq R \\
				z\geq h*\frac{\sqrt{x^{2}+y^{2}}}{R} \\\end{split}
				\end{equation*}
				\sphinxAtStartPar
				This method ensures that the positions are indeed homogeneously distributed, which is essential for the second step.
				
				\sphinxAtStartPar
				The second step consists of rejection sampling the density distribution.
				The test variable is drawn from a uniform distribution ranging from the smallest to the largest possible density within the cone volume.
				If this test variable is smaller than the density at the trial position generated in step two, the trial position is accepted and rejected otherwise.
				
				\sphinxAtStartPar
				Finally, the accepted position is transformed via the transformation matrix \eqref{equation:NBodySimulation/Initialization:transformation_matrix}.
				
				\begin{figure}[htbp]
				\centering
				\capstart
				
				\noindent\sphinxincludegraphics{{initial_conditions_positions}.pdf}
				\caption{Spatial distribution of a sample of disc and bulge stars}\label{\detokenize{NBodySimulation/Initialization:id45}}\label{\detokenize{NBodySimulation/Initialization:fig-initial-conditions-positions}}\end{figure}
			
			
			\subsection{Velocities}
				\label{\detokenize{NBodySimulation/Initialization:velocities}}
				
				\subsubsection{Particle Kinematics in Cylindrical Coordinates}
					\label{\detokenize{NBodySimulation/Initialization:particle-kinematics-in-cylindrical-coordinates}}
					\sphinxAtStartPar
					In terms of Cartesian unit vectors, cylindrical unit vectors are given by
					\begin{equation*}
					\begin{split}\hat{e}_R = \hat{e}_x\cos(\phi) + \hat{e}_y\sin(\phi) \\
					\hat{e}_\phi = -\hat{e}_x\sin(\phi) + \hat{e}_y\cos(\phi)\\
					\hat{e}_z = \hat{e}_z\end{split}
					\end{equation*}
					\sphinxAtStartPar
					Since \(\hat{e}_R\) depends on \(\phi\), position vectors have the form
					\begin{equation*}
					\begin{split}\vec{q} = R\hat{e}_R+z\hat{e}_z\end{split}
					\end{equation*}
					\sphinxAtStartPar
					derivation by time gives the velocity
					\begin{equation}\label{equation:NBodySimulation/Initialization:cylindrical_velocity}
					\begin{split}\vec{v} = \dot{R}\hat{e}_R+R\dot{\phi}\hat{e}_\phi+\dot{z}\hat{e}_z\end{split}
					\end{equation}
				
				\subsubsection{Lagrangian with axisymmetric potential}
					\label{\detokenize{NBodySimulation/Initialization:lagrangian-with-axisymmetric-potential}}
					\sphinxAtStartPar
					Using \eqref{equation:NBodySimulation/Initialization:cylindrical_velocity} the Lagrangian per unit mass reads
					\begin{equation*}
					\begin{split}L =\frac{1}{2}\left( \dot{R}^2+R^2\dot{\phi}^2+\dot{z}^2 \right)+\Phi\left(R,z\right)\end{split}
					\end{equation*}
					\sphinxAtStartPar
					and using the Euler\textendash{}Lagrange equation gives the conjugate momenta
					\begin{equation}\label{equation:NBodySimulation/Initialization:conjugate_momenta}
					\begin{split}p_{R} = \frac{\partial L}{\partial \dot{R}} = \dot{R} \\
					 p_{\phi} = \frac{\partial L}{\partial \dot{\phi}} = R^2\dot{\phi} \\
					 p_{z} = \frac{\partial L}{\partial \dot{z}} = \dot{z} \\\end{split}
					\end{equation}
				
				\subsubsection{Hamiltonian with axisymmetric potential}
					\label{\detokenize{NBodySimulation/Initialization:hamiltonian-with-axisymmetric-potential}}
					\sphinxAtStartPar
					Using the momenta in cylindrical coordinates \eqref{equation:NBodySimulation/Initialization:conjugate_momenta} the Hamiltonian per unit mass with an axisymmetric potential reads ({[}\hyperlink{cite.NBodySimulation/Appendix:id17}{6}{]} p. 278)
					\begin{equation}\label{equation:NBodySimulation/Initialization:hamilton_1}
					\begin{split}H = \frac{1}{2}\left( p_{R}^2+\frac{p_\phi^2}{R^2}+p_z^2 \right)+\Phi\left(R,z\right)\end{split}
					\end{equation}
					\sphinxAtStartPar
					using Hamiltons equations gives
					\begin{equation}\label{equation:NBodySimulation/Initialization:hamilton_2_1}
					\begin{split}\dot{p}_{R} = -\frac{\partial H}{\partial R} = \frac{p_\phi^2}{R^3}-\frac{\partial \Phi }{\partial R}\end{split}
					\end{equation}\begin{equation}\label{equation:NBodySimulation/Initialization:hamilton_2_2}
					\begin{split}\dot{p}_{\phi} = -\frac{\partial H}{\partial \phi} = -\frac{\partial \Phi }{\partial \phi} = 0\end{split}
					\end{equation}\begin{equation}\label{equation:NBodySimulation/Initialization:hamilton_2_3}
					\begin{split}\dot{p}_{z} = -\frac{\partial H}{\partial z} = -\frac{\partial \Phi }{\partial z}\end{split}
					\end{equation}
					\sphinxAtStartPar
					Since \(\vec{L} = \vec{p} \times \vec{\dot{p}}\) and thus
					\begin{equation}\label{equation:NBodySimulation/Initialization:angular_momentum}
					\begin{split}L_z = R^2\dot{\phi}\end{split}
					\end{equation}
					\sphinxAtStartPar
					, the second equation above signifies that, in the case of an axisymmetric potential, the z component of the angular momentum is conserved.
				
				
				\subsubsection{The phase space distribution function (DF)}
					\label{\detokenize{NBodySimulation/Initialization:the-phase-space-distribution-function-df}}
					\sphinxAtStartPar
					A galaxy can be viewed as a number of stars in phase space.
					The phase space is a six dimensional space spanned by position \(\vec{q}\) and momentum \(\vec{p}\).
					One point in phase space can therefore be described by a six dimensional vector \(\vec{w}=(\vec{q},\vec{p})\),
					the state of a whole galaxy as a DF \(f(\vec{q},\vec{p},t)\).
					\(f(\vec{q},\vec{p},t)d^3\vec{q}d^3\vec{p}\) is the probability that some specific star is inside the 6D cuboid defined by \(d^3\vec{q}d^3\vec{p}\) at time \(t\).
					
					\sphinxAtStartPar
					The conservation of probability in phase space is, similarly to the continuity equation in fluid dynamics, given by
					\begin{equation*}
					\begin{split}\frac{\partial f }{\partial t} + \sum_{i=1}^{6} \frac{\partial}{\partial w_i}(f\dot{w}_i) = 0\end{split}
					\end{equation*}
					\sphinxAtStartPar
					with \(\dot{\vec{w}} = (\dot{\vec{q}},\dot{\vec{p}})\).
					
					\sphinxAtStartPar
					The right summand can be changed as follows, using Hamilton equations
					\begin{equation*}
					\begin{split}\sum_{i=1}^{6} \frac{\partial}{\partial w_i}(f\dot{w}_i)
					= \sum_{i=1}^{3} \left ( \frac{\partial}{\partial q_i}\left(f \dot{q}_i\right) + \frac{\partial}{\partial p_i}\left(f\dot{p}_i\right) \right ) \\
					= \sum_{i=1}^{3} \left ( \frac{\partial}{\partial q_i}\left(f \frac{\partial H}{\partial p_i}\right) - \frac{\partial}{\partial p_i}\left(f \frac{\partial H}{\partial q_i} \right) \right) \\
					= \sum_{i=1}^{3} \left (
					\frac{\partial f}{\partial q_i} \frac{\partial H}{\partial p_i}
					+ f  \frac{\partial^2 H}{\partial q_i \partial p_i}
					- \frac{\partial f}{\partial p_i}  \frac{\partial H}{\partial q_i}
					- f \frac{\partial ^2 H}{\partial p_i \partial q_i} \right)  \\
					= \sum_{i=1}^{3} \left (
					\frac{\partial f}{\partial q_i} \frac{\partial H}{\partial p_i}
					- \frac{\partial f}{\partial p_i}  \frac{\partial H}{\partial q_i} \right)\end{split}
					\end{equation*}
					\sphinxAtStartPar
					And therefore
					\begin{equation}\label{equation:NBodySimulation/Initialization:collisionless_boltzmann_equation}
					\begin{split}\frac{\partial f }{\partial t} + \sum_{i=1}^{3} \left (
					 \frac{\partial f}{\partial q_i} \frac{\partial H}{\partial p_i}
					 - \frac{\partial f}{\partial p_i}  \frac{\partial H}{\partial q_i} \right) = 0\end{split}
					\end{equation}
					\sphinxAtStartPar
					which is the collisionless Boltzmann Equation (CBE).
					
					\sphinxAtStartPar
					The zeroth moment of the DF is the number density:
					\begin{equation*}
					\begin{split}\nu(\vec{x}) \equiv \int f(\vec{x},\vec{v})d^3\vec{v}\end{split}
					\end{equation*}
					\sphinxAtStartPar
					Mean velocities are given by the first moment:
					\begin{equation*}
					\begin{split}\overline{v_i}(\vec{x}) \equiv \frac{1}{\nu(\vec{x})}\int v_i f(\vec{x},\vec{v})d^3\vec{v}\end{split}
					\end{equation*}
					\sphinxAtStartPar
					Todo(?): Continue here (showing = 0 for 2/3 directions)
				
				
				\subsubsection{Jeans equations}
					\label{\detokenize{NBodySimulation/Initialization:jeans-equations}}
					\sphinxAtStartPar
					Using Einstein notation for \(i=1,2,3\) the CBE \eqref{equation:NBodySimulation/Initialization:collisionless_boltzmann_equation} is given by ({[}\hyperlink{cite.NBodySimulation/Appendix:id17}{6}{]} p. 277):
					\begin{equation*}
					\begin{split}\frac{\partial f}{\partial t} + \frac{\partial f}{\partial q_i}\frac{\partial H}{\partial p_i} - \frac{\partial f}{\partial p_i}\frac{\partial H}{\partial q_i} = 0\end{split}
					\end{equation*}
					\sphinxAtStartPar
					Since the galactic potential \eqref{equation:NBodySimulation/Potential:total_potential} is axisymmetric, it is convenient to express this equation in cylindrical coordinates.
					\begin{equation}\label{equation:NBodySimulation/Initialization:jeans_equations_1}
					\begin{split}\frac{\partial f}{\partial t}
					 + p_R\frac{\partial f}{\partial R}
					 + \frac{p_\phi}{R^2}\frac{\partial f}{\partial \phi}
					 + p_z\frac{\partial f}{\partial z}
					 - \left(\frac{\partial \Phi}{\partial R}-\frac{p_\phi^2}{R^3}\right)\frac{\partial f}{\partial p_R}
					 - \frac{\partial \Phi}{\partial \phi}\frac{\partial f}{\partial p_\phi}
					 - \frac{\partial \Phi}{\partial z}\frac{\partial f}{\partial p_z} = 0\end{split}
					\end{equation}
					\sphinxAtStartPar
					It is assumed that the galaxy is statistically in a steady state ({[}\hyperlink{cite.NBodySimulation/Appendix:id18}{4}{]}) i.e. \(\frac{\partial f}{\partial t}=0\).
					Due to this assumption and taking \eqref{equation:NBodySimulation/Initialization:hamilton_2_2} into account \eqref{equation:NBodySimulation/Initialization:jeans_equations_1} simplifies to
					\begin{equation}\label{equation:NBodySimulation/Initialization:jeans_equations_2}
					\begin{split}p_R\frac{\partial f}{\partial R}
					 + \frac{p_\phi}{R^2}\frac{\partial f}{\partial \phi}
					 + p_z\frac{\partial f}{\partial z}
					 - \left(\frac{\partial \Phi}{\partial R}-\frac{p_\phi^2}{R^3}\right)\frac{\partial f}{\partial p_R}
					 - \frac{\partial \Phi}{\partial z}\frac{\partial f}{\partial p_z} = 0\end{split}
					\end{equation}
					\sphinxAtStartPar
					Multiplying equation \eqref{equation:NBodySimulation/Initialization:jeans_equations_2} by \(p_R\) and integrating over all momenta leads to (todo: derive?)
					\begin{equation}\label{equation:NBodySimulation/Initialization:jeans_equations_3}
					\begin{split}\frac{\partial \nu \overline{v_R^2}}{\partial R}+\frac{\partial \nu \overline{v_Rv_z}}{\partial z} +
					 \nu \left ( \frac{\overline{v_R^2}-\overline{v_\phi^2}}{R} + \frac{\partial\Phi}{\partial R}\right ) = 0\end{split}
					\end{equation}
				
				\subsubsection{The Epicyclic Approximation}
					\label{\detokenize{NBodySimulation/Initialization:the-epicyclic-approximation}}
					\sphinxAtStartPar
					Individual stars in the disk are on nearly circular orbits.
					Such orbits can be approximated by circular orbits with additional retrograde elliptical orbits around the guiding center.
					
					\sphinxAtStartPar
					The derivation of this approximation starts with Hamiltons equations for an axisymmetric potential.
					
					\sphinxAtStartPar
					Rearranging \eqref{equation:NBodySimulation/Initialization:hamilton_1} and using \eqref{equation:NBodySimulation/Initialization:angular_momentum} gives
					\begin{equation*}
					\begin{split}H = \frac{1}{2}\left( p_{R}^2+p_z^2 \right)+\frac{L_z^2}{2R^2}+\Phi\left(R,z\right)\end{split}
					\end{equation*}
					\sphinxAtStartPar
					With the effective potential given by
					\begin{equation*}
					\begin{split}\Phi_{\textup{eff}}\left(R,z\right) = \frac{L_z^2}{2R^2}+\Phi\left(R,z\right)\end{split}
					\end{equation*}
					\sphinxAtStartPar
					leads to
					\begin{equation*}
					\begin{split}H_{\textup{eff}} = \frac{1}{2}\left( p_{R}^2+p_z^2 \right)+\Phi_{\textup{eff}}\left(R,z\right)\end{split}
					\end{equation*}
					\sphinxAtStartPar
					Here \(\frac{1}{2m}\left( p_{R}^2+p_z^2 \right)\) is the kinetic energy in the \(\left( R,z \right)\) plane or meridional plane.
					The angular momentum term in the effective potential is not a real potential energy even though sometimes called centrifugal potential.
					It really is the angular kinetic energy. The given definition of \(\Phi_{\textup{eff}}\) is only valid because \(L_z\) is conserved.
					
					\sphinxAtStartPar
					Using \(\Phi_{\textup{eff}}\) \eqref{equation:NBodySimulation/Initialization:hamilton_2_1} and \eqref{equation:NBodySimulation/Initialization:hamilton_2_3} can be written as
					\begin{equation}\label{equation:NBodySimulation/Initialization:hamilton_eff_1}
					\begin{split}\dot{p}_{R} = -\frac{\partial \Phi_{\textup{eff}} }{\partial R}\end{split}
					\end{equation}\begin{equation}\label{equation:NBodySimulation/Initialization:hamilton_eff_2}
					\begin{split}\dot{p}_{z} = -\frac{\partial \Phi_{\textup{eff}} }{\partial z}\end{split}
					\end{equation}
					\sphinxAtStartPar
					These equations describe harmonic oscillations in the effective potential.
					The minimum of effective potential is the minimum of the real potential energy, together with a contribution from the angular kinetic energy.
					\begin{equation*}
					\begin{split}\frac{\partial \Phi_{\textup{eff}} }{\partial R} = \frac{\partial \Phi }{\partial R} - \frac{L_z^2}{R^3} =0 \\
					\frac{\partial \Phi_{\textup{eff}} }{\partial z} = 0\end{split}
					\end{equation*}
					\sphinxAtStartPar
					The first condition states that the attractive force (\(-\frac{\partial \Phi_{\textup{eff}} }{\partial R}\)) has to balance the centrifugal force.
					This is the condition for circular orbits with angular momentum \(L_z\).
					The second condition is clearly satisfied in the equatorial plane (\(z=0\)).
					The coordinates of this guiding centre are defined as \((R_g,\phi_g,z_g)\).
					
					\sphinxAtStartPar
					In preparation for a Taylor series expansion about the guiding centre, \(x\) is defined as
					\begin{equation*}
					\begin{split}x \equiv R - R_g\end{split}
					\end{equation*}
					\sphinxAtStartPar
					If \(R = R_g\) then \(x=0\) and therefor the guiding centre is at \((x,z) = (0,0)\).
					\begin{equation*}
					\begin{split}\Phi_{\textup{eff}} = \Phi_{\textup{eff}}(R_g,0) +
					\frac{\partial \Phi_{\textup{eff}} }{\partial R}\bigg|_{(R_g,0)}x +
					\frac{\partial \Phi_{\textup{eff}} }{\partial z}\bigg|_{(R_g,0)}z +
					\frac{1}{2}\frac{\partial^2 \Phi_{\textup{eff}} }{\partial R^2}\bigg|_{(R_g,0)}x^2 +
					\frac{1}{2}\frac{\partial^2 \Phi_{\textup{eff}} }{\partial z^2}\bigg|_{(R_g,0)}z^2 +
					\frac{1}{2}\frac{\partial^2 \Phi_{\textup{eff}} }{\partial x\partial z}\bigg|_{(R_g,0)}xz +
					\mathcal{O}(xz^2)\end{split}
					\end{equation*}
					\sphinxAtStartPar
					The first order terms are zero (since \(\Phi_{\textup{eff}}\) is minimized at the guiding centre) and so is the \(xz\), the later due to symmetric about \(z=0\).
					
					\sphinxAtStartPar
					In the epicyclic approximation \(\mathcal{O}(xz^2)\) and higher order terms are neglected.
					
					\sphinxAtStartPar
					With this approximation \eqref{equation:NBodySimulation/Initialization:hamilton_eff_1} and \eqref{equation:NBodySimulation/Initialization:hamilton_eff_2} become
					\begin{align}\label{equation:NBodySimulation/Initialization:hamilton_eff_approx}\!\begin{aligned}
					\dot{p}_{x} = -\frac{\partial \Phi_{\textup{eff}} }{\partial x} \approx
					 -\frac{\partial^2 \Phi_{\textup{eff}} }{\partial R^2}\bigg|_{(R_g,0)}x \equiv
					 -\kappa^2x\\
					\dot{p}_{z} = -\frac{\partial \Phi_{\textup{eff}} }{\partial z} \approx
					 -\frac{\partial^2 \Phi_{\textup{eff}} }{\partial z^2}\bigg|_{(R_g,0)}z \equiv
					 -\nu^2z   \\\\
					\end{aligned}\end{align}
					\sphinxAtStartPar
					where the epicyclic frequency \(\kappa\) is the frequency of small radial and the vertical frequency \(\nu\) the frequency of small vertical oscillations.
					
					\sphinxAtStartPar
					With potential \(\Phi\left(R,z\right)\) \eqref{equation:NBodySimulation/Initialization:hamilton_eff_approx} can be written as
					\begin{equation}\label{equation:NBodySimulation/Initialization:kappa_squared}
					\begin{split}\kappa^2 = \frac{\partial^2\Phi}{\partial R^2}\bigg|_{(R_g,0)} + \frac{3L_z^3}{R_g^4}\end{split}
					\end{equation}
					\sphinxAtStartPar
					The combination of \eqref{equation:NBodySimulation/Initialization:conjugate_momenta} with \eqref{equation:NBodySimulation/Initialization:hamilton_2_1}, given \(\dot{p}_{R}=0\) and by definition \(\Omega = \dot{\phi}\), results in the circular angular frequency
					\begin{equation}\label{equation:NBodySimulation/Initialization:circular_angular_frequency}
					\begin{split}\Omega^2 = \frac{1}{R} \frac{\partial \Phi }{\partial R}\bigg|_{(R_g,0)} = \frac{L_z^2}{R^4}\end{split}
					\end{equation}
					\sphinxAtStartPar
					The derivative of \eqref{equation:NBodySimulation/Initialization:circular_angular_frequency} is
					\begin{equation}\label{equation:NBodySimulation/Initialization:circular_angular_frequency_2}
					\begin{split}\frac{\partial^2\Phi}{\partial R^2} = \Omega^2 + R \frac{d\Omega^2}{dR}\end{split}
					\end{equation}
					\sphinxAtStartPar
					Inserting \eqref{equation:NBodySimulation/Initialization:circular_angular_frequency} and \eqref{equation:NBodySimulation/Initialization:circular_angular_frequency_2} into \eqref{equation:NBodySimulation/Initialization:kappa_squared} yields
					\begin{equation}\label{equation:NBodySimulation/Initialization:epicyclic_frequency}
					\begin{split}\kappa^2(R_g) = \left ( R\frac{d\Omega^2}{dR} + 4\Omega^2 \right )\bigg|_{R=R_g}\end{split}
					\end{equation}
					\sphinxAtStartPar
					The variance is generally given as the mean of squares minus the square of means.
					In the epicyclic approximation the mean velocity in \(R\) and \(z\) is zero and therefor
					\begin{equation}\label{equation:NBodySimulation/Initialization:epicyclic_variance}
					\begin{split}\sigma_{v_{\phi}}^2 = \overline{v_\phi^2} - \overline{v_\phi}^2 \\
					\sigma_{v_{R}}^2 = \overline{v_R^2} \\
					\sigma_{v_{z}}^2 = \overline{v_z^2}\end{split}
					\end{equation}
				
				\subsubsection{Disk}
					\label{\detokenize{NBodySimulation/Initialization:disk}}
					\sphinxAtStartPar
					The velocity distribution of stars in the Milky Way disk is approximated with the help of Jeans equations as well as relations and constraints based on observations.
					
					\sphinxAtStartPar
					For a flat rotation curve the radial velocity dispersion exponentially decreases with increasing radius {[}\hyperlink{cite.NBodySimulation/Appendix:id14}{59}{]} (p. 114)
					\begin{equation}\label{equation:NBodySimulation/Initialization:radial_velocity_dispersion_1}
					\begin{split}\sigma_{v_{R}} \propto e^{-\frac{R}{h}}\end{split}
					\end{equation}
					\sphinxAtStartPar
					where \(h\) in the case of the Miyamoto Nagai potential is the radial scale length \(a\).
					
					\sphinxAtStartPar
					The relation \eqref{equation:NBodySimulation/Initialization:radial_velocity_dispersion_1} still requires a constant factor \(k\), which can be determined by means of the Toomre parameter \(Q\) at some distance \(R_{ref}\).
					
					\sphinxAtStartPar
					\(Q\) is the ratio between the actual and minimum velocity dispersion \(\sigma_{v_{R,min}}\) {[}\hyperlink{cite.NBodySimulation/Appendix:id16}{57}{]} (p. 1234)
					\begin{equation*}
					\begin{split}\sigma_{v_{R,min}} = \frac{3.36G\Sigma}{\kappa} \\
					Q \equiv \frac{\sigma_{v_{R}}}{\sigma_{v_{R,min}}} = \frac{\kappa \sigma_{v_{R}}}{3.36G\Sigma }\end{split}
					\end{equation*}
					\sphinxAtStartPar
					where \(\kappa\) denotes the epicyclic frequency \eqref{equation:NBodySimulation/Initialization:epicyclic_frequency}.
					
					\sphinxAtStartPar
					In the solar neighborhood \(Q_{\ast} = 2.7 \pm 0.4\) and \(\sigma_{v_{R}} = (38 \pm 2) \left [ \frac{km}{s} \right ]\) {[}\hyperlink{cite.NBodySimulation/Appendix:id17}{6}{]} (p. 497)
					
					\sphinxAtStartPar
					The constant \(k\) can therefore be approximated via
					\begin{equation}\label{equation:NBodySimulation/Initialization:radial_velocity_dispersion_constant}
					\begin{split}k \cong Q \sigma_{v_{R,min}}e^{\frac{R}{h}}\end{split}
					\end{equation}
					\sphinxAtStartPar
					Under the approximation of isothermal sheets (introduced in {[}\hyperlink{cite.NBodySimulation/Appendix:id14}{59}{]}), the vertical velocity dispersion only depends on the surface density {[}\hyperlink{cite.NBodySimulation/Appendix:id15}{58}{]}
					\begin{equation}\label{equation:NBodySimulation/Initialization:vertical_velocity_dispersion}
					\begin{split}\sigma_{v_{z}} = \pi G \Sigma \left ( R \right )z_{0}\end{split}
					\end{equation}
					\sphinxAtStartPar
					with \(z_{0}\) being the vertical scale length \(b\) when using the Miyamoto Nagai potential.
					
					\sphinxAtStartPar
					Combining the equation for the circular velocity \eqref{equation:NBodySimulation/Potential:circular_velocity} and Jeans equation \eqref{equation:NBodySimulation/Initialization:jeans_equations_3} and multiplication by \(\frac{R}{\nu}\) results in
					\begin{equation}\label{equation:NBodySimulation/Initialization:disk_velocity_step_1}
					\begin{split}\frac{R}{\nu} \frac{\partial \nu \overline{v_R^2}}{\partial R}
					+ \frac{R}{\nu} \frac{\partial \nu \overline{v_Rv_z}}{\partial z}
					+ \overline{v_R^2}-\overline{v_\phi^2} + v_c^2 = 0\end{split}
					\end{equation}
					\sphinxAtStartPar
					For a razor thin disc the spatial density \(\nu\) can be replaced with the surface density \(\Sigma\) {[}\hyperlink{cite.NBodySimulation/Appendix:id19}{45}{]},
					which does not depend on \(z\). With this and by using relations \eqref{equation:NBodySimulation/Initialization:epicyclic_variance}, \eqref{equation:NBodySimulation/Initialization:disk_velocity_step_1} simplifies to
					\begin{equation}\label{equation:NBodySimulation/Initialization:disk_velocity_step_2}
					\begin{split}\frac{R}{\Sigma} \frac{\partial \nu \sigma_{v_{R}}^2}{\partial R}
					+ R \frac{\partial \overline{v_Rv_z}}{\partial z}
					+ \sigma_{v_{R}}^2 -\sigma_{v_{\phi}}^2  - \overline{v_\phi}^2 + v_c^2 = 0\end{split}
					\end{equation}
					\sphinxAtStartPar
					In the epicyclic approximation, azimuthal and radial dispersion have the following relation ({[}\hyperlink{cite.NBodySimulation/Appendix:id17}{6}{]} p. 170)
					\begin{equation}\label{equation:NBodySimulation/Initialization:azimuthal_velocity_dispersion}
					\begin{split}\frac{\sigma_{v_{\phi}}^2}{\sigma_{v_{R}}^2} = \frac{\kappa^2}{4\Omega^2}\end{split}
					\end{equation}
					\sphinxAtStartPar
					With this relation \eqref{equation:NBodySimulation/Initialization:disk_velocity_step_2} can be written as
					\begin{equation*}
					\begin{split}\frac{R}{\Sigma} \frac{\partial  \left ( \Sigma \sigma_{v_{R}}^2 \right ) }{\partial R}
					+ R \frac{\partial \overline{v_Rv_z}}{\partial z}
					+ \sigma_{v_{R}}^2
					- \sigma_{v_{R}}^2 \frac{\kappa^2}{4\Omega^2}
					- \overline{v_\phi}^2 + v_c^2 = 0\end{split}
					\end{equation*}
					\sphinxAtStartPar
					rearrangements lead to
					\begin{equation}\label{equation:NBodySimulation/Initialization:disk_velocity_step_3}
					\begin{split}\overline{v_\phi}^2 - v_c^2 = \sigma_{v_{R}}^2
					\left (
					1 - \frac{\kappa^2}{4\Omega^2} +
					\frac{R}{\Sigma \sigma_{v_{R}}^2 } \frac{\partial \left ( \Sigma \sigma_{v_{R}}^2 \right ) }{\partial R}
					+ \frac{R}{\sigma_{v_{R}}^2} \frac{\partial \overline{v_Rv_z}}{\partial z}
					\right )\end{split}
					\end{equation}
					\sphinxAtStartPar
					Due to the exponential dependency of the surface mass density ({[}\hyperlink{cite.NBodySimulation/Appendix:id17}{6}{]} p. 325)
					and the radial dispersion \(\sigma_{v_{R}}\) \eqref{equation:NBodySimulation/Initialization:radial_velocity_dispersion_1} on \(R\), the derivation after \(R\) summand can be solved as follows
					\begin{equation*}
					\begin{split}\frac{R}{\Sigma \sigma_{v_{R}}^2 } \frac{\partial \left ( \Sigma \sigma_{v_{R}}^2 \right ) }{\partial R} =
					\frac{1}{\Sigma \sigma_{v_{R}}^2 } \frac{\partial R }{\partial \ln(R)}\frac{\partial \left ( \Sigma \sigma_{v_{R}}^2 \right ) }{\partial R} =
					\frac{1}{\Sigma \sigma_{v_{R}}^2 } \frac{\partial \left ( \Sigma \sigma_{v_{R}}^2 \right ) }{\partial \ln(R)} =
					\frac{1}{\Sigma \sigma_{v_{R}}^2 }
					\left ( - \frac{R\Sigma\sigma_{v_{R}}^2}{a}
					- \frac{R\sigma_{v_{R}}^2\Sigma}{a}
					\right ) = - 2 \frac{R}{a}\end{split}
					\end{equation*}
					\sphinxAtStartPar
					With this and under the assumption that the retrograde elliptical orbit is aligned with the coordinate axes \eqref{equation:NBodySimulation/Initialization:disk_velocity_step_3} becomes
					\begin{equation}\label{equation:NBodySimulation/Initialization:disk_velocity_step_4}
					\begin{split}\overline{v_\phi}^2 - v_c^2 = \sigma_{v_{R}}^2
					\left (1 - \frac{\kappa^2}{4\Omega^2} -\frac{R}{a } \right )\end{split}
					\end{equation}
					\sphinxAtStartPar
					The velocity components can be sampled from Gaussian distributions. Dispersions are obtained by first evaluating the epicyclic frequency \eqref{equation:NBodySimulation/Initialization:epicyclic_frequency} and the surface mass density \eqref{equation:NBodySimulation/Potential:surface_mass_density},
					followed by the radial velocity dispersion \eqref{equation:NBodySimulation/Initialization:radial_velocity_dispersion_1} with constant factor \eqref{equation:NBodySimulation/Initialization:radial_velocity_dispersion_constant}, the vertical \eqref{equation:NBodySimulation/Initialization:vertical_velocity_dispersion} and the azimuthal velocity dispersion \eqref{equation:NBodySimulation/Initialization:azimuthal_velocity_dispersion}.
					As noted before, the mean velocity in \(R\) and \(z\) is zero. For \(\phi\) the mean velocity is calculated from \eqref{equation:NBodySimulation/Initialization:disk_velocity_step_4}, where the circular velocity \(v_c\) is given by \eqref{equation:NBodySimulation/Potential:circular_velocity}.
					
				
				\subsubsection{Bulge}
					\label{\detokenize{NBodySimulation/Initialization:bulge}}
					\sphinxAtStartPar
					For spherically symmetric distribution functions, such as, with the present approximation, the bulge, the spherically symmetric Jeans equation can be used {[}\hyperlink{cite.NBodySimulation/Appendix:id20}{37}{]}
					\begin{equation}\label{equation:NBodySimulation/Initialization:bulge_velocity_1}
					\begin{split}\frac{\partial (\rho \sigma_r^2)}{\partial r} + 2\frac{\beta\sigma_r^2}{r} + \rho\frac{\partial \Phi}{\partial r} = 0\end{split}
					\end{equation}
					\sphinxAtStartPar
					where \(\beta\) is an indicator for anisotropy in radial and tangential direction.
					\begin{equation*}
					\begin{split}\beta = 1 - \frac{\sigma^2_\phi}{\sigma^2_r}\end{split}
					\end{equation*}
					\sphinxAtStartPar
					If the distribution is isotropic, as assumed here, \(\beta=0\) and \eqref{equation:NBodySimulation/Initialization:bulge_velocity_1} simplifies to
					\begin{equation*}
					\begin{split}\frac{\partial (\rho \sigma_r^2)}{\partial r} +  \rho\frac{\partial \Phi}{\partial r} = 0\end{split}
					\end{equation*}
					\sphinxAtStartPar
					and the radial dispersion can be calculated by integration
					\begin{equation*}
					\begin{split}\sigma_r^2 = \frac{1}{\rho}\int_{r}^{\infty}\rho \frac{\partial \Phi}{\partial r}\textup{dr}\end{split}
					\end{equation*}
					\sphinxAtStartPar
					However, \(\Phi\) is the composite potential consisting of bulge, disc and halo and therefore not spherically symmetric. As suggested in {[}\hyperlink{cite.NBodySimulation/Appendix:id19}{45}{]}, contribution by the disc to the bulge dispersion may be accounted for by spherically averaging the disc potential.
					This is achieved by expressing the cylinder in spherical coordinates and integrating over the relevant angle
					\begin{equation*}
					\begin{split}\sigma_{r,disk}^2 = \frac{1}{\rho}\int_{r}^{\infty}
					\frac{\rho }{2\pi}  \int_0^{2\pi} \frac{\partial \Phi\left ( r\sin(\theta ),r\cos(\theta ) \right )}{\partial r} \textup{d}\theta \textup{dr} \\\end{split}
					\end{equation*}
					\sphinxAtStartPar
					As neither of these integrals have an analytical solution, this calculation is computationally intensive.
					Therefore a lookup table has been implemented in which discrete \(r\) and corresponding bulge dispersion are stored.
					
					\begin{figure}[htbp]
					\centering
					\capstart
					
					\noindent\sphinxincludegraphics{{velocity_dispersion_bulge}.pdf}
					\caption{Velocity dispersion of bulge stars}\label{\detokenize{NBodySimulation/Initialization:id46}}\end{figure}
					
					\sphinxAtStartPar
					In the figure above results are compared with observations from {[}\hyperlink{cite.NBodySimulation/Appendix:id21}{20}{]}. These results were generated using a view distance of 7.5kpc.
					The other parameters are given in \hyperref[\detokenize{NBodySimulation/Potential:tbl-parameters}]{Table \ref{\detokenize{NBodySimulation/Potential:tbl-parameters}}}. The radial velocity dispersion heavily depends on the scale parameter of the bulge potential.
					With the current choice, the dispersion at small \(r\) is lower than realistic. This issue could be solved by adding an additional potential with smaller scale radius.
					A multi component bulge model has been suggested for instance by {[}\hyperlink{cite.NBodySimulation/Appendix:id22}{31}{]}.

	\chapter{Data storage}
		\label{\detokenize{NBodySimulation/Database:database}}\label{\detokenize{NBodySimulation/Database::doc}}
		\sphinxAtStartPar
		A SQLite Database is used to store simulations including all relevant parameters, stars with their respective positions and velocities as well as data resulting from analysis.
		SQLite supports both C++ and python. And is therefore used in most data related parts of the project. Generated data can be loaded and plotted directly from the database.
		Previously performed simulations can be loaded from the database in order to carry out analysis like energy vs time or average star velocity vs time.
		
		\sphinxAtStartPar
		Due to bad performance, no foreign key constraints where set for position.id\_star and velocity.id\_star.
		A multi\sphinxhyphen{}column index is used to improve the execution time of queries containing both velocity.timestep and velocity.id\_star.
		NULL values are avoided where possible. However, at many stages during execution, some information is unknown, but creating entries is still required.
		Observed stars contain no information about their mass or GCA phase space coordinates, some cannot be mapped to simulated stars, etc.
		
		
		\section{Entity Relationship Diagram}
		\label{\detokenize{NBodySimulation/Database:entity-relationship-diagram}}
		\noindent\sphinxincludegraphics{{ERD}.pdf}

	\renewcommand{\abstractname}{Summary}
	\begin{abstract}
		\highLight[{[RGB]{232,209,82}}]{Masses, positions and velocities of cluster and field stars are generated within the volume of a cone representing the space visible with the ELT and stored in a database.
		With each time step all of these positions and velocities are updated. Every set amount of timesteps the data is stored in the database.
 		Field stars are only influenced by the galactic potential but cluster stars influence each other. 
		Hence, the BarnesHut algorithm has been implemented to allow for reasonably large clusters to be simulated with limited hardware.
		Many parameters can be set by the user such as position of the observer, view angle, view distance, location of the cluster, time step size and amount of time steps between observations.}
	\end{abstract}

\part{Observing The Milky Way Galaxy}

\chapter{Coordinate Systems}
\label{\detokenize{NBodySimulation/CoordinateSystems:coordinate-systems}}\label{\detokenize{NBodySimulation/CoordinateSystems::doc}}
\sphinxAtStartPar
In the simulation, locations and velocities of stars are stored in galactocentric cartesian coordinates (GCA).
However, the observer/scopesim expect heliocentric equatorial polar coordinates.
Moreover, observational data is usually given in heliocentric galactic polar coordinates.
This data is used for initial cluster positions in the simulation and to compare results.
The implementation of transformations is therefore inevitable. The code has been adapted from GalPot ({[}\hyperlink{cite.NBodySimulation/Appendix:id23}{48}{]}).


\section{Galactocentric Cartesian (GCA)}
\label{\detokenize{NBodySimulation/CoordinateSystems:galactocentric-cartesian-gca}}
\sphinxAtStartPar
GCA is a right\sphinxhyphen{}handed coordinate system with the galactic center in its origin.
The projection of \(\hat{e}_x\) onto the galactic equator (or midplane) points to the initial location of the sun and
\(\hat{e}_z\) towards the galactic north pole. Therefore, the direction of galactic rotation at the location of the sun is the negative z axis.


\section{Galactocentric Polar (GCP)}
\label{\detokenize{NBodySimulation/CoordinateSystems:galactocentric-polar-gcp}}
\sphinxAtStartPar
GCP is a spherical coordinate system and similar to GCA.
Position and velocity transformation between the two systems goes as follows.
\begin{equation}\label{equation:NBodySimulation/CoordinateSystems:GCA_to_GCP}
\begin{split}\rho  = \sqrt{x^2+y^2+z^2} \\
\theta = \textup{atan2}{\left ( y,x \right )}\\
\varphi  = \arcsin\left ( \frac{z}{\sqrt{x^2+y^2+z^2}} \right ) \\
\dot{\rho} =  \frac{x\dot{x}+y\dot{y}+z\dot{z}}{\sqrt{x^2+y^2+z^2}}\\
\dot{\theta} = \frac{\dot{x}y-x\dot{y}}{x^2+y^2} \\
\dot{\varphi} = \frac{z(x\dot{x}+y\dot{y})-\dot{z}(x^2+y^2)}{(x^2+y^2+z^2)\sqrt{x^2+y^2}}\end{split}
\end{equation}

\section{Local Standard of Rest (LSR)}
\label{\detokenize{NBodySimulation/CoordinateSystems:local-standard-of-rest-lsr}}
\sphinxAtStartPar
Like GCA, LSR is a right\sphinxhyphen{}handed coordinate system.
The origin of positions is the location of the sun
and the origin of velocity is the velocity of a star on a circular orbit with mean velocity of stars in the solar neighborhood.
\(\hat{e}_x\) points towards the galactic center, \(\hat{e}_y\) towards the direction of galactic rotation
and \(\hat{e}_z\) approximately towards the galactic north pole.

\sphinxAtStartPar
The location of the sun is given by ({[}\hyperlink{cite.NBodySimulation/Appendix:id28}{25}{]}, {[}\hyperlink{cite.NBodySimulation/Appendix:id29}{5}{]})
\begin{equation*}
\begin{split}\vec{x}_{sun,GCA} \cong  (8.20,0,0.014)[kpc]\end{split}
\end{equation*}
\sphinxAtStartPar
and the mean velocity ({[}\hyperlink{cite.NBodySimulation/Appendix:id28}{25}{]})
\begin{equation*}
\begin{split}\vec{v}_{mean,GCA} \cong  (0,-232.8,0)[km/s]\end{split}
\end{equation*}
\sphinxAtStartPar
Since the sun is generally not in the galactic midplane, there is an angle between the planes spanned by \((x,y)_{GCA}\) and \((x,y)_{LSR}\).
This angle can be expressed as
\begin{equation*}
\begin{split}\sin(\alpha) = \frac{z_{sun,GCA}}{\sqrt{x^2+z^2}} \\
\cos(\alpha) = \frac{x_{sun,GCA}}{\sqrt{x^2+z^2}}\end{split}
\end{equation*}
\sphinxAtStartPar
The transformation of position and velocity vectors from GCA to LSR has to contain a rotation by \(-\alpha\) about the y axis.
\begin{equation*}
\begin{split}x_{LSR} = \cos(\alpha)( x_{sun,GCA} - x_{GCA} ) - \sin(\alpha)(z_{GCA}-z_{sun,GCA}) \\
y_{LSR} = -y_{GCA} \\
z_{LSR} = \sin(\alpha)(x_{sun,GCA} - x_{GCA}) + \cos(\alpha)( z_{GCA} - z_{sun,GCA}) \\ \\
u_{LSR} = -\cos(\alpha)u_{GCA} - \sin(\alpha)w_{GCA} \\
v_{LSR} = v_{sun,GCA}-v_{GCA} \\
w_{LSR} = -\sin(\alpha)u_{GCA} + \cos(\alpha)w_{GCA} \\\end{split}
\end{equation*}

\section{Heliocentric Cartesian (HCA)}
\label{\detokenize{NBodySimulation/CoordinateSystems:heliocentric-cartesian-hca}}
\sphinxAtStartPar
The only distinction between HCA and LSR is the origin of the velocity. In HCA the origin is the velocity of the sun.
The difference between the average velocity in the solar neighborhood and the sun itself, also called the peculiar motion of the sun,
is given by ({[}\hyperlink{cite.NBodySimulation/Appendix:id30}{56}{]})
\begin{equation*}
\begin{split}\vec{v}_{sun,LSR} \cong  (11.1, 12.24, 7.25)[km/s]\end{split}
\end{equation*}
\sphinxAtStartPar
Transformation from LSR to HCA can be written as
\begin{equation*}
\begin{split}\vec{x}_{HCA} = \vec{x}_{LSR} \\
\vec{v}_{HCA} = \vec{v}_{LSR} - \vec{v}_{sun,LSR}\end{split}
\end{equation*}

\section{Heliocentric Galactic Polar (HGP)}
\label{\detokenize{NBodySimulation/CoordinateSystems:heliocentric-galactic-polar-hgp}}
\sphinxAtStartPar
HGP is a spherical coordinate system with origins for position and velocity identical to those defined in HCA.
Coordinates given in this system are often called galactic coordinates.
The galactic longitude \(l\) is the angular distance in the galactic midplane with \(l=0^{\circ}\) towards the galactic center.
The galactic latitude \(b\) denotes the angle below and above the galactic midplane ranging from \(-90^{\circ}\) to \(90^{\circ}\).
and \(r\) the radial distance.

\sphinxAtStartPar
The transformation from HCA to HGP is identical to the transformation from GCA to GCP \eqref{equation:NBodySimulation/CoordinateSystems:GCA_to_GCP} with \(l \equiv \varphi\), \(b \equiv \theta\) and \(\rho \equiv r\)


\section{Heliocentric Equatorial Polar (HEQ)}
\label{\detokenize{NBodySimulation/CoordinateSystems:heliocentric-equatorial-polar-heq}}
\sphinxAtStartPar
The following positions and the transformation between HGP and HEQ are described in {[}\hyperlink{cite.NBodySimulation/Appendix:id32}{9}{]} (p 1044\sphinxhyphen{}1047),
the transformation between different epochs in {[}\hyperlink{cite.NBodySimulation/Appendix:id31}{33}{]} (p 95\sphinxhyphen{}105) . The latter is dated.
The international celestial reference system (ICRS) should be preferred if highest possible accuracy is of concern.

\sphinxAtStartPar
HEQ, like HGP, is a spherical coordinate system having the same origins for position and velocity.
However, angles are given in, and normal to, the celestial equator which is not parallel to the galactic midplane.
The right ascension (\(a\)) is the angular distance in the equator with \(a=0^{\circ}\) towards the northward equinox.
The equinox is the intersection of the ecliptic \sphinxhyphen{} the plane in which the earth orbits the sun \sphinxhyphen{} and the celestial equator.
The declination (\(d\)) is the angular distance above or below in the equator.

\sphinxAtStartPar
Since the ecliptic and the equator are in motion, a reference frame is needed.
A reference frame consists of quantities defining the coordinate system at a specific time as well as methods to
calculate those quantities for any other date. A commonly used reference frame is defined for the J2000.0 epoch (\(\epsilon_0\)).

\sphinxAtStartPar
In order to transform between HCA and HEQ at \(\epsilon_0\),
the direction of the north Galactic pole (NGP) and the galactic center (GC) are needed in both basis.

\sphinxAtStartPar
In HCA the NGP is simply \(\vec{x}_{NGP,HCA}=(0, 0, 1)\).
In HGP, since the direction is normal to the fundamental plane, \(b=90^{\circ}_{GC,HGP}\).
In HEQ at \(\epsilon_0\) the direction is
\begin{equation*}
\begin{split}a_{NGP} = 12^h51^m26.28^s \\
d_{NGP} = 27^{\circ}7^\prime41.7^{\prime\prime}\end{split}
\end{equation*}
\sphinxAtStartPar
The GC defines the x axis of HCA: \(\vec{x}_{GC,HCA}=(1, 0, 0)\). In GC the same direction is
\begin{equation*}
\begin{split}a_{GC,HEQ} = 17^h45^m40.0409^s \\
d_{GC,HEQ} = -29^{\circ}0^\prime28.118^{\prime\prime}\end{split}
\end{equation*}
\sphinxAtStartPar
To express these basis vectors in HCA basis, they can to be transformed as follows
\begin{equation*}
\begin{split}x_{HCA} = \cos(d)\cos(a) \\
y_{HCA} = \cos(d)\sin(a) \\
z_{HCA} = \sin(d) \\\end{split}
\end{equation*}
\sphinxAtStartPar
The third basis vector is the cross product of \(\vec{x}_{NGP}\) and \(\vec{x}_{GC}\).
With these basis vectors the change of basis matrix is
\begin{equation*}
\begin{split}M = \left [\hat{e}_x,\hat{e}_y,\hat{e}_z\right ]\end{split}
\end{equation*}
\sphinxAtStartPar
The full transformation from HCA to HEQ consists of the two steps: the multiplication with \(M\) followed by
the transformation from Cartesian to spherical as given in \eqref{equation:NBodySimulation/CoordinateSystems:GCA_to_GCP}.

\sphinxAtStartPar
For the transformation between HGP and HEQ the direction of the north celestial pole (NCP) is required.
NCP is perpendicular to the celestial equator, hence \(d_{NGP} = 90^{\circ}\).
In HGP at \(\epsilon_0\), NCP is
\begin{equation*}
\begin{split}l_{NCP} = 123^{\circ}55^\prime55.2^{\prime\prime}\\
b_{NCP} = 27^{\circ}7^\prime41.7^{\prime\prime}\end{split}
\end{equation*}
\sphinxAtStartPar
Using NGP and NCP the transformation from HGP to HEQ at \(\epsilon_0\) is
\begin{equation*}
\begin{split}\sin(d) = \sin(d_{NGP})\sin(b) + \cos(d_{NGP})\cos(b)\cos(l_{NCP}-l) \\
\cos(d)\sin(a-a_{NGP}) = \cos(b)\sin(l_{NCP}-l) \\
\cos(d)\cos(a-a_{NGP}) = \cos(d_{NGP})\sin(b)-sin(d_{NGP})\cos(b)\cos(l_{NGP}-l)\end{split}
\end{equation*}
\sphinxAtStartPar
Three angles describing the precision of both planes are needed in order to transform between epochs \(\epsilon_F\) and \(\epsilon_D\).
\begin{equation*}
\begin{split}z = (2306.2181+1.39656T - 0.000139T^2 )t + (1.09468 + 0.000066T)t^2 + 0.018203t^3 \\
\theta =(2004.3109 - 0.85330T-0.000217T^2)t + (-0.42665-0.000217T)t^2 - 0.041833t^3 \\
\xi = (2306.2181+1.39656T-0.000139T^2)t+(0.30188-0.000344T)t^2+0.017998t^3\end{split}
\end{equation*}
\sphinxAtStartPar
where \(t\) and \(T\) are time differences given in units of Julian century.
\begin{equation*}
\begin{split}T = \frac{JD(\epsilon_F)-JD(\epsilon_0)}{36525} \\
t = \frac{JD(\epsilon_D)-JD(\epsilon_F)}{36525}\end{split}
\end{equation*}
\sphinxAtStartPar
With these three rotations, a precession matrix \(P\) as well as its inverse can be formalized.
\begin{equation*}
\begin{split}P(\epsilon_F,\epsilon_D) = \begin{bmatrix}
cz*c\theta*c\xi-sz*s\xi & -cz*c\theta*s\xi-sz*c\xi & -cz*s\theta\\
sz*c\theta*c\xi+cz*s\xi & -sz*c\theta*s\xi+cz*c\xi & -sz*s\theta\\
s\theta*c\xi & -s\theta*s\xi & c\theta
\end{bmatrix}\end{split}
\end{equation*}
\sphinxAtStartPar
where \(cz = \cos(z)\), \(sz = \sin(z)\), \(c\theta = \cos(\theta)\), \(s\theta = \sin(\theta)\),
\(c\xi = \cos(\xi)\) and \(s\xi = \sin(\xi)\).

\sphinxAtStartPar
Before multiplication with \(P\), the target vector has to be expressed in Cartesian coordinates.


\section{Heliocentric Telescope Polar (HTP)}
\label{\detokenize{NBodySimulation/CoordinateSystems:heliocentric-telescope-polar-htp}}
\sphinxAtStartPar
This coordinate system aims to describe positions as they are observed with a telescope.
As with HEQ the right ascension \(a\) describes the angular distance in and the declination \(d\) the angular distance below and above the midplane.
The origin, however is defined by the line of sight vector, that is \(\hat{v}_{los} = [r,a,d] = [1,0,0]_{HTP}\).
Hence one image, taken with a telescope, is a circle in the \(ad\)\sphinxhyphen{}plane.

\sphinxAtStartPar
It may seem as if the transformation from HGP to HTP and vice versa simply consists of a shift by \(\hat{v}_{los}\) in HGP basis.
However for any line of sight vector with \(b\neq0\), the result would be an ellipse rather than a circle.
Casually speaking, the cone of vision in any spherical coordinate system is a circle when projected onto the unit sphere.
While this circle always covers the same range in \(b\), the range in \(l\) depends on the distance (\(b\)) between the circle and the midplane.
With increasing absolute value of \(b\) the circles around the unit sphere described by \(l\) decrease in size.

\sphinxAtStartPar
While there may be a solution for this issue, a different transformation was devised.
Positions can be transformed from HCA to HTP by aligning \(\hat{v}_{los}\) with the x axis \sphinxtitleref{hat\{x\}}
using a rotation matrix generated as described in \eqref{equation:NBodySimulation/Initialization:transformation_matrix} with the rotation axis defined by \([1,0,0]_{HCA}\) and \(\hat{v}_{los,HCA}\)
Subsequent transformation from Cartesian to polar coordinates as described in the section GCP above completes the transformation.


\chapter{Mock Observations}
\label{\detokenize{NBodySimulation/MockObservations:mock-observations}}\label{\detokenize{NBodySimulation/MockObservations::doc}}
\sphinxAtStartPar
Images of stars are generated using ScopeSim {[}\hyperlink{cite.NBodySimulation/Appendix:id50}{22}{]} with the MICADO\_Sci instrument, the ELT telescope and the Armazones location package.
Parameters differing from default values are
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
SIM.sub\_pixel.flag \sphinxhyphen{} Initial tests indicated the necessity of integrating sub pixel shifts

\item {} 
\sphinxAtStartPar
DET.width and DET.height \sphinxhyphen{} Width and height of the detector plane in pix are set ensuring the image contains the whole COV. The pixelscale scale (arcsec/pixel) the ELT is 0.004

\item {} 
\sphinxAtStartPar
OBS.dit \sphinxhyphen{} The exposure time is adjusted to one hour.

\item {} 
\sphinxAtStartPar
scao\_const\_psf.convolve\_mode = same ??? what does this do.

\item {} 
\sphinxAtStartPar
scao\_const\_psf.rotational\_blur\_angle \sphinxhyphen{} to reflect the rotation of the point spread function (PSF) occurring during one hour, this angle is set to 15 degrees. However, with the approach discussed in {\hyperref[\detokenize{NBodySimulation/DataReduction:masking-bright-stars-label}]{\sphinxcrossref{\DUrole{std,std-ref}{Masking bright stars}}}} this will have little to no impact on the results.

\end{enumerate}

\sphinxAtStartPar
For each simulation two images, one for \(t=0\) and one for math:\sphinxtitleref{t=dt}, are stored as FITS files.


\section{Creating Source Objects}
\label{\detokenize{NBodySimulation/MockObservations:creating-source-objects}}
\sphinxAtStartPar
ScopeSim requires one source object for each simulated star. Source objects contain spatial and spectral information.
The spatial information consists of x and y in arcsec relative to the FOV axis, here generated by a chain of transformations from GCA to HTP and stored in the appropriate database table.

\sphinxAtStartPar
The spectral information is acquired using multiple functions from the ScopeSim Templates library involving the following steps:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
The spectral type of a star is determined by looking up the closest spectral type from A Modern Mean Dwarf Stellar Color and Effective Temperature Sequence {[}\hyperlink{cite.NBodySimulation/Appendix:id51}{50}{]} given its mass.

\item {} 
\sphinxAtStartPar
The spectrum is taken from Pickles catalogue {[}\hyperlink{cite.NBodySimulation/Appendix:id52}{51}{]} requiring metallicity in range 0.5 \sphinxhyphen{} 2 solar and age of about 5 Gyr.

\item {} 
\sphinxAtStartPar
That spectrum is scaled such that it has 0 apparent Vega mag in the V filter.

\item {} 
\sphinxAtStartPar
The absolute magnitude \(M_V\) of the star in the V filter is determined from its mass using {[}\hyperlink{cite.NBodySimulation/Appendix:id51}{50}{]} with linear interpolation.

\item {} 
\sphinxAtStartPar
The apparent magnitude \(m_V\) is obtained from \(m_V = M_V + 5\log_{10}\left ( d \right )-5\)

\item {} 
\sphinxAtStartPar
The interstellar extinction \(e\) is taken into account using {[}\hyperlink{cite.NBodySimulation/Appendix:id53}{24}{]}

\item {} 
\sphinxAtStartPar
The weight \(w\) of the spectrum \(s\) is defined as

\end{enumerate}
\begin{equation*}
\begin{split}F\left (x,y \right ) = s * w\end{split}
\end{equation*}
\sphinxAtStartPar
and calculated via
\begin{equation*}
\begin{split}w = \frac{F}{F_0} = 10^{0.4\left ( m_0-(m_V+e) \right )}=10^{-0.4 (m_V+e)}\end{split}
\end{equation*}

\chapter{Data Reduction}
\label{\detokenize{NBodySimulation/DataReduction:data-reduction}}\label{\detokenize{NBodySimulation/DataReduction::doc}}
\sphinxAtStartPar
With the help of Photutils {[}\hyperlink{cite.NBodySimulation/Appendix:id54}{8}{]} the 2D HTP positions and fluxes of stars are detected from the FITS files generated during observation.
In a first step, all stars are stored in the database, each having exactly one location corresponding to the timestep of the FITS file.

\sphinxAtStartPar
The following method, while yielding decent results, is certainly not optimal.
Due to hardware and time constraints, options such as Image Segmentation were not feasible. Moreover, the parameters of the chosen method were not optimized beyond some spot checks.


\section{Detecting Stars}
\label{\detokenize{NBodySimulation/DataReduction:detecting-stars}}

\subsection{Background}
\label{\detokenize{NBodySimulation/DataReduction:background}}\label{\detokenize{NBodySimulation/DataReduction:background-label}}
\sphinxAtStartPar
Testing FITS files generated with no input sources still yield some amount of detected sources.
With the {\hyperref[\detokenize{NBodySimulation/Experiments:parameters-label}]{\sphinxcrossref{\DUrole{std,std-ref}{Parameters}}}} used for the 25 simulations, 125 sources were detected from an empty background.
The FITS files contain a raster of 64 images, sometimes overlapping and sometimes separated by one pixel due to rounding.
This leads to wrong detections at the corners. However, this effect only explains a fraction of the detections.


\subsection{Masking bright stars}
\label{\detokenize{NBodySimulation/DataReduction:masking-bright-stars}}\label{\detokenize{NBodySimulation/DataReduction:masking-bright-stars-label}}
\sphinxAtStartPar
PSFs of bright stars were wrongfully detected as stars. Increasing the detection threshold would have meant not detecting real faint stars in different areas.
Hence the decision was made to mask square areas around bright stars leading to only one detection within those areas.

\sphinxAtStartPar
The side length \(l_i\) of the square depends on the flux \(F_i\) of the stars: \(l_i = f(F_i)\).

\sphinxAtStartPar
To find the appropriate function, FITS for single stars at a given distance and with varying mass were generated,
the sources in each file detected, using DAOStarFinder, and their flux and maximum distance between the correct and any wrong sources calculated.
A linear fit of the resulting dataset ({\hyperref[\detokenize{NBodySimulation/Appendix:appendix-label}]{\sphinxcrossref{\DUrole{std,std-ref}{Appendix}}}}) lead to the empirical function
\begin{equation}\label{equation:NBodySimulation/DataReduction:side_length}
\begin{split}l_i = \begin{cases}
 & 0\text{ if } F_i < 100\\
 & 0.01*F_i+28\text{ if } F_i \geqslant 100\\
\end{cases}\end{split}
\end{equation}
\sphinxAtStartPar
ToDo?: Add 3 images without mask drawn mask after mask

\sphinxAtStartPar
The DAOStarFinder method is called twice:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\begin{DUlineblock}{0em}
\item[] To find the bright stars and generate the mask. The resulting table contains one row for each source.
\item[] This table is sorted by the flux column in descending order and iterated from top to bottom until the current entry has \(F_i < 100\).
\item[] Elements of the mask \sphinxhyphen{} a 2D Boolean array with the same size as the image \sphinxhyphen{} are updated.
\item[] All elements inside the box with side length \eqref{equation:NBodySimulation/DataReduction:side_length} are set to true and the current table entry stored in a new table if located outside a masked area.
\end{DUlineblock}

\item {} 
\sphinxAtStartPar
For passing the mask parameter generated in the previous step and returning sources outside the masked areas.

\end{enumerate}

\sphinxAtStartPar
Both the bright sources recorded after the first and the faint sources returned from second call are stored in the database.


\chapter{Cluster analysis}
\label{\detokenize{NBodySimulation/Clustering:cluster-analysis}}\label{\detokenize{NBodySimulation/Clustering::doc}}
\sphinxAtStartPar
The objective is to detect all cluster stars present in the observed data with a certain accuracy.
One image contains a set of stars \(s_{i}\) with positions \(\vec{x}_{i}\left ( t \right )\) in pixel coordinates and apparent magnitudes \(m_{i}\).
This information is not enough to detect cluster memberships. The number density of cluster stars in position space is similar to that of the field stars.
Furthermore, cluster and field star positions overlap significantly.
Moreover, depending on the distance of the cluster to the observer, the cluster size and the field of view angle, cluster stars often cover a significant area of if not the whole image.
The proper motion \(\vec{v_{i}}(t)\) density of cluster stars on the other hand is highly relative to that of field stars and hardly any field stars have \(\vec{v_{i}}(t)\) close to cluster stars.


\section{Velocity approximation}
\label{\detokenize{NBodySimulation/Clustering:velocity-approximation}}
\sphinxAtStartPar
The proper motion of a star can be approximated from its position at two different timestamps via first order Taylor expansion
\begin{equation*}
\begin{split}v_{i} = \frac{x_{i}\left ( t+dt \right )-x_{i}\left ( t \right )}{dt}\end{split}
\end{equation*}
\sphinxAtStartPar
However, this is only possible if the positions at two different timesteps can be accurately associated with the same star \(s_{i}\).
The assumption that \(\vec{x}(t+dt)\) belongs to the same star as \(\vec{x}(t)\) if their Euclidian distance is smaller than the distance of \(\vec{x}(t)\) to any other \(\vec{x}(t+dt)\),
only hold true for small \(dt\). However, due to the discreteness of images, \(dt\) has to be large enough so that the change in position is detectable between timesteps.
The pixel scale \sphinxhyphen{} the ratio of arcsec to pixel \sphinxhyphen{} dictates a lower bound for \(dt\).

\sphinxAtStartPar
Since the data results from a simulation, it is trivial to verify whether or not the attribution of the two positions is indeed correct.
In fact, tests using only the Euclidian distance as a metric with \(dt = 1 day\) lead to a small but significant amount of wrong assignments.

\sphinxAtStartPar
An additional condition was introduced. Stars at \(\vec{x}(t)\) and \(\vec{x}(t+dt)\) have to have a similar apparent magnitude \(m\) to be considered the same star.
\begin{equation*}
\begin{split}\left | 1-\frac{m_{i}\left ( t \right )}{m_{j}\left ( t+dt \right )} \right | < \varepsilon_{m}\end{split}
\end{equation*}
\sphinxAtStartPar
where \(\varepsilon_{m}\) is the maximum relative difference in apparent magnitude.

\sphinxAtStartPar
With this constraint, all positions where correctly assigned during further tests.


\section{DBSCAN}
\label{\detokenize{NBodySimulation/Clustering:dbscan}}
\sphinxAtStartPar
The clustering algorithm of choice is DBSCAN since it is density based and able to detect clusters of arbitrary shape.
Additionally and contrary to other algorithms the amount of clusters to find is not a parameter. DBSCAN detects any clusters present in the data based on two parameters:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\(\epsilon\): the maximum distance between points to be considered neighbors

\item {} 
\sphinxAtStartPar
nPoints: the minimum amount of neighbors for a point to be classified as core point.

\end{enumerate}

\sphinxAtStartPar
During execution all data points are classified as one of the following:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
core point: a point with at least nPoints within \(\epsilon\):

\item {} 
\sphinxAtStartPar
border point: a point having at least one core point but less than nPoints within \(\epsilon\):

\item {} 
\sphinxAtStartPar
noise/outlier: any other point

\end{enumerate}

\sphinxAtStartPar
The implementation of DBSCAN can be summarized as follows: Iterate the list of points. If the current point is not already classified, check if it meets the requirements to be classified as core point.
Once a core point has been found, the neighboring points of that point are tested. If they too have enough neighbors the recursion continues until all neighbors are classified as either core or border points.

\sphinxAtStartPar
In a naive implementation, the distance of each point to every other point is checked. The time complexity of such an implementation is \(O(n^2)\).
Moreover, for large datasets the recursion can lead to stack overflow.

\sphinxAtStartPar
R*\sphinxhyphen{}tree or similar data structures can be used to improve the performance to an average of \(O(n\log{n})\) ({[}\hyperlink{cite.NBodySimulation/Appendix:id33}{12}{]})
The library mlpack ({[}\hyperlink{cite.NBodySimulation/Appendix:id34}{10}{]}) was used, which includes an implementation of DBSCAN supporting R*\sphinxhyphen{}tree and many other trees.

\sphinxAtStartPar
Initially and in addition to the standard condition \(\epsilon_{x}\) for the spatial distance between points a supplementary condition \(\epsilon_{v}\) was introduced.
The difference in velocity between two stars has to be smaller than \(\epsilon_{v}\) for them to be classified as neighbors:
\begin{equation*}
\begin{split}\left \|\vec{v}_{1}-\vec{v}_{2}  \right \|_{2}< \epsilon_{v}\end{split}
\end{equation*}
\sphinxAtStartPar
Large \(\epsilon_{x}\) lead to more accurate membership detection. It turned out, the spatial distance condition does not benefit the results at all and it was dropped.
For larger areas than used here, constraining the spatial distance, for instance via subdivision, should be beneficial.


\section{Performance}
\label{\detokenize{NBodySimulation/Clustering:performance}}
\sphinxAtStartPar
Observed stars are mapped to simulated stars via their proximity in order to measure the performance. If a star is not the closest observed star to any simulated star it remains not mapped.
Not mapped stars exist due to {\hyperref[\detokenize{NBodySimulation/DataReduction:background-label}]{\sphinxcrossref{\DUrole{std,std-ref}{Background}}}} and parts of the PSFs of bright stars being detected as stars. Observed stars can then be attributed one of the following types:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
True Positive (TP): correctly classified as cluster star.

\item {} 
\sphinxAtStartPar
False Positive (FP): wrongly classified as cluster star.

\item {} 
\sphinxAtStartPar
True Negative (TN): correctly classified as field star.

\item {} 
\sphinxAtStartPar
False Negative (FN): wrongly classified as field star.

\item {} 
\sphinxAtStartPar
Unconfirmed Positive (UP): not mapped star classified as cluster star. Treated as FP.

\item {} 
\sphinxAtStartPar
Unconfirmed Negative (UN): not mapped star classified as field star. Not taken into account since FN is unlikely.

\end{enumerate}


\subsection{Accuracy}
\label{\detokenize{NBodySimulation/Clustering:accuracy}}\begin{equation*}
\begin{split}A = \frac{TP+TN}{TP+TN+FP+FN}\end{split}
\end{equation*}
\sphinxAtStartPar
With a large amount of field stars relative to cluster stars, this metric is not ideal as it will give a good rating even if most cluster stars are FN.


\subsection{Precision and Recall}
\label{\detokenize{NBodySimulation/Clustering:precision-and-recall}}
\sphinxAtStartPar
When FPs are more problematic than FNs, the precision \(P\) should be high
\begin{equation*}
\begin{split}P = \frac{TP}{TP+FP+UP}\end{split}
\end{equation*}
\sphinxAtStartPar
On the flip side, if FNs are a big concern, but FPs tolerable, the recall \(R\) is a good metric
\begin{equation*}
\begin{split}R = \frac{TP}{TP+FN}\end{split}
\end{equation*}

\subsection{F1 Score}
\label{\detokenize{NBodySimulation/Clustering:f1-score}}
\sphinxAtStartPar
This metric is a balance between \(P\) and \(R\). Contrary to \(A\) TN is not taken into account.
\begin{equation*}
\begin{split}F_1 = 2 \frac{P*R}{P+R} = \frac{TP}{TP+0.5(FP+UP+FN)}\end{split}
\end{equation*}

\chapter{Experiments}
\label{\detokenize{NBodySimulation/Experiments:experiments}}\label{\detokenize{NBodySimulation/Experiments::doc}}

\section{Parameter optimization}
\label{\detokenize{NBodySimulation/Experiments:parameter-optimization}}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{DBSCAN_parameter_space}.pdf}
\caption{Precision depending on DBSCAN parameters}\label{\detokenize{NBodySimulation/Experiments:id2}}\label{\detokenize{NBodySimulation/Experiments:fig-dbscan}}\end{figure}

\sphinxAtStartPar
The quality of the cluster analysis with DBSCAN depends on the choice of its parameters.
\hyperref[\detokenize{NBodySimulation/Experiments:fig-dbscan}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-dbscan}}} depicts the precision for a \(1 [kM_\odot]\) cluster \(300 \textup{[pc]}\) from the GC.
Decreasing \(\epsilon\) leads to a higher precission until it is too small, at which point multiple clusters are detected.
Based on this observation \(\epsilon\) was set to \(1.1*10^{-5}\) and nPoints to 200 for all simulations.


\section{Setup}
\label{\detokenize{NBodySimulation/Experiments:setup}}
\sphinxAtStartPar
A total of 25 simulations with varying focus and cluster mass were carried out in order to study the effects of these parameters on the cluster detection performance.
The focus was set to \(l=0^{\circ}\) and \(b \in \left \{0,5,10,25,180 \right \}[^\circ]\) HGP and the cluster mass \(\in \left \{0.64, 1.6, 4.0, 10, 25 \right \} [\textup{kM}_\odot]\).
Each simulation was repeated 10 times for error estimation.


\subsection{Parameters}
\label{\detokenize{NBodySimulation/Experiments:parameters}}\label{\detokenize{NBodySimulation/Experiments:parameters-label}}
\sphinxAtStartPar
The following parameters remained unchanged between the simulations.

\sphinxAtStartPar
\sphinxstylestrong{General simulation parameters}
\begin{itemize}
\item {} 
\begin{DUlineblock}{0em}
\item[] FOV angle: \(54 \textup{[arcsec]}\)
\item[] The field of view angle, chosen large enough to cover most of the cluster stars. See \(\alpha\) in \hyperref[\detokenize{NBodySimulation/Initialization:fig-cone}]{Fig.\@ \ref{\detokenize{NBodySimulation/Initialization:fig-cone}}}
\end{DUlineblock}

\item {} 
\begin{DUlineblock}{0em}
\item[] View distance: \(9 \textup{[kpc]}\)
\item[] The height of the COV or line of sight distance reaching behind the GC when looking towards it.
\end{DUlineblock}

\item {} 
\begin{DUlineblock}{0em}
\item[] Cluster distance: \(8 \textup{[kpc]}\)
\item[] The distance between the observer and the cluster. When looking straight at the GC the distance between the cluster and the GC is \(300 \textup{[pc]}\)
\item[] The mean cluster velocity is set to the circular velocity at this location.
\end{DUlineblock}

\item {} 
\begin{DUlineblock}{0em}
\item[] View point: \(\begin{bmatrix}8300 & 0 & 27\end{bmatrix}^{T}_{GCA} \textup{[pc]}\)
\item[] The position of the observer in GCA.
\end{DUlineblock}

\item {} 
\begin{DUlineblock}{0em}
\item[] Timestep: \(28 \textup{[day]}\)
\item[] Amount of time between the two recorded snapshots. The time per integration is \(7 \textup{[day]}\). Therefor snapshots are taken every 4 integrations.
\end{DUlineblock}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Cluster specific parameters (McLuster)}
\begin{itemize}
\item {} \begin{enumerate}
\sphinxsetlistlabels{\Alph}{enumi}{enumii}{(}{)}%
\setcounter{enumi}{15}
\item {} 
\sphinxAtStartPar
Profile: 0 Plummer density profile

\end{enumerate}

\item {} 
\begin{DUlineblock}{0em}
\item[] (R) Radius: \sphinxhyphen{}1
\item[] With this setting the radius is calculated by mcluster via a mass to half\sphinxhyphen{}mass radius relation as described in {[}\hyperlink{cite.NBodySimulation/Appendix:id55}{23}{]}
\end{DUlineblock}

\item {} 
\begin{DUlineblock}{0em}
\item[] (Q) Virial ratio: 0.5
\item[] The cluster is in virial equilibrium.
\end{DUlineblock}

\item {} \begin{enumerate}
\sphinxsetlistlabels{\alph}{enumi}{enumii}{(}{)}%
\setcounter{enumi}{5}
\item {} 
\sphinxAtStartPar
IMF: 1 Kroupa ranging from 0.08 Msun to 100 Msun

\end{enumerate}

\item {} \begin{enumerate}
\sphinxsetlistlabels{\Alph}{enumi}{enumii}{(}{)}%
\setcounter{enumi}{2}
\item {} 
\sphinxAtStartPar
Output: 3 The resulting mass, position and velocity for each star is written into a file.

\end{enumerate}

\end{itemize}


\section{Results and Interpretation}
\label{\detokenize{NBodySimulation/Experiments:results-and-interpretation}}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{25_n_stars}.pdf}
\caption{Number of simulated/detected cluster and field stars at \(10^\circ\) depending on the cluster masses}\label{\detokenize{NBodySimulation/Experiments:id3}}\label{\detokenize{NBodySimulation/Experiments:fig-25-n-stars}}\end{figure}

\sphinxAtStartPar
Depending on the total cluster mass the amount of simulated CS (SCS) ranges from \(1.3e3\) to \(40.4e3\) while the amount of mapped CS (MCS) lies between \(1.0e3\) and \(16.4e3\).
The decrease in detectability of CS is due to increasing CS density and has no direct impact on the clustering performance.
The difference between observed stars (OS) and mapped stars (MS) is negligible, in fact the amount of not mapped stars decreases with increasing number of SCS.

\sphinxAtStartPar
While the number of simulated FS (SFS) remains constant, the number of mapped FS (MFS) decreases with increasing number of CS because bright CS hide FS.
This inverse relationship does impact the clustering performance to some degree, less MFS means less potential FPs as well as TNs, the latter are not relevant for Precision and F1 score.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{25_precision}.pdf}
\caption{Precision for different mass bins, angles and cluster masses}\label{\detokenize{NBodySimulation/Experiments:id4}}\label{\detokenize{NBodySimulation/Experiments:fig-25-precision}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{25_precision_sim}.pdf}
\caption{Precision using accurate velocities}\label{\detokenize{NBodySimulation/Experiments:id5}}\label{\detokenize{NBodySimulation/Experiments:fig-25-precision-sim}}\end{figure}

\sphinxAtStartPar
\hyperref[\detokenize{NBodySimulation/Experiments:fig-25-precision}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-precision}}} displays the precision using the velocity of OS and \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-precision-sim}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-precision-sim}}} for the velocity of SS.
The only relevant difference between simulated and observed HTP proper motion is the accuracy of position and consequently of velocity.
While both figures show the same relationships, the drop in overall performance due to inaccuracies introduced during observation and source detection are painfully apparent.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{25_F1}.pdf}
\caption{F1 score for different mass bins, angles and cluster masses}\label{\detokenize{NBodySimulation/Experiments:id6}}\label{\detokenize{NBodySimulation/Experiments:fig-25-f1}}\end{figure}

\sphinxAtStartPar
As is discernable in \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-precision}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-precision}}} and \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-precision-sim}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-precision-sim}}} the precision, with one exception, is correlated with the angle.
Curiously for the same cluster mass the precision is lower at \(10^\circ\) than at \(5^\circ\).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{25_avg_vel_640}.pdf}
\caption{Average cluster and field star velocity at different angles}\label{\detokenize{NBodySimulation/Experiments:id7}}\label{\detokenize{NBodySimulation/Experiments:fig-25-avg-vel-640}}\end{figure}

\sphinxAtStartPar
\hyperref[\detokenize{NBodySimulation/Experiments:fig-25-avg-vel-640}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-avg-vel-640}}} provides the explanation for this outlier.
At \(10^\circ\) the average field star velocity is closer to the average cluster star velocity than at any other angle, making it harder to differentiate between cluster and noise.

\sphinxAtStartPar
The bigger the cluster mass, the higher the cluster star velocity density, which implies the second correlation \sphinxhyphen{} precision with cluster mass \sphinxhyphen{} presented in \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-precision}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-precision}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{25_vel_scatter}.pdf}
\caption{2D HTP velocity of simulated clusters}\label{\detokenize{NBodySimulation/Experiments:id8}}\label{\detokenize{NBodySimulation/Experiments:fig-25-vel-scatter}}\end{figure}

\sphinxAtStartPar
\hyperref[\detokenize{NBodySimulation/Experiments:fig-25-vel-scatter}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-vel-scatter}}} displays examples for the 2D HTP velocity space of two simulated clusters near the GC.

\sphinxAtStartPar
In this example the \(0.64 [kM_{\odot}]\) cluster only has 1143 stars inside the circle while \(10 [kM_{\odot}]\) has 3158.
In both cases statistically the same amount of field stars fall within that area, leading to a higher ratio of FPs and therefore a lower precision for the lower mass cluster.


\chapter{Conclusions}
\label{\detokenize{NBodySimulation/Conclusions:conclusions}}\label{\detokenize{NBodySimulation/Conclusions::doc}}
\sphinxAtStartPar
The results presented, particularly \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-precision}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-precision}}}, indicate that data gathered with the ELT will indeed be accurate enough to study the IMF of YMCs near the GC.
However, it remains questionable if this is still the case for stars with mass \(< 0.08 [\textup{M}_\odot]\).
Information about this mass regime, such as spectral type, MW disc and core IMFs is sparse.
Moreover, the precision obtained here in the range \(0.5 - 0.08 [\textup{M}_{\odot}]\) is already quite low.
That is not to say it will not be possible. Many improvements and additions could be made to the presented work such as
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
A more accurate bulge model, for instance {[}\hyperlink{cite.NBodySimulation/Appendix:id57}{36}{]}

\item {} 
\sphinxAtStartPar
Additional snapshots to recover temporarily hidden stars and get a more accurate velocity estimation.

\item {} 
\sphinxAtStartPar
A sophisticated method for extracting positional data like point spread function fitting.

\item {} 
\sphinxAtStartPar
Accurately determine the ideal time step size.

\end{enumerate}


\chapter{Appendix}
\label{\detokenize{NBodySimulation/Appendix:appendix}}\label{\detokenize{NBodySimulation/Appendix:appendix-label}}\label{\detokenize{NBodySimulation/Appendix::doc}}

\begin{savenotes}\sphinxatlongtablestart\begin{longtable}[c]{|\X{30}{120}|\X{30}{120}|\X{30}{120}|\X{30}{120}|}
\sphinxthelongtablecaptionisattop
\caption{Dataset for empirical mask function\strut}\label{\detokenize{NBodySimulation/Appendix:id61}}\\*[\sphinxlongtablecapskipadjust]
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
flux
&\sphinxstyletheadfamily 
\sphinxAtStartPar
box size
&\sphinxstyletheadfamily 
\sphinxAtStartPar
dist
&\sphinxstyletheadfamily 
\sphinxAtStartPar
mass
\\
\hline
\endfirsthead

\multicolumn{4}{c}%
{\makebox[0pt]{\sphinxtablecontinued{\tablename\ \thetable{} \textendash{} continued from previous page}}}\\
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
flux
&\sphinxstyletheadfamily 
\sphinxAtStartPar
box size
&\sphinxstyletheadfamily 
\sphinxAtStartPar
dist
&\sphinxstyletheadfamily 
\sphinxAtStartPar
mass
\\
\hline
\endhead

\hline
\multicolumn{4}{r}{\makebox[0pt][r]{\sphinxtablecontinued{continues on next page}}}\\
\endfoot

\endlastfoot

\sphinxAtStartPar
927146.1955
&
\sphinxAtStartPar
254.3559872
&
\sphinxAtStartPar
127.1779936
&
\sphinxAtStartPar
10
\\
\hline
\sphinxAtStartPar
890635.019
&
\sphinxAtStartPar
254.3417547
&
\sphinxAtStartPar
127.1708773
&
\sphinxAtStartPar
9.9
\\
\hline
\sphinxAtStartPar
857036.8725
&
\sphinxAtStartPar
254.341936
&
\sphinxAtStartPar
127.170968
&
\sphinxAtStartPar
9.8
\\
\hline
\sphinxAtStartPar
823955.0858
&
\sphinxAtStartPar
254.3421943
&
\sphinxAtStartPar
127.1710971
&
\sphinxAtStartPar
9.7
\\
\hline
\sphinxAtStartPar
793135.9042
&
\sphinxAtStartPar
254.3424033
&
\sphinxAtStartPar
127.1712017
&
\sphinxAtStartPar
9.6
\\
\hline
\sphinxAtStartPar
762592.0798
&
\sphinxAtStartPar
254.3426546
&
\sphinxAtStartPar
127.1713273
&
\sphinxAtStartPar
9.5
\\
\hline
\sphinxAtStartPar
734504.8423
&
\sphinxAtStartPar
254.3429091
&
\sphinxAtStartPar
127.1714545
&
\sphinxAtStartPar
9.4
\\
\hline
\sphinxAtStartPar
707751.1254
&
\sphinxAtStartPar
254.3431486
&
\sphinxAtStartPar
127.1715743
&
\sphinxAtStartPar
9.3
\\
\hline
\sphinxAtStartPar
681256.1109
&
\sphinxAtStartPar
254.3434061
&
\sphinxAtStartPar
127.1717031
&
\sphinxAtStartPar
9.2
\\
\hline
\sphinxAtStartPar
656346.0444
&
\sphinxAtStartPar
254.3436538
&
\sphinxAtStartPar
127.1718269
&
\sphinxAtStartPar
9.1
\\
\hline
\sphinxAtStartPar
633104.9017
&
\sphinxAtStartPar
254.3439632
&
\sphinxAtStartPar
127.1719816
&
\sphinxAtStartPar
9
\\
\hline
\sphinxAtStartPar
609936.5628
&
\sphinxAtStartPar
254.3442026
&
\sphinxAtStartPar
127.1721013
&
\sphinxAtStartPar
8.9
\\
\hline
\sphinxAtStartPar
587640.2069
&
\sphinxAtStartPar
254.3445212
&
\sphinxAtStartPar
127.1722606
&
\sphinxAtStartPar
8.8
\\
\hline
\sphinxAtStartPar
566233.046
&
\sphinxAtStartPar
254.3448084
&
\sphinxAtStartPar
127.1724042
&
\sphinxAtStartPar
8.7
\\
\hline
\sphinxAtStartPar
545639.6678
&
\sphinxAtStartPar
254.3451645
&
\sphinxAtStartPar
127.1725822
&
\sphinxAtStartPar
8.6
\\
\hline
\sphinxAtStartPar
525443.3219
&
\sphinxAtStartPar
254.3454953
&
\sphinxAtStartPar
127.1727477
&
\sphinxAtStartPar
8.5
\\
\hline
\sphinxAtStartPar
506252.3011
&
\sphinxAtStartPar
254.4948138
&
\sphinxAtStartPar
127.2474069
&
\sphinxAtStartPar
8.4
\\
\hline
\sphinxAtStartPar
487489.4659
&
\sphinxAtStartPar
254.3462375
&
\sphinxAtStartPar
127.1731188
&
\sphinxAtStartPar
8.3
\\
\hline
\sphinxAtStartPar
470008.9293
&
\sphinxAtStartPar
254.3465892
&
\sphinxAtStartPar
127.1732946
&
\sphinxAtStartPar
8.2
\\
\hline
\sphinxAtStartPar
462754.3324
&
\sphinxAtStartPar
254.3470858
&
\sphinxAtStartPar
127.1735429
&
\sphinxAtStartPar
8.1
\\
\hline
\sphinxAtStartPar
445797.2677
&
\sphinxAtStartPar
254.5130792
&
\sphinxAtStartPar
127.2565396
&
\sphinxAtStartPar
8
\\
\hline
\sphinxAtStartPar
429456.9678
&
\sphinxAtStartPar
254.347868
&
\sphinxAtStartPar
127.173934
&
\sphinxAtStartPar
7.9
\\
\hline
\sphinxAtStartPar
413760.4129
&
\sphinxAtStartPar
254.3482648
&
\sphinxAtStartPar
127.1741324
&
\sphinxAtStartPar
7.8
\\
\hline
\sphinxAtStartPar
398652.2024
&
\sphinxAtStartPar
254.3487825
&
\sphinxAtStartPar
127.1743912
&
\sphinxAtStartPar
7.7
\\
\hline
\sphinxAtStartPar
384123.4617
&
\sphinxAtStartPar
254.4173555
&
\sphinxAtStartPar
127.2086778
&
\sphinxAtStartPar
7.6
\\
\hline
\sphinxAtStartPar
370111.5523
&
\sphinxAtStartPar
253.8093122
&
\sphinxAtStartPar
126.9046561
&
\sphinxAtStartPar
7.5
\\
\hline
\sphinxAtStartPar
356487.63
&
\sphinxAtStartPar
254.4810594
&
\sphinxAtStartPar
127.2405297
&
\sphinxAtStartPar
7.4
\\
\hline
\sphinxAtStartPar
343530.5029
&
\sphinxAtStartPar
255.0658948
&
\sphinxAtStartPar
127.5329474
&
\sphinxAtStartPar
7.3
\\
\hline
\sphinxAtStartPar
316316.5998
&
\sphinxAtStartPar
247.8349505
&
\sphinxAtStartPar
123.9174752
&
\sphinxAtStartPar
7.2
\\
\hline
\sphinxAtStartPar
309163.7247
&
\sphinxAtStartPar
254.4288941
&
\sphinxAtStartPar
127.2144471
&
\sphinxAtStartPar
7.1
\\
\hline
\sphinxAtStartPar
302130.3778
&
\sphinxAtStartPar
254.4303415
&
\sphinxAtStartPar
127.2151707
&
\sphinxAtStartPar
7
\\
\hline
\sphinxAtStartPar
295295.4188
&
\sphinxAtStartPar
254.5012123
&
\sphinxAtStartPar
127.2506062
&
\sphinxAtStartPar
6.9
\\
\hline
\sphinxAtStartPar
288627.7467
&
\sphinxAtStartPar
254.433333
&
\sphinxAtStartPar
127.2166665
&
\sphinxAtStartPar
6.8
\\
\hline
\sphinxAtStartPar
282129.2052
&
\sphinxAtStartPar
254.4345462
&
\sphinxAtStartPar
127.2172731
&
\sphinxAtStartPar
6.7
\\
\hline
\sphinxAtStartPar
275630.1016
&
\sphinxAtStartPar
254.436262
&
\sphinxAtStartPar
127.218131
&
\sphinxAtStartPar
6.6
\\
\hline
\sphinxAtStartPar
269416.7466
&
\sphinxAtStartPar
254.4377591
&
\sphinxAtStartPar
127.2188795
&
\sphinxAtStartPar
6.5
\\
\hline
\sphinxAtStartPar
263376.811
&
\sphinxAtStartPar
247.9665145
&
\sphinxAtStartPar
123.9832573
&
\sphinxAtStartPar
6.4
\\
\hline
\sphinxAtStartPar
257390.5638
&
\sphinxAtStartPar
247.9972751
&
\sphinxAtStartPar
123.9986376
&
\sphinxAtStartPar
6.3
\\
\hline
\sphinxAtStartPar
251577.0397
&
\sphinxAtStartPar
252.6213071
&
\sphinxAtStartPar
126.3106536
&
\sphinxAtStartPar
6.2
\\
\hline
\sphinxAtStartPar
245854.0065
&
\sphinxAtStartPar
248.0135846
&
\sphinxAtStartPar
124.0067923
&
\sphinxAtStartPar
6.1
\\
\hline
\sphinxAtStartPar
236400.0465
&
\sphinxAtStartPar
248.0575239
&
\sphinxAtStartPar
124.0287619
&
\sphinxAtStartPar
6
\\
\hline
\sphinxAtStartPar
227300.7517
&
\sphinxAtStartPar
252.618173
&
\sphinxAtStartPar
126.3090865
&
\sphinxAtStartPar
5.9
\\
\hline
\sphinxAtStartPar
218570.2985
&
\sphinxAtStartPar
252.6201478
&
\sphinxAtStartPar
126.3100739
&
\sphinxAtStartPar
5.8
\\
\hline
\sphinxAtStartPar
210129.5831
&
\sphinxAtStartPar
247.9292325
&
\sphinxAtStartPar
123.9646163
&
\sphinxAtStartPar
5.7
\\
\hline
\sphinxAtStartPar
202041.5421
&
\sphinxAtStartPar
247.85708
&
\sphinxAtStartPar
123.92854
&
\sphinxAtStartPar
5.6
\\
\hline
\sphinxAtStartPar
194255.2774
&
\sphinxAtStartPar
252.6363119
&
\sphinxAtStartPar
126.318156
&
\sphinxAtStartPar
5.5
\\
\hline
\sphinxAtStartPar
186750.9496
&
\sphinxAtStartPar
252.6021078
&
\sphinxAtStartPar
126.3010539
&
\sphinxAtStartPar
5.4
\\
\hline
\sphinxAtStartPar
182535.794
&
\sphinxAtStartPar
247.9673489
&
\sphinxAtStartPar
123.9836745
&
\sphinxAtStartPar
5.3
\\
\hline
\sphinxAtStartPar
178401.698
&
\sphinxAtStartPar
248.0481722
&
\sphinxAtStartPar
124.0240861
&
\sphinxAtStartPar
5.2
\\
\hline
\sphinxAtStartPar
174325.8134
&
\sphinxAtStartPar
252.6377075
&
\sphinxAtStartPar
126.3188537
&
\sphinxAtStartPar
5.1
\\
\hline
\sphinxAtStartPar
170400.5422
&
\sphinxAtStartPar
252.6334207
&
\sphinxAtStartPar
126.3167103
&
\sphinxAtStartPar
5
\\
\hline
\sphinxAtStartPar
248519.9168
&
\sphinxAtStartPar
247.7858731
&
\sphinxAtStartPar
123.8929365
&
\sphinxAtStartPar
4.9
\\
\hline
\sphinxAtStartPar
242908.6771
&
\sphinxAtStartPar
247.9706455
&
\sphinxAtStartPar
123.9853228
&
\sphinxAtStartPar
4.8
\\
\hline
\sphinxAtStartPar
237403.2487
&
\sphinxAtStartPar
248.0166034
&
\sphinxAtStartPar
124.0083017
&
\sphinxAtStartPar
4.7
\\
\hline
\sphinxAtStartPar
232060.6523
&
\sphinxAtStartPar
247.9419667
&
\sphinxAtStartPar
123.9709833
&
\sphinxAtStartPar
4.6
\\
\hline
\sphinxAtStartPar
218259.9677
&
\sphinxAtStartPar
254.6442946
&
\sphinxAtStartPar
127.3221473
&
\sphinxAtStartPar
4.5
\\
\hline
\sphinxAtStartPar
205273.3003
&
\sphinxAtStartPar
247.9794943
&
\sphinxAtStartPar
123.9897472
&
\sphinxAtStartPar
4.4
\\
\hline
\sphinxAtStartPar
193150.6701
&
\sphinxAtStartPar
250.4719141
&
\sphinxAtStartPar
125.2359571
&
\sphinxAtStartPar
4.3
\\
\hline
\sphinxAtStartPar
181724.6168
&
\sphinxAtStartPar
252.6310455
&
\sphinxAtStartPar
126.3155227
&
\sphinxAtStartPar
4.2
\\
\hline
\sphinxAtStartPar
170942.9686
&
\sphinxAtStartPar
252.6333644
&
\sphinxAtStartPar
126.3166822
&
\sphinxAtStartPar
4.1
\\
\hline
\sphinxAtStartPar
160789.262
&
\sphinxAtStartPar
252.6181038
&
\sphinxAtStartPar
126.3090519
&
\sphinxAtStartPar
4
\\
\hline
\sphinxAtStartPar
168811.5177
&
\sphinxAtStartPar
247.8041635
&
\sphinxAtStartPar
123.9020817
&
\sphinxAtStartPar
3.9
\\
\hline
\sphinxAtStartPar
162697.5008
&
\sphinxAtStartPar
252.6385607
&
\sphinxAtStartPar
126.3192803
&
\sphinxAtStartPar
3.8
\\
\hline
\sphinxAtStartPar
156860.6692
&
\sphinxAtStartPar
252.6179306
&
\sphinxAtStartPar
126.3089653
&
\sphinxAtStartPar
3.7
\\
\hline
\sphinxAtStartPar
151196.1118
&
\sphinxAtStartPar
247.8991699
&
\sphinxAtStartPar
123.949585
&
\sphinxAtStartPar
3.6
\\
\hline
\sphinxAtStartPar
145724.8797
&
\sphinxAtStartPar
248.360639
&
\sphinxAtStartPar
124.1803195
&
\sphinxAtStartPar
3.5
\\
\hline
\sphinxAtStartPar
150293.5107
&
\sphinxAtStartPar
248.072207
&
\sphinxAtStartPar
124.0361035
&
\sphinxAtStartPar
3.4
\\
\hline
\sphinxAtStartPar
130973.0674
&
\sphinxAtStartPar
255.4786549
&
\sphinxAtStartPar
127.7393274
&
\sphinxAtStartPar
3.3
\\
\hline
\sphinxAtStartPar
114105.3359
&
\sphinxAtStartPar
252.5656424
&
\sphinxAtStartPar
126.2828212
&
\sphinxAtStartPar
3.2
\\
\hline
\sphinxAtStartPar
99358.44939
&
\sphinxAtStartPar
248.5393443
&
\sphinxAtStartPar
124.2696721
&
\sphinxAtStartPar
3.1
\\
\hline
\sphinxAtStartPar
86537.23392
&
\sphinxAtStartPar
251.6269223
&
\sphinxAtStartPar
125.8134612
&
\sphinxAtStartPar
3
\\
\hline
\sphinxAtStartPar
75357.58044
&
\sphinxAtStartPar
251.6432071
&
\sphinxAtStartPar
125.8216036
&
\sphinxAtStartPar
2.9
\\
\hline
\sphinxAtStartPar
65650.99523
&
\sphinxAtStartPar
251.6614012
&
\sphinxAtStartPar
125.8307006
&
\sphinxAtStartPar
2.8
\\
\hline
\sphinxAtStartPar
63683.16206
&
\sphinxAtStartPar
251.6658441
&
\sphinxAtStartPar
125.8329221
&
\sphinxAtStartPar
2.7
\\
\hline
\sphinxAtStartPar
61750.32575
&
\sphinxAtStartPar
251.67074
&
\sphinxAtStartPar
125.83537
&
\sphinxAtStartPar
2.6
\\
\hline
\sphinxAtStartPar
59884.23739
&
\sphinxAtStartPar
252.6195792
&
\sphinxAtStartPar
126.3097896
&
\sphinxAtStartPar
2.5
\\
\hline
\sphinxAtStartPar
57772.09156
&
\sphinxAtStartPar
251.6814637
&
\sphinxAtStartPar
125.8407319
&
\sphinxAtStartPar
2.4
\\
\hline
\sphinxAtStartPar
50097.62697
&
\sphinxAtStartPar
253.4222927
&
\sphinxAtStartPar
126.7111463
&
\sphinxAtStartPar
2.3
\\
\hline
\sphinxAtStartPar
43479.65427
&
\sphinxAtStartPar
216.2939201
&
\sphinxAtStartPar
108.14696
&
\sphinxAtStartPar
2.2
\\
\hline
\sphinxAtStartPar
33899.676
&
\sphinxAtStartPar
248.6107083
&
\sphinxAtStartPar
124.3053542
&
\sphinxAtStartPar
2.1
\\
\hline
\sphinxAtStartPar
29960.07512
&
\sphinxAtStartPar
248.6307907
&
\sphinxAtStartPar
124.3153953
&
\sphinxAtStartPar
2
\\
\hline
\sphinxAtStartPar
24613.56833
&
\sphinxAtStartPar
150.7541002
&
\sphinxAtStartPar
75.37705012
&
\sphinxAtStartPar
1.9
\\
\hline
\sphinxAtStartPar
36933.09895
&
\sphinxAtStartPar
198.6613702
&
\sphinxAtStartPar
99.3306851
&
\sphinxAtStartPar
1.8
\\
\hline
\sphinxAtStartPar
29129.77414
&
\sphinxAtStartPar
199.0091892
&
\sphinxAtStartPar
99.50459462
&
\sphinxAtStartPar
1.7
\\
\hline
\sphinxAtStartPar
27120.64332
&
\sphinxAtStartPar
216.4733782
&
\sphinxAtStartPar
108.2366891
&
\sphinxAtStartPar
1.6
\\
\hline
\sphinxAtStartPar
20229.98476
&
\sphinxAtStartPar
170.1296746
&
\sphinxAtStartPar
85.06483729
&
\sphinxAtStartPar
1.5
\\
\hline
\sphinxAtStartPar
19179.36077
&
\sphinxAtStartPar
179.7883487
&
\sphinxAtStartPar
89.89417436
&
\sphinxAtStartPar
1.4
\\
\hline
\sphinxAtStartPar
15120.70563
&
\sphinxAtStartPar
151.6853158
&
\sphinxAtStartPar
75.84265791
&
\sphinxAtStartPar
1.3
\\
\hline
\sphinxAtStartPar
11210.70479
&
\sphinxAtStartPar
86.37067622
&
\sphinxAtStartPar
43.18533811
&
\sphinxAtStartPar
1.2
\\
\hline
\sphinxAtStartPar
7990.562518
&
\sphinxAtStartPar
62.34638126
&
\sphinxAtStartPar
31.17319063
&
\sphinxAtStartPar
1.1
\\
\hline
\sphinxAtStartPar
6367.416643
&
\sphinxAtStartPar
103.8925506
&
\sphinxAtStartPar
51.94627529
&
\sphinxAtStartPar
1
\\
\hline
\sphinxAtStartPar
4117.980781
&
\sphinxAtStartPar
51.12273987
&
\sphinxAtStartPar
25.56136994
&
\sphinxAtStartPar
0.9
\\
\hline
\sphinxAtStartPar
3939.712223
&
\sphinxAtStartPar
52.55001005
&
\sphinxAtStartPar
26.27500503
&
\sphinxAtStartPar
0.8
\\
\hline
\sphinxAtStartPar
2698.416769
&
\sphinxAtStartPar
51.4333436
&
\sphinxAtStartPar
25.7166718
&
\sphinxAtStartPar
0.7
\\
\hline
\sphinxAtStartPar
1046.477108
&
\sphinxAtStartPar
27.12953968
&
\sphinxAtStartPar
13.56476984
&
\sphinxAtStartPar
0.6
\\
\hline
\sphinxAtStartPar
727.6929275
&
\sphinxAtStartPar
27.40087693
&
\sphinxAtStartPar
13.70043846
&
\sphinxAtStartPar
0.5
\\
\hline
\sphinxAtStartPar
537.6169065
&
\sphinxAtStartPar
21.17919258
&
\sphinxAtStartPar
10.58959629
&
\sphinxAtStartPar
0.4
\\
\hline
\sphinxAtStartPar
201.0127308
&
\sphinxAtStartPar
20.96270907
&
\sphinxAtStartPar
10.48135453
&
\sphinxAtStartPar
0.3
\\
\hline
\sphinxAtStartPar
96.41247775
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.2
\\
\hline
\sphinxAtStartPar
26.95062209
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.1
\\
\hline
\end{longtable}\sphinxatlongtableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Number of mapped stars, partly displayed in \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-n-stars}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-n-stars}}}}\label{\detokenize{NBodySimulation/Appendix:id62}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|T|T|T|T|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Angle
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Mass
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNCS Tot
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNCS Tot Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNCS \textgreater{} 2
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNCS \textgreater{} 2 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNCS 2 \sphinxhyphen{} 0.5
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNCS 2 \sphinxhyphen{} 0.5 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNCS 0.5 \sphinxhyphen{} 0.08
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNCS 0.5 \sphinxhyphen{} 0.08 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNFS Tot
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNFS Tot Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNFS \textgreater{} 2
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNFS \textgreater{} 2 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNFS 2 \sphinxhyphen{} 0.5
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNFS 2 \sphinxhyphen{} 0.5 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNFS 0.5 \sphinxhyphen{} 0.08
&\sphinxstyletheadfamily 
\sphinxAtStartPar
MNFS 0.5 \sphinxhyphen{} 0.08 Err
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
957.5
&
\sphinxAtStartPar
7.5
&
\sphinxAtStartPar
36.9
&
\sphinxAtStartPar
0.32
&
\sphinxAtStartPar
206.5
&
\sphinxAtStartPar
2.1
&
\sphinxAtStartPar
714.1
&
\sphinxAtStartPar
5.9
&
\sphinxAtStartPar
655
&
\sphinxAtStartPar
26
&
\sphinxAtStartPar
1.2
&
\sphinxAtStartPar
0.92
&
\sphinxAtStartPar
120.5
&
\sphinxAtStartPar
6.3
&
\sphinxAtStartPar
534
&
\sphinxAtStartPar
26
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
1557.1
&
\sphinxAtStartPar
8.2
&
\sphinxAtStartPar
83.4
&
\sphinxAtStartPar
0.7
&
\sphinxAtStartPar
305
&
\sphinxAtStartPar
1.8
&
\sphinxAtStartPar
1168.7
&
\sphinxAtStartPar
7.6
&
\sphinxAtStartPar
644
&
\sphinxAtStartPar
29
&
\sphinxAtStartPar
1.2
&
\sphinxAtStartPar
1.2
&
\sphinxAtStartPar
113.4
&
\sphinxAtStartPar
9.7
&
\sphinxAtStartPar
529
&
\sphinxAtStartPar
36
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
2607
&
\sphinxAtStartPar
11
&
\sphinxAtStartPar
191.3
&
\sphinxAtStartPar
0.67
&
\sphinxAtStartPar
522.3
&
\sphinxAtStartPar
3.5
&
\sphinxAtStartPar
1893.2
&
\sphinxAtStartPar
8.5
&
\sphinxAtStartPar
607
&
\sphinxAtStartPar
18
&
\sphinxAtStartPar
0.9
&
\sphinxAtStartPar
0.99
&
\sphinxAtStartPar
114.4
&
\sphinxAtStartPar
6.6
&
\sphinxAtStartPar
491
&
\sphinxAtStartPar
18
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
6175
&
\sphinxAtStartPar
17
&
\sphinxAtStartPar
366.8
&
\sphinxAtStartPar
1.5
&
\sphinxAtStartPar
1276.1
&
\sphinxAtStartPar
3.4
&
\sphinxAtStartPar
4532
&
\sphinxAtStartPar
14
&
\sphinxAtStartPar
579
&
\sphinxAtStartPar
16
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0.94
&
\sphinxAtStartPar
106.6
&
\sphinxAtStartPar
7.6
&
\sphinxAtStartPar
471
&
\sphinxAtStartPar
22
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
15565
&
\sphinxAtStartPar
51
&
\sphinxAtStartPar
840
&
\sphinxAtStartPar
5.2
&
\sphinxAtStartPar
3533
&
\sphinxAtStartPar
18
&
\sphinxAtStartPar
11192
&
\sphinxAtStartPar
30
&
\sphinxAtStartPar
535
&
\sphinxAtStartPar
21
&
\sphinxAtStartPar
1.1
&
\sphinxAtStartPar
0.74
&
\sphinxAtStartPar
106.4
&
\sphinxAtStartPar
6.6
&
\sphinxAtStartPar
428
&
\sphinxAtStartPar
26
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
1015
&
\sphinxAtStartPar
13
&
\sphinxAtStartPar
39.2
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
249.4
&
\sphinxAtStartPar
6.1
&
\sphinxAtStartPar
726.7
&
\sphinxAtStartPar
8.8
&
\sphinxAtStartPar
17476
&
\sphinxAtStartPar
161
&
\sphinxAtStartPar
33.1
&
\sphinxAtStartPar
5.4
&
\sphinxAtStartPar
3354
&
\sphinxAtStartPar
37
&
\sphinxAtStartPar
14088
&
\sphinxAtStartPar
184
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
1790
&
\sphinxAtStartPar
14
&
\sphinxAtStartPar
88.9
&
\sphinxAtStartPar
0.88
&
\sphinxAtStartPar
357.8
&
\sphinxAtStartPar
5
&
\sphinxAtStartPar
1344
&
\sphinxAtStartPar
13
&
\sphinxAtStartPar
17226
&
\sphinxAtStartPar
115
&
\sphinxAtStartPar
31.9
&
\sphinxAtStartPar
5.3
&
\sphinxAtStartPar
3276
&
\sphinxAtStartPar
55
&
\sphinxAtStartPar
13918
&
\sphinxAtStartPar
148
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
3231
&
\sphinxAtStartPar
22
&
\sphinxAtStartPar
184.9
&
\sphinxAtStartPar
1.4
&
\sphinxAtStartPar
695.6
&
\sphinxAtStartPar
9.2
&
\sphinxAtStartPar
2350
&
\sphinxAtStartPar
20
&
\sphinxAtStartPar
16679
&
\sphinxAtStartPar
72
&
\sphinxAtStartPar
31.8
&
\sphinxAtStartPar
5.2
&
\sphinxAtStartPar
3185
&
\sphinxAtStartPar
38
&
\sphinxAtStartPar
13462
&
\sphinxAtStartPar
83
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
7522
&
\sphinxAtStartPar
64
&
\sphinxAtStartPar
407.4
&
\sphinxAtStartPar
3.7
&
\sphinxAtStartPar
1646
&
\sphinxAtStartPar
21
&
\sphinxAtStartPar
5468
&
\sphinxAtStartPar
45
&
\sphinxAtStartPar
15944
&
\sphinxAtStartPar
121
&
\sphinxAtStartPar
30.3
&
\sphinxAtStartPar
7.2
&
\sphinxAtStartPar
3159
&
\sphinxAtStartPar
39
&
\sphinxAtStartPar
12754
&
\sphinxAtStartPar
131
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
16291
&
\sphinxAtStartPar
37
&
\sphinxAtStartPar
910.6
&
\sphinxAtStartPar
4.7
&
\sphinxAtStartPar
3804
&
\sphinxAtStartPar
12
&
\sphinxAtStartPar
11577
&
\sphinxAtStartPar
29
&
\sphinxAtStartPar
14855
&
\sphinxAtStartPar
135
&
\sphinxAtStartPar
28.4
&
\sphinxAtStartPar
2.5
&
\sphinxAtStartPar
3025
&
\sphinxAtStartPar
25
&
\sphinxAtStartPar
11802
&
\sphinxAtStartPar
143
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
1044.2
&
\sphinxAtStartPar
9.9
&
\sphinxAtStartPar
39.6
&
\sphinxAtStartPar
1.1
&
\sphinxAtStartPar
255
&
\sphinxAtStartPar
2.9
&
\sphinxAtStartPar
749.6
&
\sphinxAtStartPar
9.9
&
\sphinxAtStartPar
40591
&
\sphinxAtStartPar
126
&
\sphinxAtStartPar
77.8
&
\sphinxAtStartPar
7.9
&
\sphinxAtStartPar
8012
&
\sphinxAtStartPar
59
&
\sphinxAtStartPar
32502
&
\sphinxAtStartPar
150
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
1933
&
\sphinxAtStartPar
21
&
\sphinxAtStartPar
92.7
&
\sphinxAtStartPar
1.2
&
\sphinxAtStartPar
405.4
&
\sphinxAtStartPar
4.2
&
\sphinxAtStartPar
1435
&
\sphinxAtStartPar
20
&
\sphinxAtStartPar
39948
&
\sphinxAtStartPar
178
&
\sphinxAtStartPar
80
&
\sphinxAtStartPar
8.4
&
\sphinxAtStartPar
7868
&
\sphinxAtStartPar
75
&
\sphinxAtStartPar
32000
&
\sphinxAtStartPar
204
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
3860
&
\sphinxAtStartPar
25
&
\sphinxAtStartPar
215.6
&
\sphinxAtStartPar
1.3
&
\sphinxAtStartPar
857.2
&
\sphinxAtStartPar
5.7
&
\sphinxAtStartPar
2787
&
\sphinxAtStartPar
22
&
\sphinxAtStartPar
39216
&
\sphinxAtStartPar
137
&
\sphinxAtStartPar
71.8
&
\sphinxAtStartPar
8.1
&
\sphinxAtStartPar
7686
&
\sphinxAtStartPar
28
&
\sphinxAtStartPar
31458
&
\sphinxAtStartPar
144
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
8156
&
\sphinxAtStartPar
29
&
\sphinxAtStartPar
435.1
&
\sphinxAtStartPar
1.7
&
\sphinxAtStartPar
1832
&
\sphinxAtStartPar
12
&
\sphinxAtStartPar
5889
&
\sphinxAtStartPar
22
&
\sphinxAtStartPar
37598
&
\sphinxAtStartPar
233
&
\sphinxAtStartPar
68.8
&
\sphinxAtStartPar
5.8
&
\sphinxAtStartPar
7460
&
\sphinxAtStartPar
46
&
\sphinxAtStartPar
30069
&
\sphinxAtStartPar
248
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
16362
&
\sphinxAtStartPar
35
&
\sphinxAtStartPar
917.4
&
\sphinxAtStartPar
5.3
&
\sphinxAtStartPar
3950
&
\sphinxAtStartPar
12
&
\sphinxAtStartPar
11496
&
\sphinxAtStartPar
28
&
\sphinxAtStartPar
34042
&
\sphinxAtStartPar
192
&
\sphinxAtStartPar
67.2
&
\sphinxAtStartPar
9.2
&
\sphinxAtStartPar
7169
&
\sphinxAtStartPar
82
&
\sphinxAtStartPar
26807
&
\sphinxAtStartPar
216
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
1041
&
\sphinxAtStartPar
11
&
\sphinxAtStartPar
40.6
&
\sphinxAtStartPar
0.52
&
\sphinxAtStartPar
265.5
&
\sphinxAtStartPar
2.3
&
\sphinxAtStartPar
734
&
\sphinxAtStartPar
10
&
\sphinxAtStartPar
56466
&
\sphinxAtStartPar
189
&
\sphinxAtStartPar
97.4
&
\sphinxAtStartPar
8.8
&
\sphinxAtStartPar
10896
&
\sphinxAtStartPar
65
&
\sphinxAtStartPar
45474
&
\sphinxAtStartPar
228
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
1972
&
\sphinxAtStartPar
21
&
\sphinxAtStartPar
90.2
&
\sphinxAtStartPar
1.4
&
\sphinxAtStartPar
425.7
&
\sphinxAtStartPar
6
&
\sphinxAtStartPar
1456
&
\sphinxAtStartPar
18
&
\sphinxAtStartPar
55920
&
\sphinxAtStartPar
267
&
\sphinxAtStartPar
88.2
&
\sphinxAtStartPar
8.1
&
\sphinxAtStartPar
10803
&
\sphinxAtStartPar
77
&
\sphinxAtStartPar
45029
&
\sphinxAtStartPar
302
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
4087
&
\sphinxAtStartPar
23
&
\sphinxAtStartPar
222.4
&
\sphinxAtStartPar
2.2
&
\sphinxAtStartPar
912.4
&
\sphinxAtStartPar
8.9
&
\sphinxAtStartPar
2952
&
\sphinxAtStartPar
17
&
\sphinxAtStartPar
54850
&
\sphinxAtStartPar
270
&
\sphinxAtStartPar
79.3
&
\sphinxAtStartPar
6.8
&
\sphinxAtStartPar
10632
&
\sphinxAtStartPar
77
&
\sphinxAtStartPar
44139
&
\sphinxAtStartPar
324
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
8865
&
\sphinxAtStartPar
22
&
\sphinxAtStartPar
434.8
&
\sphinxAtStartPar
3.7
&
\sphinxAtStartPar
2033.9
&
\sphinxAtStartPar
6
&
\sphinxAtStartPar
6396
&
\sphinxAtStartPar
19
&
\sphinxAtStartPar
52700
&
\sphinxAtStartPar
231
&
\sphinxAtStartPar
88
&
\sphinxAtStartPar
10
&
\sphinxAtStartPar
10322
&
\sphinxAtStartPar
78
&
\sphinxAtStartPar
42289
&
\sphinxAtStartPar
241
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
16224
&
\sphinxAtStartPar
61
&
\sphinxAtStartPar
946.2
&
\sphinxAtStartPar
5.8
&
\sphinxAtStartPar
4118
&
\sphinxAtStartPar
14
&
\sphinxAtStartPar
11160
&
\sphinxAtStartPar
50
&
\sphinxAtStartPar
47312
&
\sphinxAtStartPar
303
&
\sphinxAtStartPar
82.4
&
\sphinxAtStartPar
6.9
&
\sphinxAtStartPar
9781
&
\sphinxAtStartPar
93
&
\sphinxAtStartPar
37448
&
\sphinxAtStartPar
319
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
892
&
\sphinxAtStartPar
17
&
\sphinxAtStartPar
38.7
&
\sphinxAtStartPar
1.5
&
\sphinxAtStartPar
250.4
&
\sphinxAtStartPar
4
&
\sphinxAtStartPar
603
&
\sphinxAtStartPar
15
&
\sphinxAtStartPar
249461
&
\sphinxAtStartPar
589
&
\sphinxAtStartPar
89
&
\sphinxAtStartPar
8.7
&
\sphinxAtStartPar
44325
&
\sphinxAtStartPar
177
&
\sphinxAtStartPar
205047
&
\sphinxAtStartPar
728
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
1676
&
\sphinxAtStartPar
25
&
\sphinxAtStartPar
87.6
&
\sphinxAtStartPar
3.3
&
\sphinxAtStartPar
402
&
\sphinxAtStartPar
5.3
&
\sphinxAtStartPar
1186
&
\sphinxAtStartPar
21
&
\sphinxAtStartPar
246141
&
\sphinxAtStartPar
843
&
\sphinxAtStartPar
90
&
\sphinxAtStartPar
10
&
\sphinxAtStartPar
44216
&
\sphinxAtStartPar
170
&
\sphinxAtStartPar
201835
&
\sphinxAtStartPar
877
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
3680
&
\sphinxAtStartPar
24
&
\sphinxAtStartPar
221.1
&
\sphinxAtStartPar
3.4
&
\sphinxAtStartPar
955
&
\sphinxAtStartPar
12
&
\sphinxAtStartPar
2504
&
\sphinxAtStartPar
15
&
\sphinxAtStartPar
240440
&
\sphinxAtStartPar
696
&
\sphinxAtStartPar
88.8
&
\sphinxAtStartPar
7.4
&
\sphinxAtStartPar
43939
&
\sphinxAtStartPar
112
&
\sphinxAtStartPar
196412
&
\sphinxAtStartPar
670
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
8053
&
\sphinxAtStartPar
51
&
\sphinxAtStartPar
457.2
&
\sphinxAtStartPar
4.6
&
\sphinxAtStartPar
2159
&
\sphinxAtStartPar
6.1
&
\sphinxAtStartPar
5437
&
\sphinxAtStartPar
45
&
\sphinxAtStartPar
229694
&
\sphinxAtStartPar
623
&
\sphinxAtStartPar
84.3
&
\sphinxAtStartPar
9.5
&
\sphinxAtStartPar
43348
&
\sphinxAtStartPar
181
&
\sphinxAtStartPar
186262
&
\sphinxAtStartPar
657
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
15170
&
\sphinxAtStartPar
86
&
\sphinxAtStartPar
972
&
\sphinxAtStartPar
11
&
\sphinxAtStartPar
4484
&
\sphinxAtStartPar
31
&
\sphinxAtStartPar
9715
&
\sphinxAtStartPar
73
&
\sphinxAtStartPar
203312
&
\sphinxAtStartPar
642
&
\sphinxAtStartPar
80.1
&
\sphinxAtStartPar
5.8
&
\sphinxAtStartPar
42162
&
\sphinxAtStartPar
175
&
\sphinxAtStartPar
161069
&
\sphinxAtStartPar
671
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Number of simulated stars, partly displayed in \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-n-stars}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-n-stars}}}}\label{\detokenize{NBodySimulation/Appendix:id63}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|T|T|T|T|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Angle
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Mass
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNCS Tot
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNCS Tot Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNCS \textgreater{} 2
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNCS \textgreater{} 2 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNCS 2 \sphinxhyphen{} 0.5
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNCS 2 \sphinxhyphen{} 0.5 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNCS 0.5 \sphinxhyphen{} 0.08
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNCS 0.5 \sphinxhyphen{} 0.08 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNFS Tot
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNFS Tot Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNFS \textgreater{} 2
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNFS \textgreater{} 2 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNFS 2 \sphinxhyphen{} 0.5
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNFS 2 \sphinxhyphen{} 0.5 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNFS 0.5 \sphinxhyphen{} 0.08
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SNFS 0.5 \sphinxhyphen{} 0.08 Err
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
1326
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
43
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
292
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
991
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
687
&
\sphinxAtStartPar
22
&
\sphinxAtStartPar
1.2
&
\sphinxAtStartPar
0.92
&
\sphinxAtStartPar
125.2
&
\sphinxAtStartPar
6.3
&
\sphinxAtStartPar
560
&
\sphinxAtStartPar
24
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
2777
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
105
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
521
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
2151
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
697
&
\sphinxAtStartPar
27
&
\sphinxAtStartPar
1.2
&
\sphinxAtStartPar
1.2
&
\sphinxAtStartPar
122
&
\sphinxAtStartPar
11
&
\sphinxAtStartPar
574
&
\sphinxAtStartPar
36
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
6521
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
261
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1284
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4976
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
684
&
\sphinxAtStartPar
21
&
\sphinxAtStartPar
0.9
&
\sphinxAtStartPar
0.99
&
\sphinxAtStartPar
127.2
&
\sphinxAtStartPar
5.7
&
\sphinxAtStartPar
556
&
\sphinxAtStartPar
22
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
16949
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
646
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
3403
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
12900
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
689
&
\sphinxAtStartPar
23
&
\sphinxAtStartPar
1.1
&
\sphinxAtStartPar
0.88
&
\sphinxAtStartPar
124.3
&
\sphinxAtStartPar
7.7
&
\sphinxAtStartPar
563
&
\sphinxAtStartPar
29
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
40417
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1592
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
8217
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
30608
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
678
&
\sphinxAtStartPar
25
&
\sphinxAtStartPar
1.2
&
\sphinxAtStartPar
0.63
&
\sphinxAtStartPar
123.8
&
\sphinxAtStartPar
6
&
\sphinxAtStartPar
553
&
\sphinxAtStartPar
29
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
1322
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
44
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
293
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
985
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
19730
&
\sphinxAtStartPar
161
&
\sphinxAtStartPar
33.9
&
\sphinxAtStartPar
5.3
&
\sphinxAtStartPar
3588
&
\sphinxAtStartPar
37
&
\sphinxAtStartPar
16108
&
\sphinxAtStartPar
187
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
2777
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
106
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
525
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
2146
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
19809
&
\sphinxAtStartPar
151
&
\sphinxAtStartPar
33.5
&
\sphinxAtStartPar
5.1
&
\sphinxAtStartPar
3558
&
\sphinxAtStartPar
52
&
\sphinxAtStartPar
16217
&
\sphinxAtStartPar
186
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
6528
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
262
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1287
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4979
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
19809
&
\sphinxAtStartPar
97
&
\sphinxAtStartPar
33.8
&
\sphinxAtStartPar
6.1
&
\sphinxAtStartPar
3558
&
\sphinxAtStartPar
49
&
\sphinxAtStartPar
16217
&
\sphinxAtStartPar
119
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
16930
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
648
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
3388
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
12894
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
19690
&
\sphinxAtStartPar
180
&
\sphinxAtStartPar
32.4
&
\sphinxAtStartPar
8.2
&
\sphinxAtStartPar
3608
&
\sphinxAtStartPar
34
&
\sphinxAtStartPar
16050
&
\sphinxAtStartPar
188
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
40453
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1599
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
8198
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
30656
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
19845
&
\sphinxAtStartPar
164
&
\sphinxAtStartPar
31.9
&
\sphinxAtStartPar
2.4
&
\sphinxAtStartPar
3575
&
\sphinxAtStartPar
28
&
\sphinxAtStartPar
16238
&
\sphinxAtStartPar
187
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
1326
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
44
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
293
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
989
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
47660
&
\sphinxAtStartPar
171
&
\sphinxAtStartPar
79.7
&
\sphinxAtStartPar
7.6
&
\sphinxAtStartPar
8547
&
\sphinxAtStartPar
62
&
\sphinxAtStartPar
39033
&
\sphinxAtStartPar
215
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
2775
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
106
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
523
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
2146
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
47606
&
\sphinxAtStartPar
167
&
\sphinxAtStartPar
82.5
&
\sphinxAtStartPar
8.8
&
\sphinxAtStartPar
8510
&
\sphinxAtStartPar
70
&
\sphinxAtStartPar
39014
&
\sphinxAtStartPar
202
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
6518
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
262
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1284
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4972
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
47819
&
\sphinxAtStartPar
113
&
\sphinxAtStartPar
76.5
&
\sphinxAtStartPar
8.6
&
\sphinxAtStartPar
8475
&
\sphinxAtStartPar
36
&
\sphinxAtStartPar
39268
&
\sphinxAtStartPar
135
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
16946
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
647
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
3395
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
12904
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
47765
&
\sphinxAtStartPar
195
&
\sphinxAtStartPar
74.6
&
\sphinxAtStartPar
6.7
&
\sphinxAtStartPar
8484
&
\sphinxAtStartPar
55
&
\sphinxAtStartPar
39206
&
\sphinxAtStartPar
242
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
40432
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1593
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
8202
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
30637
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
47652
&
\sphinxAtStartPar
255
&
\sphinxAtStartPar
76.3
&
\sphinxAtStartPar
9.6
&
\sphinxAtStartPar
8521
&
\sphinxAtStartPar
64
&
\sphinxAtStartPar
39054
&
\sphinxAtStartPar
298
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
1328
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
43
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
293
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
992
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
67394
&
\sphinxAtStartPar
184
&
\sphinxAtStartPar
99.7
&
\sphinxAtStartPar
9.2
&
\sphinxAtStartPar
11600
&
\sphinxAtStartPar
66
&
\sphinxAtStartPar
55695
&
\sphinxAtStartPar
217
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
2777
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
106
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
522
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
2149
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
67521
&
\sphinxAtStartPar
188
&
\sphinxAtStartPar
90.8
&
\sphinxAtStartPar
7.8
&
\sphinxAtStartPar
11612
&
\sphinxAtStartPar
77
&
\sphinxAtStartPar
55819
&
\sphinxAtStartPar
242
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
6517
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
262
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1283
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4972
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
67488
&
\sphinxAtStartPar
308
&
\sphinxAtStartPar
84.6
&
\sphinxAtStartPar
6.7
&
\sphinxAtStartPar
11614
&
\sphinxAtStartPar
79
&
\sphinxAtStartPar
55790
&
\sphinxAtStartPar
371
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
16953
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
647
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
3402
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
12904
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
67468
&
\sphinxAtStartPar
264
&
\sphinxAtStartPar
94
&
\sphinxAtStartPar
11
&
\sphinxAtStartPar
11614
&
\sphinxAtStartPar
76
&
\sphinxAtStartPar
55760
&
\sphinxAtStartPar
289
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
40406
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1590
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
8207
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
30609
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
67524
&
\sphinxAtStartPar
319
&
\sphinxAtStartPar
92.7
&
\sphinxAtStartPar
8.4
&
\sphinxAtStartPar
11581
&
\sphinxAtStartPar
74
&
\sphinxAtStartPar
55850
&
\sphinxAtStartPar
365
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
1326
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
43
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
292
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
991
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
351322
&
\sphinxAtStartPar
452
&
\sphinxAtStartPar
96.6
&
\sphinxAtStartPar
9.1
&
\sphinxAtStartPar
50872
&
\sphinxAtStartPar
171
&
\sphinxAtStartPar
300353
&
\sphinxAtStartPar
571
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
2777
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
105
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
521
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
2151
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
351223
&
\sphinxAtStartPar
445
&
\sphinxAtStartPar
97
&
\sphinxAtStartPar
11
&
\sphinxAtStartPar
50918
&
\sphinxAtStartPar
148
&
\sphinxAtStartPar
300208
&
\sphinxAtStartPar
583
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
6521
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
261
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1284
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4976
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
351228
&
\sphinxAtStartPar
318
&
\sphinxAtStartPar
96
&
\sphinxAtStartPar
7.5
&
\sphinxAtStartPar
50900
&
\sphinxAtStartPar
133
&
\sphinxAtStartPar
300232
&
\sphinxAtStartPar
428
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
16950
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
646
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
3403
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
12901
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
351069
&
\sphinxAtStartPar
343
&
\sphinxAtStartPar
94.8
&
\sphinxAtStartPar
9.9
&
\sphinxAtStartPar
50917
&
\sphinxAtStartPar
159
&
\sphinxAtStartPar
300057
&
\sphinxAtStartPar
468
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
40418
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1592
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
8217
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
30609
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
351156
&
\sphinxAtStartPar
418
&
\sphinxAtStartPar
93.5
&
\sphinxAtStartPar
7.6
&
\sphinxAtStartPar
50967
&
\sphinxAtStartPar
162
&
\sphinxAtStartPar
300096
&
\sphinxAtStartPar
550
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Average velocity of mapped stars, partly displayed in \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-avg-vel-640}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-avg-vel-640}}}}\label{\detokenize{NBodySimulation/Appendix:id64}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Angle
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Mass
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OCV
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OCV Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OFV
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OFV Err
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.00310743
&
\sphinxAtStartPar
0.00000084
&
\sphinxAtStartPar
0.00826
&
\sphinxAtStartPar
0.00022
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.00310694
&
\sphinxAtStartPar
0.00000036
&
\sphinxAtStartPar
0.00814
&
\sphinxAtStartPar
0.00017
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.00310659
&
\sphinxAtStartPar
0.00000046
&
\sphinxAtStartPar
0.0083
&
\sphinxAtStartPar
0.00026
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.00310572
&
\sphinxAtStartPar
0.00000094
&
\sphinxAtStartPar
0.00827
&
\sphinxAtStartPar
0.0002
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.004132217
&
\sphinxAtStartPar
0.00000008
&
\sphinxAtStartPar
0.00823
&
\sphinxAtStartPar
0.00024
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.00316207
&
\sphinxAtStartPar
0.00000076
&
\sphinxAtStartPar
0.002124
&
\sphinxAtStartPar
0.000015
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.00315911
&
\sphinxAtStartPar
0.00000084
&
\sphinxAtStartPar
0.002133
&
\sphinxAtStartPar
0.000016
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.0031645
&
\sphinxAtStartPar
0.0000007
&
\sphinxAtStartPar
0.0021225
&
\sphinxAtStartPar
0.0000096
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.00315688
&
\sphinxAtStartPar
0.00000034
&
\sphinxAtStartPar
0.002133
&
\sphinxAtStartPar
0.000013
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.00315863
&
\sphinxAtStartPar
0.00000021
&
\sphinxAtStartPar
0.002125
&
\sphinxAtStartPar
0.000012
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.0029074
&
\sphinxAtStartPar
0.0000027
&
\sphinxAtStartPar
0.003193
&
\sphinxAtStartPar
0.000014
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.0029064
&
\sphinxAtStartPar
0.0000025
&
\sphinxAtStartPar
0.003193
&
\sphinxAtStartPar
0.000012
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.0029064
&
\sphinxAtStartPar
0.0000012
&
\sphinxAtStartPar
0.0031919
&
\sphinxAtStartPar
0.0000097
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.00290469
&
\sphinxAtStartPar
0.00000084
&
\sphinxAtStartPar
0.003195
&
\sphinxAtStartPar
0.000013
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.002904
&
\sphinxAtStartPar
0.00000063
&
\sphinxAtStartPar
0.0031957
&
\sphinxAtStartPar
0.0000092
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.0026192
&
\sphinxAtStartPar
0.0000066
&
\sphinxAtStartPar
0.005075
&
\sphinxAtStartPar
0.000014
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.0026194
&
\sphinxAtStartPar
0.0000036
&
\sphinxAtStartPar
0.005077
&
\sphinxAtStartPar
0.00001
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.0026213
&
\sphinxAtStartPar
0.0000026
&
\sphinxAtStartPar
0.005072
&
\sphinxAtStartPar
0.000011
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.0026156
&
\sphinxAtStartPar
0.0000013
&
\sphinxAtStartPar
0.005072
&
\sphinxAtStartPar
0.00001
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.002615
&
\sphinxAtStartPar
0.0000014
&
\sphinxAtStartPar
0.0050729
&
\sphinxAtStartPar
0.0000086
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.0021763
&
\sphinxAtStartPar
0.000009
&
\sphinxAtStartPar
0.0036446
&
\sphinxAtStartPar
0.0000056
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.0021772
&
\sphinxAtStartPar
0.000006
&
\sphinxAtStartPar
0.0036443
&
\sphinxAtStartPar
0.0000027
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.0021795
&
\sphinxAtStartPar
0.0000041
&
\sphinxAtStartPar
0.0036421
&
\sphinxAtStartPar
0.0000038
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.0021774
&
\sphinxAtStartPar
0.0000024
&
\sphinxAtStartPar
0.0036425
&
\sphinxAtStartPar
0.0000049
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.0021747
&
\sphinxAtStartPar
0.0000011
&
\sphinxAtStartPar
0.0036398
&
\sphinxAtStartPar
0.0000051
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Precision for mapped stars. see \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-precision}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-precision}}}}\label{\detokenize{NBodySimulation/Appendix:id65}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Angle
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Mass
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OP Tot
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OP Tot Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OP \textgreater{} 2
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OP \textgreater{} 2 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OP 2 \sphinxhyphen{} 0.5
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OP 2 \sphinxhyphen{} 0.5 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OP 0.5 \sphinxhyphen{} 0.08
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OP 0.5 \sphinxhyphen{} 0.08 Err
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.99979
&
\sphinxAtStartPar
0.00067
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9997
&
\sphinxAtStartPar
0.00095
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.99947
&
\sphinxAtStartPar
0.00069
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.99925
&
\sphinxAtStartPar
0.00097
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.99905
&
\sphinxAtStartPar
0.00055
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.99864
&
\sphinxAtStartPar
0.00079
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.99863
&
\sphinxAtStartPar
0.00051
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.99811
&
\sphinxAtStartPar
0.00071
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.99363
&
\sphinxAtStartPar
0.00084
&
\sphinxAtStartPar
0.9996
&
\sphinxAtStartPar
0.00089
&
\sphinxAtStartPar
0.9967
&
\sphinxAtStartPar
0.00095
&
\sphinxAtStartPar
0.9922
&
\sphinxAtStartPar
0.0012
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.961
&
\sphinxAtStartPar
0.013
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9704
&
\sphinxAtStartPar
0.0095
&
\sphinxAtStartPar
0.952
&
\sphinxAtStartPar
0.019
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.9654
&
\sphinxAtStartPar
0.0084
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9733
&
\sphinxAtStartPar
0.0085
&
\sphinxAtStartPar
0.96
&
\sphinxAtStartPar
0.011
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.976
&
\sphinxAtStartPar
0.0036
&
\sphinxAtStartPar
0.9994
&
\sphinxAtStartPar
0.002
&
\sphinxAtStartPar
0.9817
&
\sphinxAtStartPar
0.0051
&
\sphinxAtStartPar
0.9716
&
\sphinxAtStartPar
0.0042
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.9808
&
\sphinxAtStartPar
0.0015
&
\sphinxAtStartPar
0.99973
&
\sphinxAtStartPar
0.00086
&
\sphinxAtStartPar
0.9873
&
\sphinxAtStartPar
0.0039
&
\sphinxAtStartPar
0.9769
&
\sphinxAtStartPar
0.0017
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.9855
&
\sphinxAtStartPar
0.001
&
\sphinxAtStartPar
0.99988
&
\sphinxAtStartPar
0.00038
&
\sphinxAtStartPar
0.98962
&
\sphinxAtStartPar
0.00089
&
\sphinxAtStartPar
0.9828
&
\sphinxAtStartPar
0.0014
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.855
&
\sphinxAtStartPar
0.019
&
\sphinxAtStartPar
0.992
&
\sphinxAtStartPar
0.018
&
\sphinxAtStartPar
0.913
&
\sphinxAtStartPar
0.019
&
\sphinxAtStartPar
0.809
&
\sphinxAtStartPar
0.025
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.8733
&
\sphinxAtStartPar
0.0089
&
\sphinxAtStartPar
0.9952
&
\sphinxAtStartPar
0.0084
&
\sphinxAtStartPar
0.905
&
\sphinxAtStartPar
0.017
&
\sphinxAtStartPar
0.847
&
\sphinxAtStartPar
0.011
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.9015
&
\sphinxAtStartPar
0.0095
&
\sphinxAtStartPar
0.9975
&
\sphinxAtStartPar
0.0027
&
\sphinxAtStartPar
0.932
&
\sphinxAtStartPar
0.012
&
\sphinxAtStartPar
0.879
&
\sphinxAtStartPar
0.011
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.93
&
\sphinxAtStartPar
0.0029
&
\sphinxAtStartPar
0.998
&
\sphinxAtStartPar
0.001
&
\sphinxAtStartPar
0.9483
&
\sphinxAtStartPar
0.0062
&
\sphinxAtStartPar
0.9167
&
\sphinxAtStartPar
0.0028
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.9507
&
\sphinxAtStartPar
0.002
&
\sphinxAtStartPar
0.9981
&
\sphinxAtStartPar
0.0018
&
\sphinxAtStartPar
0.9616
&
\sphinxAtStartPar
0.0045
&
\sphinxAtStartPar
0.9422
&
\sphinxAtStartPar
0.0024
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.926
&
\sphinxAtStartPar
0.013
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9683
&
\sphinxAtStartPar
0.008
&
\sphinxAtStartPar
0.871
&
\sphinxAtStartPar
0.024
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.9394
&
\sphinxAtStartPar
0.0095
&
\sphinxAtStartPar
0.9987
&
\sphinxAtStartPar
0.0042
&
\sphinxAtStartPar
0.9683
&
\sphinxAtStartPar
0.0095
&
\sphinxAtStartPar
0.912
&
\sphinxAtStartPar
0.015
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.9567
&
\sphinxAtStartPar
0.0052
&
\sphinxAtStartPar
0.9985
&
\sphinxAtStartPar
0.0034
&
\sphinxAtStartPar
0.9779
&
\sphinxAtStartPar
0.0061
&
\sphinxAtStartPar
0.9384
&
\sphinxAtStartPar
0.0069
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.9631
&
\sphinxAtStartPar
0.0028
&
\sphinxAtStartPar
0.999
&
\sphinxAtStartPar
0.0017
&
\sphinxAtStartPar
0.9788
&
\sphinxAtStartPar
0.0032
&
\sphinxAtStartPar
0.9518
&
\sphinxAtStartPar
0.0041
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.9725
&
\sphinxAtStartPar
0.0016
&
\sphinxAtStartPar
0.9992
&
\sphinxAtStartPar
0.0011
&
\sphinxAtStartPar
0.9839
&
\sphinxAtStartPar
0.0015
&
\sphinxAtStartPar
0.9642
&
\sphinxAtStartPar
0.0021
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.625
&
\sphinxAtStartPar
0.023
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.807
&
\sphinxAtStartPar
0.027
&
\sphinxAtStartPar
0.486
&
\sphinxAtStartPar
0.029
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.696
&
\sphinxAtStartPar
0.022
&
\sphinxAtStartPar
0.9975
&
\sphinxAtStartPar
0.0052
&
\sphinxAtStartPar
0.816
&
\sphinxAtStartPar
0.027
&
\sphinxAtStartPar
0.611
&
\sphinxAtStartPar
0.024
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.771
&
\sphinxAtStartPar
0.011
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.8721
&
\sphinxAtStartPar
0.0076
&
\sphinxAtStartPar
0.698
&
\sphinxAtStartPar
0.015
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.8236
&
\sphinxAtStartPar
0.0066
&
\sphinxAtStartPar
0.99953
&
\sphinxAtStartPar
0.00099
&
\sphinxAtStartPar
0.8989
&
\sphinxAtStartPar
0.0056
&
\sphinxAtStartPar
0.7718
&
\sphinxAtStartPar
0.0085
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.8665
&
\sphinxAtStartPar
0.0037
&
\sphinxAtStartPar
0.99967
&
\sphinxAtStartPar
0.00053
&
\sphinxAtStartPar
0.926
&
\sphinxAtStartPar
0.0054
&
\sphinxAtStartPar
0.8212
&
\sphinxAtStartPar
0.0044
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Precision for simulated stars. see \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-precision-sim}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-precision-sim}}}}\label{\detokenize{NBodySimulation/Appendix:id66}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Angle
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Mass
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SP Tot
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SP Tot Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SP \textgreater{} 2
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SP \textgreater{} 2 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SP 2 \sphinxhyphen{} 0.5
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SP 2 \sphinxhyphen{} 0.5 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SP 0.5 \sphinxhyphen{} 0.08
&\sphinxstyletheadfamily 
\sphinxAtStartPar
SP 0.5 \sphinxhyphen{} 0.08 Err
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.99817
&
\sphinxAtStartPar
0.00022
&
\sphinxAtStartPar
0.99981
&
\sphinxAtStartPar
0.00043
&
\sphinxAtStartPar
0.99847
&
\sphinxAtStartPar
0.00045
&
\sphinxAtStartPar
0.998
&
\sphinxAtStartPar
0.00035
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.9946
&
\sphinxAtStartPar
0.0018
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9946
&
\sphinxAtStartPar
0.004
&
\sphinxAtStartPar
0.9943
&
\sphinxAtStartPar
0.0021
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.9934
&
\sphinxAtStartPar
0.002
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9931
&
\sphinxAtStartPar
0.003
&
\sphinxAtStartPar
0.9931
&
\sphinxAtStartPar
0.0024
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.99496
&
\sphinxAtStartPar
0.00057
&
\sphinxAtStartPar
0.9996
&
\sphinxAtStartPar
0.0012
&
\sphinxAtStartPar
0.995
&
\sphinxAtStartPar
0.0016
&
\sphinxAtStartPar
0.9947
&
\sphinxAtStartPar
0.00067
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.99569
&
\sphinxAtStartPar
0.00062
&
\sphinxAtStartPar
0.99984
&
\sphinxAtStartPar
0.00049
&
\sphinxAtStartPar
0.99663
&
\sphinxAtStartPar
0.00089
&
\sphinxAtStartPar
0.99523
&
\sphinxAtStartPar
0.00092
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.9962
&
\sphinxAtStartPar
0.00031
&
\sphinxAtStartPar
0.99994
&
\sphinxAtStartPar
0.0002
&
\sphinxAtStartPar
0.99654
&
\sphinxAtStartPar
0.00038
&
\sphinxAtStartPar
0.99591
&
\sphinxAtStartPar
0.00038
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.9719
&
\sphinxAtStartPar
0.0042
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.978
&
\sphinxAtStartPar
0.0093
&
\sphinxAtStartPar
0.9689
&
\sphinxAtStartPar
0.0044
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.9756
&
\sphinxAtStartPar
0.0029
&
\sphinxAtStartPar
0.9981
&
\sphinxAtStartPar
0.0059
&
\sphinxAtStartPar
0.9742
&
\sphinxAtStartPar
0.0048
&
\sphinxAtStartPar
0.9749
&
\sphinxAtStartPar
0.0039
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.9768
&
\sphinxAtStartPar
0.0021
&
\sphinxAtStartPar
0.9992
&
\sphinxAtStartPar
0.0016
&
\sphinxAtStartPar
0.9787
&
\sphinxAtStartPar
0.004
&
\sphinxAtStartPar
0.9751
&
\sphinxAtStartPar
0.0023
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.9816
&
\sphinxAtStartPar
0.001
&
\sphinxAtStartPar
0.9989
&
\sphinxAtStartPar
0.001
&
\sphinxAtStartPar
0.9841
&
\sphinxAtStartPar
0.0023
&
\sphinxAtStartPar
0.9801
&
\sphinxAtStartPar
0.0014
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.9845
&
\sphinxAtStartPar
0.00048
&
\sphinxAtStartPar
0.99937
&
\sphinxAtStartPar
0.00089
&
\sphinxAtStartPar
0.9861
&
\sphinxAtStartPar
0.0015
&
\sphinxAtStartPar
0.98332
&
\sphinxAtStartPar
0.00055
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.9892
&
\sphinxAtStartPar
0.0032
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9925
&
\sphinxAtStartPar
0.0038
&
\sphinxAtStartPar
0.9878
&
\sphinxAtStartPar
0.0038
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.9914
&
\sphinxAtStartPar
0.0012
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9918
&
\sphinxAtStartPar
0.0031
&
\sphinxAtStartPar
0.9909
&
\sphinxAtStartPar
0.0021
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.9918
&
\sphinxAtStartPar
0.0013
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9926
&
\sphinxAtStartPar
0.0029
&
\sphinxAtStartPar
0.9912
&
\sphinxAtStartPar
0.0014
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.99294
&
\sphinxAtStartPar
0.00085
&
\sphinxAtStartPar
0.99984
&
\sphinxAtStartPar
0.00049
&
\sphinxAtStartPar
0.9943
&
\sphinxAtStartPar
0.0014
&
\sphinxAtStartPar
0.99224
&
\sphinxAtStartPar
0.00083
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.99367
&
\sphinxAtStartPar
0.00039
&
\sphinxAtStartPar
0.99975
&
\sphinxAtStartPar
0.00044
&
\sphinxAtStartPar
0.99459
&
\sphinxAtStartPar
0.00068
&
\sphinxAtStartPar
0.9931
&
\sphinxAtStartPar
0.00046
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.905
&
\sphinxAtStartPar
0.015
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.933
&
\sphinxAtStartPar
0.025
&
\sphinxAtStartPar
0.893
&
\sphinxAtStartPar
0.016
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.923
&
\sphinxAtStartPar
0.012
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9399
&
\sphinxAtStartPar
0.006
&
\sphinxAtStartPar
0.916
&
\sphinxAtStartPar
0.015
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.932
&
\sphinxAtStartPar
0.0049
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
0.9508
&
\sphinxAtStartPar
0.0058
&
\sphinxAtStartPar
0.9239
&
\sphinxAtStartPar
0.0058
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.9472
&
\sphinxAtStartPar
0.0023
&
\sphinxAtStartPar
0.99984
&
\sphinxAtStartPar
0.00049
&
\sphinxAtStartPar
0.9636
&
\sphinxAtStartPar
0.0035
&
\sphinxAtStartPar
0.9405
&
\sphinxAtStartPar
0.0023
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.9536
&
\sphinxAtStartPar
0.0014
&
\sphinxAtStartPar
0.99969
&
\sphinxAtStartPar
0.00044
&
\sphinxAtStartPar
0.968
&
\sphinxAtStartPar
0.0018
&
\sphinxAtStartPar
0.9475
&
\sphinxAtStartPar
0.0018
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{F1 Score for mapped stars. see \hyperref[\detokenize{NBodySimulation/Experiments:fig-25-f1}]{Fig.\@ \ref{\detokenize{NBodySimulation/Experiments:fig-25-f1}}}}\label{\detokenize{NBodySimulation/Appendix:id67}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Angle
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Mass
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OF1 Tot
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OF1 Tot  Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OF1 \textgreater{} 2
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OF1 \textgreater{} 2 Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OF1 2 \sphinxhyphen{} 0.5
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OF1 2 \sphinxhyphen{} 0.5  Err
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OF1 0.5 \sphinxhyphen{} 0.08
&\sphinxstyletheadfamily 
\sphinxAtStartPar
OF1 0.5 \sphinxhyphen{} 0.08  Err
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.66
&
\sphinxAtStartPar
0.04
&
\sphinxAtStartPar
0.712
&
\sphinxAtStartPar
0.073
&
\sphinxAtStartPar
0.732
&
\sphinxAtStartPar
0.05
&
\sphinxAtStartPar
0.635
&
\sphinxAtStartPar
0.035
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.8398
&
\sphinxAtStartPar
0.006
&
\sphinxAtStartPar
0.944
&
\sphinxAtStartPar
0.012
&
\sphinxAtStartPar
0.9068
&
\sphinxAtStartPar
0.0044
&
\sphinxAtStartPar
0.8125
&
\sphinxAtStartPar
0.0072
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.8682
&
\sphinxAtStartPar
0.0059
&
\sphinxAtStartPar
0.9075
&
\sphinxAtStartPar
0.0062
&
\sphinxAtStartPar
0.924
&
\sphinxAtStartPar
0.01
&
\sphinxAtStartPar
0.8476
&
\sphinxAtStartPar
0.0055
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.9315
&
\sphinxAtStartPar
0.0029
&
\sphinxAtStartPar
0.934
&
\sphinxAtStartPar
0.0037
&
\sphinxAtStartPar
0.9531
&
\sphinxAtStartPar
0.0038
&
\sphinxAtStartPar
0.925
&
\sphinxAtStartPar
0.003
\\
\hline
\sphinxAtStartPar
180
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.9449
&
\sphinxAtStartPar
0.0014
&
\sphinxAtStartPar
0.9492
&
\sphinxAtStartPar
0.0019
&
\sphinxAtStartPar
0.9582
&
\sphinxAtStartPar
0.0018
&
\sphinxAtStartPar
0.9403
&
\sphinxAtStartPar
0.0014
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.688
&
\sphinxAtStartPar
0.043
&
\sphinxAtStartPar
0.897
&
\sphinxAtStartPar
0.022
&
\sphinxAtStartPar
0.811
&
\sphinxAtStartPar
0.056
&
\sphinxAtStartPar
0.626
&
\sphinxAtStartPar
0.041
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.789
&
\sphinxAtStartPar
0.019
&
\sphinxAtStartPar
0.924
&
\sphinxAtStartPar
0.028
&
\sphinxAtStartPar
0.893
&
\sphinxAtStartPar
0.024
&
\sphinxAtStartPar
0.747
&
\sphinxAtStartPar
0.018
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.8462
&
\sphinxAtStartPar
0.0043
&
\sphinxAtStartPar
0.9278
&
\sphinxAtStartPar
0.0035
&
\sphinxAtStartPar
0.9355
&
\sphinxAtStartPar
0.0051
&
\sphinxAtStartPar
0.8098
&
\sphinxAtStartPar
0.0059
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.8937
&
\sphinxAtStartPar
0.0035
&
\sphinxAtStartPar
0.9511
&
\sphinxAtStartPar
0.0023
&
\sphinxAtStartPar
0.9476
&
\sphinxAtStartPar
0.003
&
\sphinxAtStartPar
0.8719
&
\sphinxAtStartPar
0.0045
\\
\hline
\sphinxAtStartPar
25
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.9277
&
\sphinxAtStartPar
0.0012
&
\sphinxAtStartPar
0.9556
&
\sphinxAtStartPar
0.0024
&
\sphinxAtStartPar
0.9547
&
\sphinxAtStartPar
0.002
&
\sphinxAtStartPar
0.9163
&
\sphinxAtStartPar
0.0013
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.547
&
\sphinxAtStartPar
0.015
&
\sphinxAtStartPar
0.744
&
\sphinxAtStartPar
0.033
&
\sphinxAtStartPar
0.751
&
\sphinxAtStartPar
0.019
&
\sphinxAtStartPar
0.45
&
\sphinxAtStartPar
0.018
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.7
&
\sphinxAtStartPar
0.011
&
\sphinxAtStartPar
0.9384
&
\sphinxAtStartPar
0.0097
&
\sphinxAtStartPar
0.875
&
\sphinxAtStartPar
0.012
&
\sphinxAtStartPar
0.621
&
\sphinxAtStartPar
0.015
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.7817
&
\sphinxAtStartPar
0.0063
&
\sphinxAtStartPar
0.9507
&
\sphinxAtStartPar
0.0078
&
\sphinxAtStartPar
0.9079
&
\sphinxAtStartPar
0.0081
&
\sphinxAtStartPar
0.7224
&
\sphinxAtStartPar
0.0077
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.8395
&
\sphinxAtStartPar
0.0044
&
\sphinxAtStartPar
0.9594
&
\sphinxAtStartPar
0.0029
&
\sphinxAtStartPar
0.9318
&
\sphinxAtStartPar
0.0034
&
\sphinxAtStartPar
0.7979
&
\sphinxAtStartPar
0.0056
\\
\hline
\sphinxAtStartPar
10
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.8927
&
\sphinxAtStartPar
0.0017
&
\sphinxAtStartPar
0.9671
&
\sphinxAtStartPar
0.0024
&
\sphinxAtStartPar
0.9467
&
\sphinxAtStartPar
0.0026
&
\sphinxAtStartPar
0.8667
&
\sphinxAtStartPar
0.0021
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.501
&
\sphinxAtStartPar
0.015
&
\sphinxAtStartPar
0.838
&
\sphinxAtStartPar
0.014
&
\sphinxAtStartPar
0.782
&
\sphinxAtStartPar
0.018
&
\sphinxAtStartPar
0.338
&
\sphinxAtStartPar
0.019
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.61
&
\sphinxAtStartPar
0.014
&
\sphinxAtStartPar
0.907
&
\sphinxAtStartPar
0.014
&
\sphinxAtStartPar
0.865
&
\sphinxAtStartPar
0.014
&
\sphinxAtStartPar
0.486
&
\sphinxAtStartPar
0.019
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.7122
&
\sphinxAtStartPar
0.0067
&
\sphinxAtStartPar
0.9448
&
\sphinxAtStartPar
0.009
&
\sphinxAtStartPar
0.9233
&
\sphinxAtStartPar
0.0076
&
\sphinxAtStartPar
0.6061
&
\sphinxAtStartPar
0.0074
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.7906
&
\sphinxAtStartPar
0.0036
&
\sphinxAtStartPar
0.9585
&
\sphinxAtStartPar
0.0033
&
\sphinxAtStartPar
0.941
&
\sphinxAtStartPar
0.0035
&
\sphinxAtStartPar
0.7196
&
\sphinxAtStartPar
0.0046
\\
\hline
\sphinxAtStartPar
5
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.8608
&
\sphinxAtStartPar
0.0029
&
\sphinxAtStartPar
0.9705
&
\sphinxAtStartPar
0.002
&
\sphinxAtStartPar
0.9539
&
\sphinxAtStartPar
0.0019
&
\sphinxAtStartPar
0.8117
&
\sphinxAtStartPar
0.0037
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
640
&
\sphinxAtStartPar
0.538
&
\sphinxAtStartPar
0.016
&
\sphinxAtStartPar
0.926
&
\sphinxAtStartPar
0.018
&
\sphinxAtStartPar
0.786
&
\sphinxAtStartPar
0.02
&
\sphinxAtStartPar
0.39
&
\sphinxAtStartPar
0.021
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
0.626
&
\sphinxAtStartPar
0.014
&
\sphinxAtStartPar
0.9622
&
\sphinxAtStartPar
0.01
&
\sphinxAtStartPar
0.828
&
\sphinxAtStartPar
0.018
&
\sphinxAtStartPar
0.518
&
\sphinxAtStartPar
0.016
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
4000
&
\sphinxAtStartPar
0.7147
&
\sphinxAtStartPar
0.0089
&
\sphinxAtStartPar
0.9536
&
\sphinxAtStartPar
0.0042
&
\sphinxAtStartPar
0.8837
&
\sphinxAtStartPar
0.0068
&
\sphinxAtStartPar
0.619
&
\sphinxAtStartPar
0.012
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
10000
&
\sphinxAtStartPar
0.7749
&
\sphinxAtStartPar
0.0048
&
\sphinxAtStartPar
0.9641
&
\sphinxAtStartPar
0.0036
&
\sphinxAtStartPar
0.8978
&
\sphinxAtStartPar
0.0038
&
\sphinxAtStartPar
0.7053
&
\sphinxAtStartPar
0.0066
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
25000
&
\sphinxAtStartPar
0.824
&
\sphinxAtStartPar
0.0032
&
\sphinxAtStartPar
0.9657
&
\sphinxAtStartPar
0.0021
&
\sphinxAtStartPar
0.9174
&
\sphinxAtStartPar
0.0034
&
\sphinxAtStartPar
0.7637
&
\sphinxAtStartPar
0.004
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{search}

\end{itemize}

\sphinxAtStartPar


\begin{sphinxthebibliography}{10}
\bibitem[1]{NBodySimulation/Appendix:id60}
\sphinxAtStartPar
Anisa Bajkova and Vadim Bobylev. Parameters of six selected galactic potential models. \sphinxstyleemphasis{Open Astronomy}, 26(1):72\textendash{}79, 2017. URL: \sphinxurl{https://doi.org/10.1515/astro-2017-0016}, \sphinxhref{https://doi.org/doi:10.1515/astro-2017-0016}{doi:doi:10.1515/astro\sphinxhyphen{}2017\sphinxhyphen{}0016}.
\bibitem[2]{NBodySimulation/Appendix:id45}
\sphinxAtStartPar
Nate Bastian, Kevin R. Covey, and Michael R. Meyer. A universal stellar initial mass function? a critical look at variations. \sphinxstyleemphasis{Annual Review of Astronomy and Astrophysics}, 48(1):339\textendash{}389, Aug 2010. URL: \sphinxurl{http://dx.doi.org/10.1146/annurev-astro-082708-101642}, \sphinxhref{https://doi.org/10.1146/annurev-astro-082708-101642}{doi:10.1146/annurev\sphinxhyphen{}astro\sphinxhyphen{}082708\sphinxhyphen{}101642}.
\bibitem[3]{NBodySimulation/Appendix:id11}
\sphinxAtStartPar
H. Baumgardt and S. Sollima. The global mass functions of 35 galactic globular clusters \textendash{} ii. clues on the initial mass function and black hole retention fraction. \sphinxstyleemphasis{Monthly Notices of the Royal Astronomical Society}, 472(1):744\textendash{}750, Aug 2017. URL: \sphinxurl{http://dx.doi.org/10.1093/mnras/stx2036}, \sphinxhref{https://doi.org/10.1093/mnras/stx2036}{doi:10.1093/mnras/stx2036}.
\bibitem[4]{NBodySimulation/Appendix:id18}
\sphinxAtStartPar
James Binney. Dynamics for Galactic Archaeology. \sphinxstyleemphasis{New Astron. Rev.}, 57:29\textendash{}51, 2013. \sphinxhref{https://arxiv.org/abs/1309.2794}{arXiv:1309.2794}, \sphinxhref{https://doi.org/10.1016/j.newar.2013.08.001}{doi:10.1016/j.newar.2013.08.001}.
\bibitem[5]{NBodySimulation/Appendix:id29}
\sphinxAtStartPar
James Binney, Ortwin Gerhard, and David Spergel. The photometric structure of the inner Galaxy. \sphinxstyleemphasis{Monthly Notices of the Royal Astronomical Society}, 288(2):365\textendash{}374, 06 1997. URL: \sphinxurl{https://doi.org/10.1093/mnras/288.2.365}, \sphinxhref{https://arxiv.org/abs/https://academic.oup.com/mnras/article-pdf/288/2/365/2841167/288-2-365.pdf}{arXiv:https://academic.oup.com/mnras/article\sphinxhyphen{}pdf/288/2/365/2841167/288\sphinxhyphen{}2\sphinxhyphen{}365.pdf}, \sphinxhref{https://doi.org/10.1093/mnras/288.2.365}{doi:10.1093/mnras/288.2.365}.
\bibitem[6]{NBodySimulation/Appendix:id17}
\sphinxAtStartPar
James Binney and Scott Tremaine. \sphinxstyleemphasis{Galactic Dynamics: Second Edition}. Princeton University Press, Princeton, rev \sphinxhyphen{} revised, 2 edition, 2011. ISBN 9780691130262.
\bibitem[7]{NBodySimulation/Appendix:id5}
\sphinxAtStartPar
Jo Bovy. Galpy: a python library for galactic dynamics. \sphinxstyleemphasis{The Astrophysical Journal Supplement Series}, 216(2):29, Feb 2015. URL: \sphinxurl{http://dx.doi.org/10.1088/0067-0049/216/2/29}, \sphinxhref{https://doi.org/10.1088/0067-0049/216/2/29}{doi:10.1088/0067\sphinxhyphen{}0049/216/2/29}.
\bibitem[8]{NBodySimulation/Appendix:id54}
\sphinxAtStartPar
Larry Bradley, Brigitta Sipcz, Thomas Robitaille, Erik Tollerud, Z Vincius, Christoph Deil, Kyle Barbary, Tom J Wilson, Ivo Busko, Axel Donath, Hans Moritz Gnther, Mihai Cara, krachyon, Simon Conseil, Azalee Bostroem, Michael Droettboom, E. M. Bray, P. L. Lim, Lars Andersen Bratholm, Geert Barentsen, Matt Craig, Shivangee Rathi, Sergio Pascual, Gabriel Perren, Iskren Y. Georgiev, Miguel de Val\sphinxhyphen{}Borro, Wolfgang Kerzendorf, Yoonsoo P. Bach, Bruno Quint, and Harrison Souchereau. Astropy/photutils: 1.2.0. September 2021. URL: \sphinxurl{https://doi.org/10.5281/zenodo.5525286}, \sphinxhref{https://doi.org/10.5281/zenodo.5525286}{doi:10.5281/zenodo.5525286}.
\bibitem[9]{NBodySimulation/Appendix:id32}
\sphinxAtStartPar
Bradley W. Carroll and Dale A. Ostlie. \sphinxstyleemphasis{An Introduction to Modern Astrophysics}. Pearson Addison\sphinxhyphen{}Wesley, 2nd (international) edition, 2007.
\bibitem[10]{NBodySimulation/Appendix:id34}
\sphinxAtStartPar
Ryan R. Curtin, Marcus Edel, Mikhail Lozhnikov, Yannis Mentekidis, Sumedh Ghaisas, and Shangtong Zhang. Mlpack 3: a fast, flexible machine learning library. \sphinxstyleemphasis{Journal of Open Source Software}, 3(26):726, 2018. URL: \sphinxurl{https://doi.org/10.21105/joss.00726}, \sphinxhref{https://doi.org/10.21105/joss.00726}{doi:10.21105/joss.00726}.
\bibitem[11]{NBodySimulation/Appendix:id43}
\sphinxAtStartPar
Luc Devroye. \sphinxstyleemphasis{Non\sphinxhyphen{}Uniform Random Variate Generation(originally published with}. Springer\sphinxhyphen{}Verlag, 1986. URL: \sphinxurl{http://cg.scs.carleton.ca/~luc/rnbookindex.html}.
\bibitem[12]{NBodySimulation/Appendix:id33}
\sphinxAtStartPar
Martin Ester, Hans\sphinxhyphen{}Peter Kriegel, Jrg Sander, and Xiaowei Xu. A density\sphinxhyphen{}based algorithm for discovering clusters in large spatial databases with noise. In \sphinxstyleemphasis{Proceedings of the Second International Conference on Knowledge Discovery and Data Mining}, KDD\textquotesingle{}96, 226\textendash{}231. AAAI Press, 1996.
\bibitem[13]{NBodySimulation/Appendix:id27}
\sphinxAtStartPar
R.P. Feynman, R.B. Leighton, M. Sands, and EM Hafner. \sphinxstyleemphasis{The Feynman Lectures on Physics; Vol. I}. Volume 33. AAPT, 1965.
\bibitem[14]{NBodySimulation/Appendix:id24}
\sphinxAtStartPar
M. et al Galassi. Gnu scientific library reference manual. 2018. URL: \sphinxurl{https://www.gnu.org/software/gsl/}.
\bibitem[15]{NBodySimulation/Appendix:id9}
\sphinxAtStartPar
James E. Gentle. \sphinxstyleemphasis{Matrix Algebra: Theory, Computations, and Applications in Statistics}. Springer Publishing Company, Incorporated, 1st edition, 2007. ISBN 0387708723.
\bibitem[16]{NBodySimulation/Appendix:id38}
\sphinxAtStartPar
Michael Y Grudi, Dvid Guszejnov, Philip F Hopkins, Astrid Lamberts, Michael Boylan\sphinxhyphen{}Kolchin, Norman Murray, and Denise Schmitz. From the top down and back up again: star cluster structure from hierarchical star formation. \sphinxstyleemphasis{Monthly Notices of the Royal Astronomical Society}, 481(1):688\textendash{}702, 08 2018. URL: \sphinxurl{https://doi.org/10.1093/mnras/sty2303}, \sphinxhref{https://arxiv.org/abs/https://academic.oup.com/mnras/article-pdf/481/1/688/25692710/sty2303.pdf}{arXiv:https://academic.oup.com/mnras/article\sphinxhyphen{}pdf/481/1/688/25692710/sty2303.pdf}, \sphinxhref{https://doi.org/10.1093/mnras/sty2303}{doi:10.1093/mnras/sty2303}.
\bibitem[17]{NBodySimulation/Appendix:id36}
\sphinxAtStartPar
S. Harfst, S. Portegies Zwart, and A. Stolte. Reconstructing the arches cluster \sphinxhyphen{} i. constraining the initial conditions. \sphinxstyleemphasis{Monthly Notices of the Royal Astronomical Society}, 409(2):628\textendash{}638, Sep 2010. URL: \sphinxurl{http://dx.doi.org/10.1111/j.1365-2966.2010.17326.x}, \sphinxhref{https://doi.org/10.1111/j.1365-2966.2010.17326.x}{doi:10.1111/j.1365\sphinxhyphen{}2966.2010.17326.x}.
\bibitem[18]{NBodySimulation/Appendix:id10}
\sphinxAtStartPar
Pavel Kroupa. The initial mass function and its variation. \sphinxstyleemphasis{ASP Conf. Ser.}, 285:86, 2002. \sphinxhref{https://arxiv.org/abs/astro-ph/0102155}{arXiv:astro\sphinxhyphen{}ph/0102155}.
\bibitem[19]{NBodySimulation/Appendix:id13}
\sphinxAtStartPar
Pavel Kroupa and Carsten Weidner. Galactic\sphinxhyphen{}field initial mass functions of massive stars. \sphinxstyleemphasis{The Astrophysical Journal}, 598(2):1076\textendash{}1078, dec 2003. URL: \sphinxurl{https://doi.org/10.1086\%2F379105}, \sphinxhref{https://doi.org/10.1086/379105}{doi:10.1086/379105}.
\bibitem[20]{NBodySimulation/Appendix:id21}
\sphinxAtStartPar
Andrea Kunder, Andreas Koch, R. Michael Rich, Roberto de Propris, Christian D. Howard, Scott A. Stubbs, Christian I. Johnson, Juntai Shen, Yougang Wang, Annie C. Robin, John Kormendy, Mario Soto, Peter Frinchaboy, David B. Reitzel, HongSheng Zhao, and Livia Origlia. THE BULGE RADIAL VELOCITY ASSAY (BRAVA). II. COMPLETE SAMPLE AND DATA RELEASE. \sphinxstyleemphasis{The Astronomical Journal}, 143(3):57, feb 2012. URL: \sphinxurl{https://doi.org/10.1088\%2F0004-6256\%2F143\%2F3\%2F57}, \sphinxhref{https://doi.org/10.1088/0004-6256/143/3/57}{doi:10.1088/0004\sphinxhyphen{}6256/143/3/57}.
\bibitem[21]{NBodySimulation/Appendix:id7}
\sphinxAtStartPar
Byung\sphinxhyphen{}Uk Lee. \sphinxstyleemphasis{Stereo Matching of Skull Landmarks}. PhD thesis, Stanford University, Stanford, CA, USA, 1991.
\bibitem[22]{NBodySimulation/Appendix:id50}
\sphinxAtStartPar
Kieran Leschinski, Hugo Buddelmeijer, Oliver Czoske, Miguel Verdugo, Gijs Verdoes\sphinxhyphen{}Kleijn, and Werner W. Zeilinger. Scopesim: a flexible general purpose astronomical instrument data simulation framework in python. \sphinxstyleemphasis{Software and Cyberinfrastructure for Astronomy VI}, Dec 2020. URL: \sphinxurl{http://dx.doi.org/10.1117/12.2559784}, \sphinxhref{https://doi.org/10.1117/12.2559784}{doi:10.1117/12.2559784}.
\bibitem[23]{NBodySimulation/Appendix:id55}
\sphinxAtStartPar
M. Marks and P. Kroupa. Inverse dynamical population synthesis. \sphinxstyleemphasis{Astronomy \& Astrophysics}, 543:A8, Jun 2012. URL: \sphinxurl{http://dx.doi.org/10.1051/0004-6361/201118231}, \sphinxhref{https://doi.org/10.1051/0004-6361/201118231}{doi:10.1051/0004\sphinxhyphen{}6361/201118231}.
\bibitem[24]{NBodySimulation/Appendix:id53}
\sphinxAtStartPar
D. J. Marshall, A. C. Robin, C. Reyl, M. Schultheis, and S. Picaud. Modelling the galactic interstellar extinction distribution in three dimensions. \sphinxstyleemphasis{Astronomy \& Astrophysics}, 453(2):635\textendash{}651, Jun 2006. URL: \sphinxurl{http://dx.doi.org/10.1051/0004-6361:20053842}, \sphinxhref{https://doi.org/10.1051/0004-6361:20053842}{doi:10.1051/0004\sphinxhyphen{}6361:20053842}.
\bibitem[25]{NBodySimulation/Appendix:id28}
\sphinxAtStartPar
Paul J. McMillan. The mass distribution and gravitational potential of the milky way. \sphinxstyleemphasis{Monthly Notices of the Royal Astronomical Society}, 465(1):76\textendash{}94, Oct 2016. URL: \sphinxurl{http://dx.doi.org/10.1093/mnras/stw2759}, \sphinxhref{https://doi.org/10.1093/mnras/stw2759}{doi:10.1093/mnras/stw2759}.
\bibitem[26]{NBodySimulation/Appendix:id59}
\sphinxAtStartPar
Julio F. Navarro, Carlos S. Frenk, and Simon D. M. White. The structure of cold dark matter halos. \sphinxstyleemphasis{The Astrophysical Journal}, 462:563, May 1996. URL: \sphinxurl{http://dx.doi.org/10.1086/177173}, \sphinxhref{https://doi.org/10.1086/177173}{doi:10.1086/177173}.
\bibitem[27]{NBodySimulation/Appendix:id26}
\sphinxAtStartPar
Sotirios E. Notaris. Gauss\sphinxhyphen{}kronrod quadrature formulae \sphinxhyphen{} a survey of fifty years of research. \sphinxstyleemphasis{Electron. Trans. Numer. Anal.}, 45:371\textendash{}404, 01 2016.
\bibitem[28]{NBodySimulation/Appendix:id12}
\sphinxAtStartPar
Alicia Porras, I. Cruz\sphinxhyphen{}Gonzlez, and Luis Salas. Imf in perseus arm yscs. \sphinxstyleemphasis{ASP Conference Series}, 287:98\textendash{}103, 01 2003.
\bibitem[29]{NBodySimulation/Appendix:id56}
\sphinxAtStartPar
Simon F. Portegies Zwart, Stephen L.W. McMillan, and Mark Gieles. Young massive star clusters. \sphinxstyleemphasis{Annual Review of Astronomy and Astrophysics}, 48(1):431\textendash{}493, Aug 2010. URL: \sphinxurl{http://dx.doi.org/10.1146/annurev-astro-081309-130834}, \sphinxhref{https://doi.org/10.1146/annurev-astro-081309-130834}{doi:10.1146/annurev\sphinxhyphen{}astro\sphinxhyphen{}081309\sphinxhyphen{}130834}.
\bibitem[30]{NBodySimulation/Appendix:id4}
\sphinxAtStartPar
Adrian M. Price\sphinxhyphen{}Whelan, David W. Hogg, Kathryn V. Johnston, and David Hendel. Inferring the gravitational potential of the milky way with a few precisely measured stars. \sphinxstyleemphasis{The Astrophysical Journal}, 794(1):4, Sep 2014. URL: \sphinxurl{http://dx.doi.org/10.1088/0004-637X/794/1/4}, \sphinxhref{https://doi.org/10.1088/0004-637x/794/1/4}{doi:10.1088/0004\sphinxhyphen{}637x/794/1/4}.
\bibitem[31]{NBodySimulation/Appendix:id22}
\sphinxAtStartPar
A. C. Robin, D. J. Marshall, M. Schultheis, and C. Reyl. Stellar populations in the milky way bulge region: towards solving the galactic bulge and bar shapes using 2mass data. \sphinxstyleemphasis{Astronomy \& Astrophysics}, 538:A106, Feb 2012. URL: \sphinxurl{http://dx.doi.org/10.1051/0004-6361/201116512}, \sphinxhref{https://doi.org/10.1051/0004-6361/201116512}{doi:10.1051/0004\sphinxhyphen{}6361/201116512}.
\bibitem[32]{NBodySimulation/Appendix:id46}
\sphinxAtStartPar
A. Saro, S. Borgani, L. Tornatore, K. Dolag, G. Murante, A. Biviano, F. Calura, and S. Charlot. Properties of the galaxy population in hydrodynamical simulations of clusters. \sphinxstyleemphasis{Monthly Notices of the Royal Astronomical Society}, 373(1):397\textendash{}410, Nov 2006. URL: \sphinxurl{http://dx.doi.org/10.1111/j.1365-2966.2006.11046.x}, \sphinxhref{https://doi.org/10.1111/j.1365-2966.2006.11046.x}{doi:10.1111/j.1365\sphinxhyphen{}2966.2006.11046.x}.
\bibitem[33]{NBodySimulation/Appendix:id31}
\sphinxAtStartPar
P. Kenneth. Seidelmann, Great Britain., and United States Naval Observatory. \sphinxstyleemphasis{Explanatory supplement to the astronomical almanac / prepared by the Nautical Almanac Office, U.S. Naval Observatory ; with contributions from H.M. Nautical Alamanac Office, Royal Greenwich Observatory ... {[}et al.{]} ; edited by P. Kenneth Seidelmann}. University Science Books Mill Valley, Calif, {[}rev. ed.{]}. edition, 1992. ISBN 0935702687.
\bibitem[34]{NBodySimulation/Appendix:id8}
\sphinxAtStartPar
John Vince. \sphinxstyleemphasis{Mathematics for Computer Graphics}. Springer, 01 2006. ISBN 978\sphinxhyphen{}1\sphinxhyphen{}84628\sphinxhyphen{}034\sphinxhyphen{}4. \sphinxhref{https://doi.org/10.1007/1-84628-283-7}{doi:10.1007/1\sphinxhyphen{}84628\sphinxhyphen{}283\sphinxhyphen{}7}.
\bibitem[35]{NBodySimulation/Appendix:id37}
\sphinxAtStartPar
D. L. Walker, S. N. Longmore, N. Bastian, J. M. D. Kruijssen, J. M. Rathborne, R. Galvn\sphinxhyphen{}Madrid, and H. B. Liu. Comparing young massive clusters and their progenitor clouds in the Milky Way. \sphinxstyleemphasis{Monthly Notices of the Royal Astronomical Society}, 457(4):4536\textendash{}4545, 02 2016. URL: \sphinxurl{https://doi.org/10.1093/mnras/stw313}, \sphinxhref{https://arxiv.org/abs/https://academic.oup.com/mnras/article-pdf/457/4/4536/18517186/stw313.pdf}{arXiv:https://academic.oup.com/mnras/article\sphinxhyphen{}pdf/457/4/4536/18517186/stw313.pdf}, \sphinxhref{https://doi.org/10.1093/mnras/stw313}{doi:10.1093/mnras/stw313}.
\bibitem[36]{NBodySimulation/Appendix:id57}
\sphinxAtStartPar
Yougang Wang, Hongsheng Zhao, Shude Mao, and R. M. Rich. A new model for the Milky Way bar. \sphinxstyleemphasis{Monthly Notices of the Royal Astronomical Society}, 427(2):1429\textendash{}1440, 12 2012. URL: \sphinxurl{https://doi.org/10.1111/j.1365-2966.2012.22063.x}, \sphinxhref{https://arxiv.org/abs/https://academic.oup.com/mnras/article-pdf/427/2/1429/2984088/427-2-1429.pdf}{arXiv:https://academic.oup.com/mnras/article\sphinxhyphen{}pdf/427/2/1429/2984088/427\sphinxhyphen{}2\sphinxhyphen{}1429.pdf}, \sphinxhref{https://doi.org/10.1111/j.1365-2966.2012.22063.x}{doi:10.1111/j.1365\sphinxhyphen{}2966.2012.22063.x}.
\bibitem[37]{NBodySimulation/Appendix:id20}
\sphinxAtStartPar
Denis Yurin and Volker Springel. An iterative method for the construction of N\sphinxhyphen{}body galaxy models in collisionless equilibrium. \sphinxstyleemphasis{Monthly Notices of the Royal Astronomical Society}, 444(1):62\textendash{}79, 08 2014. URL: \sphinxurl{https://doi.org/10.1093/mnras/stu1421}, \sphinxhref{https://arxiv.org/abs/https://academic.oup.com/mnras/article-pdf/444/1/62/18503149/stu1421.pdf}{arXiv:https://academic.oup.com/mnras/article\sphinxhyphen{}pdf/444/1/62/18503149/stu1421.pdf}, \sphinxhref{https://doi.org/10.1093/mnras/stu1421}{doi:10.1093/mnras/stu1421}.
\bibitem[38]{NBodySimulation/Appendix:id39}
\sphinxAtStartPar
S. J. Aarseth, M. Henon, and R. Wielen. A Comparison of Numerical Methods for the Study of Star Cluster Dynamics. \sphinxstyleemphasis{\textbackslash{}aap }, 37(1):183\textendash{}187, December 1974.
\bibitem[39]{NBodySimulation/Appendix:id58}
\sphinxAtStartPar
Barros, D. A., Lpine, J. R. D., and Dias, W. S. Models for the 3d axisymmetric gravitational potential of the milky way galaxy \sphinxhyphen{} a detailed modelling of the galactic disk. \sphinxstyleemphasis{A\&A}, 593:A108, 2016. URL: \sphinxurl{https://doi.org/10.1051/0004-6361/201527535}, \sphinxhref{https://doi.org/10.1051/0004-6361/201527535}{doi:10.1051/0004\sphinxhyphen{}6361/201527535}.
\bibitem[40]{NBodySimulation/Appendix:id2}
\sphinxAtStartPar
Gilles Chabrier. Galactic Stellar and Substellar Initial Mass Function. \sphinxstyleemphasis{\textbackslash{}pasp }, 115(809):763\textendash{}795, July 2003. \sphinxhref{https://arxiv.org/abs/astro-ph/0304382}{arXiv:astro\sphinxhyphen{}ph/0304382}, \sphinxhref{https://doi.org/10.1086/376392}{doi:10.1086/376392}.
\bibitem[41]{NBodySimulation/Appendix:id42}
\sphinxAtStartPar
Rebecca A. W. Elson, S. Michael Fall, and Kenneth C. Freeman. The Structure of Young Star Clusters in the Large Magellanic Cloud. \sphinxstyleemphasis{\textbackslash{}apj }, 323:54, December 1987. \sphinxhref{https://doi.org/10.1086/165807}{doi:10.1086/165807}.
\bibitem[42]{NBodySimulation/Appendix:id44}
\sphinxAtStartPar
Espinoza, P., Selman, F. J., and Melnick, J. The massive star initial mass function of the arches cluster ***. \sphinxstyleemphasis{A\&A}, 501(2):563\textendash{}583, 2009. URL: \sphinxurl{https://doi.org/10.1051/0004-6361/20078597}, \sphinxhref{https://doi.org/10.1051/0004-6361/20078597}{doi:10.1051/0004\sphinxhyphen{}6361/20078597}.
\bibitem[43]{NBodySimulation/Appendix:id48}
\sphinxAtStartPar
Sanghamitra Goswami, Stefan Umbreit, Matt Bierbaum, and Frederic A. Rasio. Formation of Massive Black Holes in Dense Star Clusters. II. Initial Mass Function and Primordial Mass Segregation. \sphinxstyleemphasis{\textbackslash{}apj }, 752(1):43, June 2012. \sphinxhref{https://arxiv.org/abs/1105.5884}{arXiv:1105.5884}, \sphinxhref{https://doi.org/10.1088/0004-637X/752/1/43}{doi:10.1088/0004\sphinxhyphen{}637X/752/1/43}.
\bibitem[44]{NBodySimulation/Appendix:id6}
\sphinxAtStartPar
Lars Hernquist. An Analytical Model for Spherical Galaxies and Bulges. \sphinxstyleemphasis{\textbackslash{}apj }, 356:359, June 1990. \sphinxhref{https://doi.org/10.1086/168845}{doi:10.1086/168845}.
\bibitem[45]{NBodySimulation/Appendix:id19}
\sphinxAtStartPar
Lars Hernquist. N\sphinxhyphen{}Body Realizations of Compound Galaxies. \sphinxstyleemphasis{\textbackslash{}apjs }, 86:389, June 1993. \sphinxhref{https://doi.org/10.1086/191784}{doi:10.1086/191784}.
\bibitem[46]{NBodySimulation/Appendix:id40}
\sphinxAtStartPar
Ivan R. King. Density Data and Emission Measure for a Model of the Coma Cluster. \sphinxstyleemphasis{\textbackslash{}apjl }, 174:L123, June 1972. \sphinxhref{https://doi.org/10.1086/180963}{doi:10.1086/180963}.
\bibitem[47]{NBodySimulation/Appendix:id35}
\sphinxAtStartPar
A. H. W. Kuepper, Th. Maschberger, P. Kroupa, and H. Baumgardt. McLuster: A Tool to Make a Star Cluster. July 2011. \sphinxhref{https://arxiv.org/abs/1107.015}{arXiv:1107.015}.
\bibitem[48]{NBodySimulation/Appendix:id23}
\sphinxAtStartPar
Paul J. McMillan. GalPot: Galaxy potential code. November 2016. \sphinxhref{https://arxiv.org/abs/1611.006}{arXiv:1611.006}.
\bibitem[49]{NBodySimulation/Appendix:id3}
\sphinxAtStartPar
M. Miyamoto and R. Nagai. Three\sphinxhyphen{}dimensional models for the distribution of mass in galaxies. \sphinxstyleemphasis{\textbackslash{}pasj }, 27:533\textendash{}543, January 1975.
\bibitem[50]{NBodySimulation/Appendix:id51}
\sphinxAtStartPar
Mark J. Pecaut and Eric E. Mamajek. Intrinsic Colors, Temperatures, and Bolometric Corrections of Pre\sphinxhyphen{}main\sphinxhyphen{}sequence Stars. \sphinxstyleemphasis{\textbackslash{}apjs }, 208(1):9, September 2013. \sphinxhref{https://arxiv.org/abs/1307.2657}{arXiv:1307.2657}, \sphinxhref{https://doi.org/10.1088/0067-0049/208/1/9}{doi:10.1088/0067\sphinxhyphen{}0049/208/1/9}.
\bibitem[51]{NBodySimulation/Appendix:id52}
\sphinxAtStartPar
A. J. Pickles. A Stellar Spectral Flux Library: 1150\sphinxhyphen{}25000 . \sphinxstyleemphasis{\textbackslash{}pasp }, 110(749):863\textendash{}878, July 1998. \sphinxhref{https://doi.org/10.1086/316197}{doi:10.1086/316197}.
\bibitem[52]{NBodySimulation/Appendix:id25}
\sphinxAtStartPar
R. Piessens, E. de Doncker\sphinxhyphen{}Kapenga, and C. W. Ueberhuber. \sphinxstyleemphasis{Quadpack : a subroutine package for automatic integration}. Springer series in computational mathematics ; 1. Springer, Berlin {[}u.a.{]}, 1983. ISBN 3540125531.
\bibitem[53]{NBodySimulation/Appendix:id41}
\sphinxAtStartPar
H. C. Plummer. On the problem of distribution in globular star clusters. \sphinxstyleemphasis{\textbackslash{}mnras }, 71:460\textendash{}470, March 1911. \sphinxhref{https://doi.org/10.1093/mnras/71.5.460}{doi:10.1093/mnras/71.5.460}.
\bibitem[54]{NBodySimulation/Appendix:id47}
\sphinxAtStartPar
L. Portinari. The Role of the IMF in Modelling Clusters of Galaxies. In A. Vallenari, R. Tantalo, L. Portinari, and A. Moretti, editors, \sphinxstyleemphasis{From Stars to Galaxies: Building the Pieces to Build Up the Universe}, volume 374 of Astronomical Society of the Pacific Conference Series, 131. December 2007.
\bibitem[55]{NBodySimulation/Appendix:id49}
\sphinxAtStartPar
Edwin E. Salpeter. The Luminosity Function and Stellar Evolution. \sphinxstyleemphasis{\textbackslash{}apj }, 121:161, January 1955. \sphinxhref{https://doi.org/10.1086/145971}{doi:10.1086/145971}.
\bibitem[56]{NBodySimulation/Appendix:id30}
\sphinxAtStartPar
Ralph Schnrich, James Binney, and Walter Dehnen. Local kinematics and the local standard of rest. \sphinxstyleemphasis{\textbackslash{}mnras }, 403(4):1829\textendash{}1833, April 2010. \sphinxhref{https://arxiv.org/abs/0912.3693}{arXiv:0912.3693}, \sphinxhref{https://doi.org/10.1111/j.1365-2966.2010.16253.x}{doi:10.1111/j.1365\sphinxhyphen{}2966.2010.16253.x}.
\bibitem[57]{NBodySimulation/Appendix:id16}
\sphinxAtStartPar
A. Toomre. On the gravitational stability of a disk of stars. \sphinxstyleemphasis{\textbackslash{}apj }, 139:1217\textendash{}1238, May 1964. \sphinxhref{https://doi.org/10.1086/147861}{doi:10.1086/147861}.
\bibitem[58]{NBodySimulation/Appendix:id15}
\sphinxAtStartPar
P. C. van der Kruit. The three\sphinxhyphen{}dimensional distribution of light and mass in disks of spiral galaxies. \sphinxstyleemphasis{\textbackslash{}aap }, 192:117\textendash{}127, March 1988.
\bibitem[59]{NBodySimulation/Appendix:id14}
\sphinxAtStartPar
P. C. van der Kruit and L. Searle. Surface photometry of edge\sphinxhyphen{}on spiral galaxies. I \sphinxhyphen{} A model for the three\sphinxhyphen{}dimensional distribution of light in galactic disks. \sphinxstyleemphasis{\textbackslash{}aap }, 95:105\textendash{}115, February 1981.
\end{sphinxthebibliography}



\renewcommand{\indexname}{Index}
\printindex
\end{document}